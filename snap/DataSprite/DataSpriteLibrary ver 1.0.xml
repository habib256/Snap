<blocks app="Snap! 5.1, http://snap.berkeley.edu" version="1"><block-definition s="new ( temporary? %&apos;temporary&apos; ) DataSprite" type="reporter" category="control"><comment x="0" y="0" w="149.7511425525115" collapsed="false">creates a temporary or static DataSprite with the required local variables, JS-code copied from Snap!-code</comment><header></header><code></code><translations></translations><inputs><input type="%b">true</input></inputs><script><block s="doDeclareVariables"><list><l>newSprite</l><l>copy</l></list></block><block s="doWarp"><script><block s="doRun"><block s="reportJSFunction"><list></list><l>this.parent.parent.addNewSprite();</l></block><list></list></block><block s="doSetVar"><l>newSprite</l><block s="reportListItem"><l><option>last</option></l><block s="reportGet"><l><option>other sprites</option></l></block></block></block><block s="doIf"><block var="temporary"/><script><block s="doSetVar"><l>copy</l><block s="newClone"><block var="newSprite"/></block></block><block s="doTellTo"><block var="newSprite"/><block s="reifyScript"><script><block s="doRun"><block s="reportJSFunction"><list></list><l>this.parent.parent.removeSprite(this);</l></block><list></list></block></script><list></list></block><list></list></block><block s="doSetVar"><l>newSprite</l><block var="copy"/></block></script></block><block s="doTellTo"><block var="newSprite"/><block s="reifyScript"><script><block s="doForEach"><l>item</l><block s="reportNewList"><list><l>myCostume</l><l>myProperties</l><l>myData</l></list></block><script><block s="doRun"><block s="reportJSFunction"><list><l>name</l></list><l>if ((typeof name) != "string") {&#xD;    throw new Error("name isn&apos;t a string: " + name);&#xD;}&#xD;if (name != "") this.addVariable(name, false);</l></block><list><block var="item"/></list></block></script></block><block s="doRun"><block s="reportJSFunction"><list></list><l>var ide = this.parentThatIsA(IDE_Morph);&#xD;ide.flushBlocksCache(&apos;variables&apos;); // b/c of inheritance&#xD;ide.refreshPalette();</l></block><list></list></block><block s="doSetVar"><l>myData</l><custom-block s="new table"></custom-block></block><custom-block s="set properties"></custom-block><block s="gotoXY"><block s="reportRandom"><l>-100</l><l>-50</l></block><block s="reportRandom"><l>100</l><l>150</l></block></block><custom-block s="new costume width %n height %n color %n %n %n"><l>350</l><l>300</l><l>255</l><l>225</l><l>205</l></custom-block><block s="doReport"><block var="newSprite"/></block></script><list></list></block><list></list></block></script></block></script></block-definition><block-definition s="new costume width %&apos;w&apos; height %&apos;h&apos; color %&apos;r&apos; %&apos;g&apos; %&apos;b&apos;" type="command" category="looks"><comment x="0" y="0" w="111.66666666666667" collapsed="false">creates an empty costume of the specified size and color</comment><header></header><code></code><translations></translations><inputs><input type="%n">350</input><input type="%n">300</input><input type="%n">255</input><input type="%n">225</input><input type="%n">205</input></inputs><script><block s="doWarp"><script><block s="doIf"><block s="reportNot"><block s="reportIsA"><block var="myProperties"/><l><option>list</option></l></block></block><script><custom-block s="set properties"></custom-block></script></block><custom-block s="set property %s to %s"><l>width</l><block var="w"/></custom-block><custom-block s="set property %s to %s"><l>height</l><block var="h"/></custom-block><custom-block s="set property %s to %s"><l>backColorRed</l><block var="r"/></custom-block><custom-block s="set property %s to %s"><l>backColorGreen</l><block var="g"/></custom-block><custom-block s="set property %s to %s"><l>backColorBlue</l><block var="b"/></custom-block><block s="doSetVar"><l>myCostume</l><block s="evaluate"><block s="reportJSFunction"><list><l>w</l><l>h</l><l>r</l><l>g</l><l>b</l></list><l>var newCostume=new Costume();&#xD;newCostume.contents.width = w;&#xD;newCostume.contents.height = h;&#xD;var ctx = newCostume.contents.getContext(&apos;2d&apos;);&#xD;ctx.beginPath();&#xD;ctx.fillStyle = new Color(r,g,b).toString();&#xD;ctx.strokeStyle = new Color(0,0,0).toString();&#xD;ctx.fillRect(0,0,w,h);&#xD;ctx.strokeRect(0,0,w,h);&#xD;ctx.closePath();&#xD;ctx.fill();&#xD;ctx.stroke();&#xD;return newCostume;</l></block><list><block var="w"/><block var="h"/><block var="r"/><block var="g"/><block var="b"/></list></block></block><block s="doSwitchToCostume"><block var="myCostume"/></block></script></block></script></block-definition><block-definition s="set labels title %&apos;newTitle&apos; x-label %&apos;newXLabel&apos; y-label %&apos;newYLabel&apos;" type="command" category="looks"><comment x="0" y="0" w="90" collapsed="false">sets the labels of the diagrams of a DataSprite</comment><header></header><code></code><translations></translations><inputs><input type="%txt"></input><input type="%txt"></input><input type="%txt"></input></inputs><script><block s="doWarp"><script><custom-block s="set property %s to %s"><l>title</l><block var="newTitle"/></custom-block><custom-block s="set property %s to %s"><l>xLabel</l><block var="newXLabel"/></custom-block><custom-block s="set property %s to %s"><l>yLabel</l><block var="newYLabel"/></custom-block><custom-block s="set offsets"></custom-block></script></block></script></block-definition><block-definition s="set property %&apos;name&apos; to %&apos;value&apos;" type="command" category="lists"><comment x="0" y="0" w="91.66666666666667" collapsed="false">sets the value of an existing property or inserts it anew</comment><header></header><code></code><translations></translations><inputs><input type="%s">width<options>type of data&#xD;width&#xD;height&#xD;backColorRed&#xD;backColorGreen&#xD;backColorBlue&#xD;leftOffset&#xD;upperOffset&#xD;lowerOffset&#xD;title&#xD;titleHeight&#xD;xLabel&#xD;xLabelHeight&#xD;yLabel&#xD;yLabelHeight&#xD;xLeft&#xD;xRight&#xD;yLower&#xD;yUpper&#xD;lineStyle&#xD;lineWidth&#xD;lineColorRed&#xD;lineColorGreen&#xD;lineColorBlue&#xD;datapointStyle&#xD;datapointWidth&#xD;datapointConnected&#xD;datapointColorRed&#xD;datapointColorGreen&#xD;datapointColorBlue&#xD;scalesPrecision&#xD;scalesTextheight&#xD;scalesNumberXintervals&#xD;minValue&#xD;maxValue&#xD;columns&#xD;rows</options></input><input type="%s"></input></inputs><script><block s="doDeclareVariables"><list><l>done</l><l>h</l></list></block><block s="doWarp"><script><block s="doSetVar"><l>name</l><block s="reportListItem"><l>1</l><block s="reportTextSplit"><block var="name"/><l> </l></block></block></block><block s="doSetVar"><l>done</l><block s="reportBoolean"><l><bool>false</bool></l></block></block><block s="doSetVar"><l>h</l><block s="reportAtomicMap"><block s="reifyReporter"><script><block s="doIf"><block s="reportEquals"><block var="name"/><block s="reportListItem"><l>1</l><l/></block></block><script><block s="doReplaceInList"><l>2</l><l/><block var="value"/></block><block s="doSetVar"><l>done</l><block s="reportBoolean"><l><bool>true</bool></l></block></block></script></block></script><list></list></block><block var="myProperties"/></block></block><block s="doIf"><block s="reportNot"><block var="done"/></block><script><block s="doAddToList"><block s="reportNewList"><list><block var="name"/><block var="value"/></list></block><block var="myProperties"/></block></script></block><block s="doIf"><block s="reportOr"><block s="reportOr"><block s="reportEquals"><l>name</l><l>titleHeight</l></block><block s="reportOr"><block s="reportEquals"><l>name</l><l>xLabelHeight</l></block><block s="reportEquals"><l>name</l><l>yLabelHeight</l></block></block></block><block s="reportEquals"><l>name</l><l>scalesTextheight</l></block></block><script><custom-block s="set offsets"></custom-block></script></block></script></block></script></block-definition><block-definition s="property %&apos;name&apos;" type="reporter" category="lists"><comment x="0" y="0" w="95" collapsed="false">reads the value of an existing property</comment><header></header><code></code><translations></translations><inputs><input type="%s">width<options>type of data&#xD;width&#xD;height&#xD;backColorRed&#xD;backColorGreen&#xD;backColorBlue&#xD;leftOffset&#xD;upperOffset&#xD;lowerOffset&#xD;title&#xD;titleHeight&#xD;xLabel&#xD;xLabelHeight&#xD;yLabel&#xD;yLabelHeight&#xD;xLeft&#xD;xRight&#xD;yLower&#xD;yUpper&#xD;lineStyle&#xD;lineWidth&#xD;lineColorRed&#xD;lineColorGreen&#xD;lineColorBlue&#xD;datapointStyle&#xD;datapointWidth&#xD;datapointConnected&#xD;datapointColorRed&#xD;datapointColorGreen&#xD;datapointColorBlue&#xD;scalesPrecision&#xD;scalesTextheight&#xD;scalesNumberXintervals&#xD;minValue&#xD;maxValue&#xD;columns&#xD;rows</options></input></inputs><script><block s="doDeclareVariables"><list><l>result</l><l>h</l></list></block><block s="doWarp"><script><block s="doSetVar"><l>result</l><l>not found</l></block><block s="doSetVar"><l>name</l><block s="reportListItem"><l>1</l><block s="reportTextSplit"><block var="name"/><l> </l></block></block></block><block s="doSetVar"><l>h</l><block s="reportAtomicMap"><block s="reifyReporter"><script><block s="doIf"><block s="reportEquals"><block var="name"/><block s="reportListItem"><l>1</l><l/></block></block><script><block s="doSetVar"><l>result</l><block s="reportListItem"><l>2</l><l/></block></block></script></block></script><list></list></block><block var="myProperties"/></block></block><block s="doReport"><block var="result"/></block></script></block></script></block-definition><block-definition s="set offsets" type="command" category="looks"><comment x="0" y="0" w="187.1666676666667" collapsed="false">sets the distances of the diagram axes from the edges of the DataSprite</comment><header></header><code></code><translations></translations><inputs></inputs><script><block s="doWarp"><script><block s="doIfElse"><block s="reportEquals"><block s="reportStringSize"><custom-block s="property %s"><l>title</l></custom-block></block><l>0</l></block><script><custom-block s="set property %s to %s"><l>upperOffset</l><l>0</l></custom-block></script><script><custom-block s="set property %s to %s"><l>upperOffset</l><block s="reportSum"><custom-block s="property %s"><l>titleHeight</l></custom-block><l>10</l></block></custom-block></script></block><block s="doIfElse"><block s="reportEquals"><block s="reportStringSize"><custom-block s="property %s"><l>xLabel</l></custom-block></block><l>0</l></block><script><custom-block s="set property %s to %s"><l>lowerOffset</l><l>20</l></custom-block></script><script><custom-block s="set property %s to %s"><l>lowerOffset</l><block s="reportSum"><custom-block s="property %s"><l>xLabelHeight</l></custom-block><block s="reportSum"><custom-block s="property %s"><l>scalesTextheight</l></custom-block><l>10</l></block></block></custom-block></script></block><block s="doIfElse"><block s="reportEquals"><block s="reportStringSize"><custom-block s="property %s"><l>yLabel</l></custom-block></block><l>0</l></block><script><custom-block s="set property %s to %s"><l>leftOffset</l><l>60</l></custom-block></script><script><custom-block s="set property %s to %s"><l>leftOffset</l><block s="reportSum"><custom-block s="property %s"><l>yLabelHeight</l></custom-block><block s="reportSum"><custom-block s="property %s"><l>scalesTextheight</l></custom-block><l>50</l></block></block></custom-block></script></block></script></block></script></block-definition><block-definition s="set ranges to x [ %&apos;xl&apos; %&apos;xr&apos; ] y [ %&apos;yl&apos; %&apos;yu&apos; ]" type="command" category="looks"><comment x="0" y="0" w="103.33333333333333" collapsed="false">sets the ranges for the axes of the diagrams of a DataSprit</comment><header></header><code></code><translations></translations><inputs><input type="%n">-10</input><input type="%n">10</input><input type="%n">-10</input><input type="%n">10</input></inputs><script><block s="doWarp"><script><custom-block s="set property %s to %s"><l>xLeft</l><block var="xl"/></custom-block><custom-block s="set property %s to %s"><l>xRight</l><block var="xr"/></custom-block><custom-block s="set property %s to %s"><l>yLower</l><block var="yl"/></custom-block><custom-block s="set property %s to %s"><l>yUpper</l><block var="yu"/></custom-block><custom-block s="set offsets"></custom-block></script></block></script></block-definition><block-definition s="attributes %&apos;costumeProperty&apos;" type="reporter" category="looks"><comment x="0" y="0" w="255.66666866666685" collapsed="false">reads property groups of a DataSprite (especially for the shortened call of JavaScript functions)</comment><header></header><code></code><translations></translations><inputs><input type="%txt" readonly="true">labels<options>ranges&#xD;labels&#xD;back-color&#xD;offsets&#xD;line-attributes&#xD;datapoint-attributes&#xD;scale-attributes&#xD;data-attributes</options></input></inputs><script><block s="doWarp"><script><block s="doSetVar"><l>costumeProperty</l><block s="reportListItem"><l>1</l><block s="reportTextSplit"><block var="costumeProperty"/><l> </l></block></block></block><block s="doIf"><block s="reportEquals"><block var="costumeProperty"/><l>ranges</l></block><script><block s="doReport"><block s="reportNewList"><list><custom-block s="property %s"><l>xLeft</l></custom-block><custom-block s="property %s"><l>xRight</l></custom-block><custom-block s="property %s"><l>yLower</l></custom-block><custom-block s="property %s"><l>yUpper</l></custom-block></list></block></block></script></block><block s="doIf"><block s="reportEquals"><block var="costumeProperty"/><l>labels</l></block><script><block s="doReport"><block s="reportNewList"><list><custom-block s="property %s"><l>title</l></custom-block><custom-block s="property %s"><l>xLabel</l></custom-block><custom-block s="property %s"><l>yLabel</l></custom-block><custom-block s="property %s"><l>titleHeight</l></custom-block><custom-block s="property %s"><l>xLabelHeight</l></custom-block><custom-block s="property %s"><l>yLabelHeight</l></custom-block></list></block></block></script></block><block s="doIf"><block s="reportEquals"><block var="costumeProperty"/><l>back-color</l></block><script><block s="doReport"><block s="reportNewList"><list><custom-block s="property %s"><l>backColorRed</l></custom-block><custom-block s="property %s"><l>backColorGreen</l></custom-block><custom-block s="property %s"><l>backColorBlue</l></custom-block></list></block></block></script></block><block s="doIf"><block s="reportEquals"><block var="costumeProperty"/><l>offsets</l></block><script><block s="doReport"><block s="reportNewList"><list><custom-block s="property %s"><l>leftOffset</l></custom-block><custom-block s="property %s"><l>upperOffset</l></custom-block><custom-block s="property %s"><l>lowerOffset</l></custom-block></list></block></block></script></block><block s="doIf"><block s="reportEquals"><block var="costumeProperty"/><l>line-attributes</l></block><script><block s="doReport"><block s="reportNewList"><list><custom-block s="property %s"><l>lineStyle</l></custom-block><custom-block s="property %s"><l>lineWidth</l></custom-block><custom-block s="property %s"><l>lineColorRed</l></custom-block><custom-block s="property %s"><l>lineColorGreen</l></custom-block><custom-block s="property %s"><l>datapointColorBlue</l></custom-block></list></block></block></script></block><block s="doIf"><block s="reportEquals"><block var="costumeProperty"/><l>datapoint-attributes</l></block><script><block s="doReport"><block s="reportNewList"><list><custom-block s="property %s"><l>datapointStyle</l></custom-block><custom-block s="property %s"><l>datapointWidth</l></custom-block><custom-block s="property %s"><l>datapointConnected</l></custom-block><custom-block s="property %s"><l>datapointColorRed</l></custom-block><custom-block s="property %s"><l>datapointColorGreen</l></custom-block><custom-block s="property %s"><l>datapointColorBlue</l></custom-block></list></block></block></script></block><block s="doIf"><block s="reportEquals"><block var="costumeProperty"/><l>scale-attributes</l></block><script><block s="doReport"><block s="reportNewList"><list><custom-block s="property %s"><l>scalesPrecision</l></custom-block><custom-block s="property %s"><l>scalesTextheight</l></custom-block><custom-block s="property %s"><l>scalesNumberXintervals</l></custom-block></list></block></block></script></block><block s="doIf"><block s="reportEquals"><block var="costumeProperty"/><l>data-attributes</l></block><script><block s="doReport"><block s="reportNewList"><list><custom-block s="property %s"><l>columns</l></custom-block><custom-block s="property %s"><l>rows</l></custom-block><custom-block s="property %s"><l>minValue</l></custom-block><custom-block s="property %s"><l>maxValue</l></custom-block></list></block></block></script></block></script></block></script></block-definition><block-definition s="add scales" type="command" category="looks"><comment x="0" y="0" w="198.33333333333334" collapsed="false">draws and labels the axes of a DataSprite</comment><header></header><code></code><translations></translations><inputs></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>costume</l><l>scaleattributes</l><l>labels</l><l>offsets</l><l>ranges</l><l>backcolor</l></list><l>function xTOxp(x){return x0+(x*diagramWidth/(xRight-xLeft));}&#xD;function yTOyp(y){return y0-(y*diagramHeight/(yUpper-yLower));}&#xD;function xpTOx(xp){return (xp-x0)*(xRight-xLeft)/diagramWidth;}&#xD;function ypTOy(yp){return (y0-yp)*(yUpper-yLower)/diagramHeight;}&#xD;&#xD;function drawScales()&#xD;{&#xD;  var dx=(xRight-xLeft)/xIntervals, delta=xTOxp(dx)-x0, xpos=x0;&#xD;  var w,text;&#xD;&#xD;  while(xpos&gt;=0){xpos=xpos-delta;}&#xD;  while(xpos&lt;0){xpos=xpos+delta;}&#xD;  var x=xpTOx(xpos);&#xD;  ctx.lineWidth = 1;&#xD;  ctx.fillStyle = new Color(0,0,0).toString();&#xD;  ctx.strokeStyle = new Color(0,0,0).toString();&#xD;  ctx.font = ""+textheight+"px sans-serif";&#xD;  while(xpos&lt;=diagramWidth){&#xD;    text=x.toPrecision(n);&#xD;    w= ctx.measureText(text).width;&#xD;    ctx.moveTo(xpos+leftOffset,diagramHeight-3+upperOffset);&#xD;    ctx.lineTo(xpos+leftOffset,diagramHeight+upperOffset);&#xD;    ctx.moveTo(xpos+leftOffset,1+upperOffset);&#xD;    ctx.lineTo(xpos+leftOffset,3+upperOffset);&#xD;    if(xpos&lt;diagramWidth-10){ctx.fillText(text,xpos-w/2+leftOffset,diagramHeight+textheight+3+upperOffset);}&#xD;    xpos=xpos+delta;&#xD;    x=xpTOx(xpos);&#xD;  }    &#xD;  var dy=(yUpper-yLower)/10, delta=y0-yTOyp(dy), ypos=y0;&#xD;  while(ypos&gt;=0){ypos=ypos-delta;}&#xD;  ypos=ypos+delta;&#xD;  var y=ypTOy(ypos);&#xD;  while(ypos&lt;=diagramHeight){&#xD;    text=y.toPrecision(n);&#xD;    w= ctx.measureText(text).width;&#xD;    ctx.moveTo(1+leftOffset,ypos+upperOffset);&#xD;    ctx.lineTo(3+leftOffset,ypos+upperOffset);&#xD;    ctx.moveTo(rightCostumeEdge-3,ypos+upperOffset);&#xD;    ctx.lineTo(rightCostumeEdge,ypos+upperOffset);&#xD;    if(ypos&gt;10){ctx.fillText(text,leftOffset-25-w/2,ypos+3+upperOffset);}&#xD;    ypos=ypos+delta;&#xD;    y=ypTOy(ypos);&#xD;  }    &#xD;}&#xD;&#xD;//variables&#xD;var ctx = costume.contents.getContext(&apos;2d&apos;);&#xD;// to ensure the correct type "Number" to number parameters&#xD;var xLeft = Number(ranges.at(1)), xRight = Number(ranges.at(2)), yLower = Number(ranges.at(3)), yUpper = Number(ranges.at(4));&#xD;var upperOffset = Number(offsets.at(2)), lowerOffset = Number(offsets.at(3)), leftOffset = Number(offsets.at(1)),&#xD;    n=Number(scaleattributes.at(1)), textheight=Number(scaleattributes.at(2)),xIntervals=Number(scaleattributes.at(3));&#xD;&#xD;var rightCostumeEdge=costume.contents.width, lowerCostumeEdge=costume.contents.height,&#xD;    diagramWidth=rightCostumeEdge-leftOffset, diagramHeight=lowerCostumeEdge-lowerOffset-upperOffset;&#xD;var x0=xLeft/(xLeft-xRight)*diagramWidth, y0=yUpper/(yUpper-yLower)*diagramHeight,w;&#xD;var r=backcolor.at(1), g=backcolor.at(2), b=backcolor.at(3);&#xD;&#xD;//clear label regions&#xD;ctx.beginPath();&#xD;ctx.fillStyle = new Color(r,g,b).toString();&#xD;ctx.strokeStyle = new Color(0,0,0).toString();&#xD;ctx.lineWidth=1;&#xD;ctx.fillRect(0,0,rightCostumeEdge,upperOffset-1);&#xD;ctx.fillRect(0,0,leftOffset-1,lowerCostumeEdge);&#xD;ctx.fillRect(0,lowerCostumeEdge-lowerOffset+1,rightCostumeEdge,lowerCostumeEdge);&#xD;ctx.strokeRect(0,0,rightCostumeEdge,lowerCostumeEdge);&#xD;&#xD;//draw labels&#xD;ctx.fillStyle = new Color(0,0,0).toString();&#xD;if(upperOffset&gt;0){&#xD;  ctx.moveTo(0,upperOffset); ctx.lineTo(rightCostumeEdge-1,upperOffset);&#xD;  ctx.font = ""+labels.at(4)+"px sans-serif";&#xD;  var w= ctx.measureText(labels.at(1)).width;&#xD;  ctx.fillText(labels.at(1),rightCostumeEdge/2-w/2,22);&#xD;&#xD;}&#xD;ctx.moveTo(leftOffset,lowerCostumeEdge-lowerOffset);&#xD;ctx.lineTo(rightCostumeEdge,lowerCostumeEdge-lowerOffset);&#xD;if(labels.at(2).length&gt;0){&#xD;  ctx.font = ""+labels.at(5)+"px sans-serif";&#xD;  w= ctx.measureText(labels.at(2)).width;&#xD;  ctx.fillText(labels.at(2),diagramWidth/2+leftOffset-w/2,lowerCostumeEdge-6);&#xD;}&#xD;ctx.moveTo(leftOffset,upperOffset);&#xD;ctx.lineTo(leftOffset,lowerCostumeEdge-lowerOffset);&#xD;if(labels.at(3).length&gt;0){&#xD;  ctx.font = ""+labels.at(6)+"px sans-serif";&#xD;  w= ctx.measureText(labels.at(3)).width;&#xD;  ctx.rotate(-Math.PI/2);  &#xD;  ctx.fillText(labels.at(3),-w/2-lowerCostumeEdge/2,17);&#xD;  ctx.rotate(Math.PI/2);  &#xD;}&#xD;&#xD;drawScales();&#xD;&#xD;ctx.closePath();&#xD;ctx.fill();&#xD;ctx.stroke();&#xD;    &#xD;&#xD;</l></block><list><block var="myCostume"/><custom-block s="attributes %txt"><l>scale-attributes</l></custom-block><custom-block s="attributes %txt"><l>labels</l></custom-block><custom-block s="attributes %txt"><l>offsets</l></custom-block><custom-block s="attributes %txt"><l>ranges</l></custom-block><custom-block s="attributes %txt"><l>back-color</l></custom-block></list></block><block s="doSwitchToCostume"><block var="myCostume"/></block></script></block-definition><block-definition s="%&apos;n&apos; new data of ranges %&apos;xmin&apos; to %&apos;xmax&apos; and %&apos;ymin&apos; to %&apos;ymax&apos;" type="reporter" category="lists"><comment x="0" y="0" w="98.21917808219185" collapsed="false">creates new random data in the specified ranges</comment><header></header><code></code><translations></translations><inputs><input type="%n">10</input><input type="%n">-5</input><input type="%n">5</input><input type="%n">-5</input><input type="%n">5</input></inputs><script><block s="doDeclareVariables"><list><l>new data</l><l>x</l></list></block><block s="doWarp"><script><block s="doSetVar"><l>new data</l><block s="reportNewList"><list></list></block></block><block s="doRepeat"><block var="n"/><script><block s="doSetVar"><l>x</l><block s="reportSum"><block s="reportProduct"><block s="reportDifference"><block var="xmax"/><block var="xmin"/></block><custom-block s="random"></custom-block></block><block var="xmin"/></block></block><block s="doAddToList"><block s="reportNewList"><list><block var="x"/><block s="reportSum"><block var="x"/><block s="reportProduct"><block s="reportQuotient"><block var="ymax"/><l>2</l></block><custom-block s="random"></custom-block></block></block></list></block><block var="new data"/></block></script></block><block s="doReport"><block var="new data"/></block></script></block></script></block-definition><block-definition s="add dataplot number/number %&apos;data&apos;" type="command" category="looks"><comment x="0" y="0" w="132.5" collapsed="false">draws the data points of a two-dimensional table with numerical values</comment><header></header><code></code><translations></translations><inputs><input type="%s">myData</input></inputs><script><block s="doDeclareVariables"><list><l>source</l></list></block><block s="doWarp"><script><block s="doIfElse"><block s="reportEquals"><block var="data"/><l>myData</l></block><script><block s="doIfElse"><block s="reportEquals"><custom-block s="property %s"><l>type of data</l></custom-block><l>table</l></block><script><block s="doSetVar"><l>source</l><block var="myData"/></block></script><script><block s="doSayFor"><l>ERROR: impossible</l><l>2</l></block><block s="doSetVar"><l>source</l><l></l></block></script></block></script><script><block s="doSetVar"><l>source</l><block var="data"/></block></script></block><block s="doIf"><block s="reportIsA"><block var="source"/><l><option>list</option></l></block><script><block s="doRun"><block s="reportJSFunction"><list><l>costume</l><l>ranges</l><l>offsets</l><l>labels</l><l>lineattributes</l><l>dataattributes</l><l>data</l></list><l>function xTOxp(x){return x0+(x*diagramWidth/(xRight-xLeft));}&#xD;function yTOyp(y){return y0-(y*diagramHeight/(yUpper-yLower));}&#xD;function xpTOx(xp){return (xp-x0)*(xRight-xLeft)/diagramWidth;}&#xD;function ypTOy(yp){return (y0-yp)*(yUpper-yLower)/diagramHeight;}&#xD;function round(x,n){return Math.round(x*Math.pow(10,n))/Math.pow(10,n);}&#xD;function randomInt(min,max){return Math.floor(Math.random()*(max-min+1)+min);}&#xD;&#xD;&#xD;function plotData(){&#xD;  var i=0,linewidth=lineattributes.at(2),linestyle=1,datawidth=dataattributes.at(2),datastyle=1,&#xD;      connected=dataattributes.at(3);&#xD;  var arraydata=data.asArray(),xpos,ypos,xpOld,ypOld,w;&#xD;  if(lineattributes.at(1).trim()==&apos;continuous&apos;) linestyle = 1;&#xD;    else if(lineattributes.at(1).trim()==&apos;dashed&apos;) linestyle = 2;&#xD;      else if(lineattributes.at(1).trim()==&apos;dash-dot&apos;) linestyle = 3;&#xD;        else if(lineattributes.at(1).trim()==&apos;dot-dot&apos;) linestyle = 4;&#xD;  if(dataattributes.at(1).trim()== &apos;o circle&apos;) datastyle=1;&#xD;  else if(dataattributes.at(1).trim()== &apos;._point&apos;) datastyle=2;  &#xD;       else if(dataattributes.at(1).trim()==&apos;*_asterix&apos;) datastyle=3;&#xD;            else if(dataattributes.at(1).trim()== &apos;+_plus&apos;) datastyle=4;&#xD;                 else if(dataattributes.at(1).trim()== &apos;x_ex&apos;) datastyle=5;&#xD;                      else if(dataattributes.at(1).trim()== &apos;square&apos;) datastyle=6;&#xD;                           else if(dataattributes.at(1).trim()== &apos;triangle&apos;) datastyle=7;&#xD;                                else if(dataattributes.at(1).trim()== &apos;none&apos;) datastyle=8;&#xD;                                     else datastyle=1;&#xD;  ctx.strokeStyle=new Color(0,0,0).toString();&#xD;  ctx.fillStyle=new Color(dataattributes.at(4),dataattributes.at(5),dataattributes.at(6)).toString();&#xD;  ctx.lineWidth = linewidth;&#xD;  if(linestyle==2){ctx.setLineDash([10,5]);}&#xD;  else if(linestyle==3){ctx.setLineDash([10,2,1,2]);}    &#xD;       else if(linestyle==4){ctx.setLineDash([1,2]);}&#xD;            else{ctx.setLineDash([]);}&#xD;  if(arraydata.length&gt;0){&#xD;    xpOld= xTOxp(arraydata[0].at(1));&#xD;    ypOld=yTOyp(arraydata[0].at(2));&#xD;    }&#xD;  while(i&lt;arraydata.length){&#xD;    xpos=xTOxp(arraydata[i].at(1));&#xD;    ypos=yTOyp(arraydata[i].at(2));&#xD;    if(connected &amp;&amp; i&gt;0){&#xD;       ctx.beginPath();&#xD;       ctx.moveTo(xpOld+leftOffset,ypOld+upperOffset);&#xD;       ctx.lineTo(xpos+leftOffset,ypos+upperOffset);&#xD;       ctx.closePath();&#xD;       ctx.fill();&#xD;       ctx.stroke();     &#xD;       }&#xD;     ctx.beginPath();&#xD;     if(datastyle==1){&#xD;       ctx.arc(xpos+leftOffset,ypos+upperOffset,datawidth/2,0,6.283185307179586476925286766559);&#xD;       }&#xD;     if(datastyle==2){&#xD;       ctx.arc(xpos+leftOffset,ypos+upperOffset,2,0,6.283185307179586476925286766559);&#xD;       }&#xD;     if(datastyle==3){&#xD;       ctx.font = ""+datawidth+"px sans-serif";&#xD;       w= ctx.measureText("*").width;&#xD;       ctx.fillText("*",xpos+leftOffset-w/2,ypos+upperOffset+datawidth/2);&#xD;       }&#xD;     if(datastyle==4){&#xD;       ctx.font = ""+datawidth+"px sans-serif";&#xD;       w= ctx.measureText("+").width;&#xD;       ctx.fillText("+",xpos+leftOffset-w/2,ypos+upperOffset+datawidth/2);&#xD;       }&#xD;   if(datastyle==5){&#xD;      ctx.font = ""+datawidth+"px sans-serif";&#xD;      w= ctx.measureText("X").width;&#xD;      ctx.fillText("X",xpos+leftOffset-w/2,ypos+upperOffset+datawidth/2);&#xD;      }&#xD;   if(datastyle==6){&#xD;       ctx.fillRect(xpos+leftOffset-datawidth/2,ypos+upperOffset-datawidth/2,datawidth,datawidth);&#xD;       ctx.strokeRect(xpos+leftOffset-datawidth/2,ypos+upperOffset-datawidth/2,datawidth,datawidth);&#xD;       }&#xD;   if(datastyle==7){&#xD;       ctx.moveTo(xpos+leftOffset,ypos+upperOffset-datawidth/2);&#xD;       ctx.lineTo(xpos+leftOffset-datawidth/2,ypos+upperOffset+datawidth/2);&#xD;       ctx.lineTo(xpos+leftOffset+datawidth/2,ypos+upperOffset+datawidth/2);&#xD;       ctx.lineTo(xpos+leftOffset,ypos+upperOffset-datawidth/2);&#xD;        }&#xD;   if(datastyle==0){&#xD;       ctx.moveTo(xpos+leftOffset,ypos+upperOffset);&#xD;       ctx.lineTo(xpos+leftOffset,ypos+upperOffset+1);&#xD;        }&#xD;    ctx.closePath();&#xD;    ctx.fill();&#xD;    ctx.stroke();&#xD;    xpOld=xpos; ypOld=ypos;&#xD;    i=i+1;&#xD;&#xD;    }&#xD;    ctx.setLineDash([]);&#xD;  }&#xD;&#xD;// to ensure the correct type "Number" to number parameters&#xD;xLeft = Number(ranges.at(1));&#xD;xRight = Number(ranges.at(2));&#xD;yLower = Number(ranges.at(3));&#xD;yUpper = Number(ranges.at(4));&#xD;upperOffset = Number(offsets.at(2));&#xD;lowerOffset = Number(offsets.at(3));&#xD;leftOffset = Number(offsets.at(1));&#xD;&#xD;var ctx = costume.contents.getContext(&apos;2d&apos;);&#xD;var rightCostumeEdge=costume.contents.width, lowerCostumeEdge=costume.contents.height,&#xD;    diagramWidth=rightCostumeEdge-leftOffset, diagramHeight=lowerCostumeEdge-lowerOffset-upperOffset;&#xD;var x0=xLeft/(xLeft-xRight)*diagramWidth, y0=yUpper/(yUpper-yLower)*diagramHeight;&#xD;&#xD;plotData();       &#xD;&#xD;   </l></block><list><block var="myCostume"/><custom-block s="attributes %txt"><l>ranges</l></custom-block><custom-block s="attributes %txt"><l>offsets</l></custom-block><custom-block s="attributes %txt"><l>labels</l></custom-block><custom-block s="attributes %txt"><l>line-attributes</l></custom-block><custom-block s="attributes %txt"><l>datapoint-attributes</l></custom-block><block var="source"/></list></block><block s="doSwitchToCostume"><block var="myCostume"/></block></script></block></script></block></script></block-definition><block-definition s="regression line parameters of %&apos;data&apos;" type="reporter" category="lists"><comment x="0" y="0" w="121.66666666666667" collapsed="false">calculates the parameters of a regression line</comment><header></header><code></code><translations></translations><inputs><input type="%l"></input></inputs><script><block s="doDeclareVariables"><list><l>meanX</l><l>meanY</l><l>denominator</l><l>numerator</l><l>m</l><l>b</l></list></block><block s="doWarp"><script><block s="doIfElse"><custom-block s="is %s a %s ?"><block var="data"/><l>matrix</l></custom-block><script><block s="doIfElse"><block s="reportAnd"><block s="reportGreaterThan"><block s="reportListLength"><block var="data"/></block><l>0</l></block><block s="reportEquals"><block s="reportListLength"><block s="reportListItem"><l>1</l><block var="data"/></block></block><l>2</l></block></block><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>data</l></list><l>var meanX,meanY,sumX=0,sumY=0,numerator=0,denominator=0,m,b;&#xD;i=1;&#xD;while(i &lt;= data.length()) {&#xD;  sumX=sumX+Number(data.at(i).at(1));&#xD;  sumY=sumY+Number(data.at(i).at(2));&#xD;  i++;&#xD;  }&#xD;meanX=sumX/data.length();&#xD;meanY=sumY/data.length();&#xD;i=1;&#xD;while(i &lt;= data.length()) {&#xD;  numerator=numerator+(data.at(i).at(1)-meanX)*(data.at(i).at(2)-meanY);&#xD;  denominator=denominator+(data.at(i).at(1)-meanX)*(data.at(i).at(1)-meanX);&#xD;  i++;&#xD;  }&#xD;m=numerator/denominator;&#xD;b=meanY-m*meanX;&#xD;return new List([m,b]);     </l></block><list><block var="data"/></list></block></block></script><script><block s="doReport"><l>ERROR: wrong data format</l></block></script></block></script><script><block s="doReport"><l>ERROR: wrong data format</l></block></script></block></script></block></script></block-definition><block-definition s="add FITS or RGB image min/max %&apos;min&apos; %&apos;max&apos; gray? %&apos;gray&apos; log? %&apos;log&apos;" type="command" category="looks"><comment x="0" y="0" w="99.16666666666667" collapsed="false">generates an image from the FITS data of the DataSprite</comment><header></header><code></code><translations></translations><inputs><input type="%n">0</input><input type="%n">32757</input><input type="%b">true</input><input type="%b">false</input></inputs><script><block s="doWarp"><script><block s="doIfElse"><block s="reportEquals"><custom-block s="property %s"><l>type of data</l></custom-block><l>FITS</l></block><script><custom-block s="new costume width %n height %n color %n %n %n"><custom-block s="property %s"><l>width</l></custom-block><custom-block s="property %s"><l>height</l></custom-block><l>255</l><l>225</l><l>205</l></custom-block><block s="doRun"><block s="reportJSFunction"><list><l>costume</l><l>pixels</l></list><l>  var i, k,&#xD;    ctx = costume.contents.getContext(&apos;2d&apos;),&#xD;    src = pixels.asArray(),&#xD;    dta = ctx.createImageData(costume.width(), costume.height());&#xD;  for (i = 0; i &lt; src.length; i += 1) {&#xD;    px = src[i].asArray();&#xD;    for (k = 0; k &lt; 4; k += 1) {&#xD;      dta.data[(i * 4) + k] = px[k];&#xD;    }&#xD;  }&#xD;  ctx.putImageData(dta, 0, 0);</l></block><list><block var="myCostume"/><custom-block s="pixels from FITS data %s min %n max %n gray? %b log? %b"><l>myData</l><block var="min"/><block var="max"/><block var="gray"/><block var="log"/></custom-block></list></block><block s="doSwitchToCostume"><block var="myCostume"/></block></script><script><block s="doIfElse"><block s="reportEquals"><custom-block s="property %s"><l>type of data</l></custom-block><l>RGB</l></block><script><custom-block s="new costume width %n height %n color %n %n %n"><custom-block s="property %s"><l>width</l></custom-block><custom-block s="property %s"><l>height</l></custom-block><l>255</l><l>225</l><l>205</l></custom-block><block s="doRun"><block s="reportJSFunction"><list><l>costume</l><l>pixels</l></list><l>  var i, k,&#xD;    ctx = costume.contents.getContext(&apos;2d&apos;),&#xD;    src = pixels.asArray(),&#xD;    dta = ctx.createImageData(costume.width(), costume.height());&#xD;  for (i = 0; i &lt; src.length; i += 1) {&#xD;    px = src[i].asArray();&#xD;    for (k = 0; k &lt; 4; k += 1) {&#xD;      dta.data[(i * 4) + k] = px[k];&#xD;    }&#xD;  }&#xD;  ctx.putImageData(dta, 0, 0);</l></block><list><block var="myCostume"/><custom-block s="pixels from RGB data %s min %n max %n gray? %b log? %b"><l>myData</l><block var="min"/><block var="max"/><block var="gray"/><block var="log"/></custom-block></list></block><block s="doSwitchToCostume"><block var="myCostume"/></block></script><script><block s="doSayFor"><l>ERROR: impossible!</l><l>2</l></block></script></block></script></block></script></block></script></block-definition><block-definition s="pixels from FITS data %&apos;data&apos; min %&apos;min&apos; max %&apos;max&apos; gray? %&apos;gray&apos; log? %&apos;log&apos;" type="reporter" category="looks"><comment x="0" y="0" w="131.66666666666669" collapsed="false">calculates the pixels of a costume from the FITS data</comment><header></header><code></code><translations></translations><inputs><input type="%s">myData</input><input type="%n">0</input><input type="%n">32757</input><input type="%b">true</input><input type="%b">false</input></inputs><script><block s="doDeclareVariables"><list><l>source</l></list></block><block s="doWarp"><script><block s="doIfElse"><block s="reportEquals"><block var="data"/><l>myData</l></block><script><block s="doSetVar"><l>source</l><block var="myData"/></block></script><script><block s="doSetVar"><l>source</l><block var="data"/></block></script></block><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>data</l><l>min</l><l>max</l><l>gray</l><l>log</l></list><l>var result=[], i=1, n, value, interval = (max-min)/8;&#xD;while(i&lt;= data.length()) {&#xD;  value = data.at(i);&#xD;  n = value;&#xD;  if(value&lt;=min) n=min+1;&#xD;  if(value&gt;max) n =max;&#xD;  if(log) n = Math.round(Math.log(n-min)/Math.log(max-min)*255);&#xD;  else n = Math.round((n-min)/(max-min)*255);&#xD;  if(gray) result.push(new List([n,n,n,255]));&#xD;  else { // result.push(new List([n,255-n,Math.round(255-n/2),255]));&#xD;    if(value&lt;=min) {result.push(new List([0,0,0,255]));}&#xD;       else if(value&lt;min+interval) result.push(new List([0,0,n,255]));&#xD;            else if(value&lt;min+2*interval) result.push(new List([0,n,n,255]));&#xD;                 else if(value&lt;min+3*interval) result.push(new List([n,0,n,255]));&#xD;                      else if(value&lt;min+4*interval) result.push(new List([0,n,0,255]));&#xD;                           else if(value&lt;min+5*interval) result.push(new List([n,0,0,n]));&#xD;                                else if(value&lt;min+6*interval) result.push(new List([n,n/2,0,255]));&#xD;                                     else if(value&lt;min+7*interval) result.push(new List([n,n,0,255]));&#xD;                                          else if(value&lt;min+8*interval) result.push(new List([n,n,n,255]));&#xD;                                               else result.push(new List([255,255,255,255]));&#xD;     }&#xD;  i = i+1;&#xD;  }&#xD;return new List(result);</l></block><list><block var="source"/><block var="min"/><block var="max"/><block var="gray"/><block var="log"/></list></block></block></script></block></script></block-definition><block-definition s="image value of myData at %&apos;x&apos; %&apos;y&apos;" type="reporter" category="sensing"><comment x="0" y="0" w="132.5" collapsed="false">reads the data value at the position (x/y) of an image stored in myData</comment><header></header><code></code><translations></translations><inputs><input type="%n">1</input><input type="%n">1</input></inputs><script><block s="doWarp"><script><block s="doIfElse"><block s="reportIsA"><block var="myData"/><l><option>list</option></l></block><script><block s="doSetVar"><l>x</l><block s="reportRound"><block var="x"/></block></block><block s="doSetVar"><l>y</l><block s="reportRound"><block var="y"/></block></block><block s="doIfElse"><block s="reportOr"><block s="reportOr"><block s="reportGreaterThan"><block var="x"/><custom-block s="property %s"><l>width</l></custom-block></block><block s="reportGreaterThan"><block var="y"/><custom-block s="property %s"><l>height</l></custom-block></block></block><block s="reportOr"><block s="reportLessThan"><block var="x"/><l>1</l></block><block s="reportLessThan"><block var="y"/><l>1</l></block></block></block><script><block s="doReport"><l>-1</l></block></script><script><block s="doReport"><block s="reportListItem"><block s="reportSum"><block var="x"/><block s="reportProduct"><block s="reportDifference"><block var="y"/><l>1</l></block><custom-block s="property %s"><l>width</l></custom-block></block></block><block var="myData"/></block></block></script></block></script><script><block s="doReport"><l>ERROR: wrong data format</l></block></script></block></script></block></script></block-definition><block-definition s="draw line from %&apos;x1&apos; %&apos;y1&apos; to %&apos;x2&apos; %&apos;y2&apos;" type="command" category="looks"><comment x="0" y="0" w="90" collapsed="false">draws a line on present costume using line properties</comment><header></header><code></code><translations></translations><inputs><input type="%n">10</input><input type="%n">10</input><input type="%n">100</input><input type="%n">50</input></inputs><script><block s="doWarp"><script><block s="doRun"><block s="reportJSFunction"><list><l>costume</l><l>x1</l><l>y1</l><l>x2</l><l>y2</l><l>w</l><l>r</l><l>g</l><l>b</l></list><l>var ctx = costume.contents.getContext(&apos;2d&apos;);&#xD;ctx.beginPath();&#xD;ctx.lineWidth = w;&#xD;ctx.strokeStyle = new Color(r,g,b).toString();&#xD;ctx.moveTo(x1,y1);&#xD;ctx.lineTo(x2,y2);&#xD;ctx.closePath();&#xD;ctx.stroke();</l></block><list><block var="myCostume"/><block var="x1"/><block var="y1"/><block var="x2"/><block var="y2"/><custom-block s="property %s"><l>lineWidth</l></custom-block><custom-block s="property %s"><l>lineColorRed</l></custom-block><custom-block s="property %s"><l>lineColorGreen</l></custom-block><custom-block s="property %s"><l>datapointColorBlue</l></custom-block></list></block><block s="doSwitchToCostume"><block var="myCostume"/></block></script></block></script></block-definition><block-definition s="%&apos;selection&apos; column %&apos;x&apos; and %&apos;y&apos; of %&apos;table&apos;" type="reporter" category="lists"><comment x="0" y="0" w="90" collapsed="false">calculates the ranges, the covariance or the correlation between two columns of a table&#xD;</comment><header></header><code></code><translations></translations><inputs><input type="%txt" readonly="true">ranges<options>ranges&#xD;covariance&#xD;correlation</options></input><input type="%n">1</input><input type="%n">2</input><input type="%s">myData</input></inputs><script><block s="doDeclareVariables"><list><l>source</l></list></block><block s="doIfElse"><block s="reportEquals"><block var="table"/><l>myData</l></block><script><block s="doSetVar"><l>source</l><block var="myData"/></block></script><script><block s="doSetVar"><l>source</l><block var="table"/></block></script></block><block s="doIfElse"><custom-block s="is %s a %s ?"><block var="source"/><l>table</l></custom-block><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>selection</l><l>table</l><l>x</l><l>y</l></list><l>var xmin,xmax,ymin,ymax,meanx, meany,cov,corr,varx,vary,i,valx,valy;&#xD;if(table.contents.length&lt;1) return "bad data";&#xD;xmin=Number(table.at(1).at(x));&#xD;xmax=xmin;&#xD;ymin=Number(table.at(1).at(y));&#xD;ymax=ymin;&#xD;meanx=xmin; meany=ymin;&#xD;i=2;&#xD;while(i&lt;=table.contents.length){&#xD;  valx=Number(table.at(i).at(x));&#xD;  valy=Number(table.at(i).at(y));&#xD;  if(valx&lt;xmin) xmin=valx;&#xD;  if(valx&gt;xmax) xmax=valx;&#xD;  if(valy&lt;ymin) ymin=valy;&#xD;  if(valy&gt;ymax) ymax=valy;&#xD;  meanx=Number(meanx)+valx;&#xD;  meany=Number(meany)+valy;&#xD;  i++;&#xD;  }&#xD;meanx=meanx/(i-1);&#xD;meany=meany/(i-1);&#xD;if(selection=="ranges")&#xD;  return new List([xmin,xmax,ymin,ymax]);&#xD;&#xD;i=1; cov=0; corr=0; varx=0; vary=0;&#xD;while(i&lt;=table.contents.length){&#xD;  valx=Number(table.at(i).at(x));&#xD;  valy=Number(table.at(i).at(y));&#xD;  cov = Number(cov)+(valx-meanx)*(valy-meany);&#xD;  varx = Number(varx) +(valx-meanx)*(valx-meanx);&#xD;  vary = Number(vary) +(valy-meany)*(valy-meany);&#xD;  i++;&#xD;  }&#xD;varx=Math.sqrt(varx);&#xD;vary=Math.sqrt(vary);&#xD;corr = cov/(varx*vary);&#xD;cov=cov/(i-2);&#xD;if(selection=="covariance")&#xD;  return cov;&#xD;if(selection=="correlation")&#xD;  return corr;&#xD;return "unknown"</l></block><list><block s="reportListItem"><l>1</l><block s="reportTextSplit"><block var="selection"/><l> </l></block></block><block var="source"/><block var="x"/><block var="y"/></list></block></block></script><script><block s="doReport"><l>ERROR: wrong data format</l></block></script></block></script></block-definition><block-definition s="affine transformation of %&apos;imagedata&apos; w %&apos;w&apos; h %&apos;h&apos; by %&apos;originalPoints&apos; --&gt; %&apos;imagePoints&apos;" type="reporter" category="operators"><comment x="0" y="0" w="90" collapsed="false">applies an affine transformation to an image</comment><header></header><code></code><translations></translations><inputs><input type="%l"></input><input type="%n"></input><input type="%n"></input><input type="%l"></input><input type="%l"></input></inputs><script><block s="doDeclareVariables"><list><l>a11</l><l>a12</l><l>a13</l><l>a21</l><l>a22</l><l>a23</l><l>S</l><l>P1</l><l>P2</l><l>P3</l><l>Q1</l><l>Q2</l><l>Q3</l></list></block><block s="doWarp"><script><block s="doIfElse"><custom-block s="is %s a %s ?"><block var="imagedata"/><l>vector</l></custom-block><script><block s="doSetVar"><l>P1</l><block s="reportListItem"><l>1</l><block var="originalPoints"/></block></block><block s="doSetVar"><l>P2</l><block s="reportListItem"><l>2</l><block var="originalPoints"/></block></block><block s="doSetVar"><l>P3</l><block s="reportListItem"><l>3</l><block var="originalPoints"/></block></block><block s="doSetVar"><l>Q1</l><block s="reportListItem"><l>1</l><block var="imagePoints"/></block></block><block s="doSetVar"><l>Q2</l><block s="reportListItem"><l>2</l><block var="imagePoints"/></block></block><block s="doSetVar"><l>Q3</l><block s="reportListItem"><l>3</l><block var="imagePoints"/></block></block><block s="doSetVar"><l>S</l><block s="reportSum"><block s="reportProduct"><block s="reportListItem"><l>1</l><block var="P1"/></block><block s="reportDifference"><block s="reportListItem"><l>2</l><block var="P3"/></block><block s="reportListItem"><l>2</l><block var="P2"/></block></block></block><block s="reportSum"><block s="reportProduct"><block s="reportListItem"><l>1</l><block var="P2"/></block><block s="reportDifference"><block s="reportListItem"><l>2</l><block var="P1"/></block><block s="reportListItem"><l>2</l><block var="P3"/></block></block></block><block s="reportProduct"><block s="reportListItem"><l>1</l><block var="P3"/></block><block s="reportDifference"><block s="reportListItem"><l>2</l><block var="P2"/></block><block s="reportListItem"><l>2</l><block var="P1"/></block></block></block></block></block></block><block s="doIf"><block s="reportNot"><block s="reportEquals"><block var="S"/><l>0</l></block></block><script><block s="doSetVar"><l>a11</l><block s="reportQuotient"><block s="reportSum"><block s="reportProduct"><block s="reportListItem"><l>2</l><block var="P1"/></block><block s="reportDifference"><block s="reportListItem"><l>1</l><block var="Q2"/></block><block s="reportListItem"><l>1</l><block var="Q3"/></block></block></block><block s="reportSum"><block s="reportProduct"><block s="reportListItem"><l>2</l><block var="P2"/></block><block s="reportDifference"><block s="reportListItem"><l>1</l><block var="Q3"/></block><block s="reportListItem"><l>1</l><block var="Q1"/></block></block></block><block s="reportProduct"><block s="reportListItem"><l>2</l><block var="P3"/></block><block s="reportDifference"><block s="reportListItem"><l>1</l><block var="Q1"/></block><block s="reportListItem"><l>1</l><block var="Q2"/></block></block></block></block></block><block var="S"/></block></block><block s="doSetVar"><l>a12</l><block s="reportQuotient"><block s="reportSum"><block s="reportProduct"><block s="reportListItem"><l>1</l><block var="P1"/></block><block s="reportDifference"><block s="reportListItem"><l>1</l><block var="Q3"/></block><block s="reportListItem"><l>1</l><block var="Q2"/></block></block></block><block s="reportSum"><block s="reportProduct"><block s="reportListItem"><l>1</l><block var="P2"/></block><block s="reportDifference"><block s="reportListItem"><l>1</l><block var="Q1"/></block><block s="reportListItem"><l>1</l><block var="Q3"/></block></block></block><block s="reportProduct"><block s="reportListItem"><l>1</l><block var="P3"/></block><block s="reportDifference"><block s="reportListItem"><l>1</l><block var="Q2"/></block><block s="reportListItem"><l>1</l><block var="Q1"/></block></block></block></block></block><block var="S"/></block></block><block s="doSetVar"><l>a21</l><block s="reportQuotient"><block s="reportSum"><block s="reportProduct"><block s="reportListItem"><l>2</l><block var="P1"/></block><block s="reportDifference"><block s="reportListItem"><l>2</l><block var="Q2"/></block><block s="reportListItem"><l>2</l><block var="Q3"/></block></block></block><block s="reportSum"><block s="reportProduct"><block s="reportListItem"><l>2</l><block var="P2"/></block><block s="reportDifference"><block s="reportListItem"><l>2</l><block var="Q3"/></block><block s="reportListItem"><l>2</l><block var="Q1"/></block></block></block><block s="reportProduct"><block s="reportListItem"><l>2</l><block var="P3"/></block><block s="reportDifference"><block s="reportListItem"><l>2</l><block var="Q1"/></block><block s="reportListItem"><l>2</l><block var="Q2"/></block></block></block></block></block><block var="S"/></block></block><block s="doSetVar"><l>a22</l><block s="reportQuotient"><block s="reportSum"><block s="reportProduct"><block s="reportListItem"><l>1</l><block var="P1"/></block><block s="reportDifference"><block s="reportListItem"><l>2</l><block var="Q3"/></block><block s="reportListItem"><l>2</l><block var="Q2"/></block></block></block><block s="reportSum"><block s="reportProduct"><block s="reportListItem"><l>1</l><block var="P2"/></block><block s="reportDifference"><block s="reportListItem"><l>2</l><block var="Q1"/></block><block s="reportListItem"><l>2</l><block var="Q3"/></block></block></block><block s="reportProduct"><block s="reportListItem"><l>1</l><block var="P3"/></block><block s="reportDifference"><block s="reportListItem"><l>2</l><block var="Q2"/></block><block s="reportListItem"><l>2</l><block var="Q1"/></block></block></block></block></block><block var="S"/></block></block><block s="doSetVar"><l>a13</l><block s="reportQuotient"><block s="reportSum"><block s="reportProduct"><block s="reportListItem"><l>1</l><block var="P1"/></block><block s="reportDifference"><block s="reportProduct"><block s="reportListItem"><l>2</l><block var="P3"/></block><block s="reportListItem"><l>1</l><block var="Q2"/></block></block><block s="reportProduct"><block s="reportListItem"><l>2</l><block var="P2"/></block><block s="reportListItem"><l>1</l><block var="Q3"/></block></block></block></block><block s="reportSum"><block s="reportProduct"><block s="reportListItem"><l>1</l><block var="P2"/></block><block s="reportDifference"><block s="reportProduct"><block s="reportListItem"><l>2</l><block var="P1"/></block><block s="reportListItem"><l>1</l><block var="Q3"/></block></block><block s="reportProduct"><block s="reportListItem"><l>2</l><block var="P3"/></block><block s="reportListItem"><l>1</l><block var="Q1"/></block></block></block></block><block s="reportProduct"><block s="reportListItem"><l>1</l><block var="P3"/></block><block s="reportDifference"><block s="reportProduct"><block s="reportListItem"><l>2</l><block var="P2"/></block><block s="reportListItem"><l>1</l><block var="Q1"/></block></block><block s="reportProduct"><block s="reportListItem"><l>2</l><block var="P1"/></block><block s="reportListItem"><l>1</l><block var="Q2"/></block></block></block></block></block></block><block var="S"/></block></block><block s="doSetVar"><l>a23</l><block s="reportQuotient"><block s="reportSum"><block s="reportProduct"><block s="reportListItem"><l>1</l><block var="P1"/></block><block s="reportDifference"><block s="reportProduct"><block s="reportListItem"><l>2</l><block var="P3"/></block><block s="reportListItem"><l>2</l><block var="Q2"/></block></block><block s="reportProduct"><block s="reportListItem"><l>2</l><block var="P2"/></block><block s="reportListItem"><l>2</l><block var="Q3"/></block></block></block></block><block s="reportSum"><block s="reportProduct"><block s="reportListItem"><l>1</l><block var="P2"/></block><block s="reportDifference"><block s="reportProduct"><block s="reportListItem"><l>2</l><block var="P1"/></block><block s="reportListItem"><l>2</l><block var="Q3"/></block></block><block s="reportProduct"><block s="reportListItem"><l>2</l><block var="P3"/></block><block s="reportListItem"><l>2</l><block var="Q1"/></block></block></block></block><block s="reportProduct"><block s="reportListItem"><l>1</l><block var="P3"/></block><block s="reportDifference"><block s="reportProduct"><block s="reportListItem"><l>2</l><block var="P2"/></block><block s="reportListItem"><l>2</l><block var="Q1"/></block></block><block s="reportProduct"><block s="reportListItem"><l>2</l><block var="P1"/></block><block s="reportListItem"><l>2</l><block var="Q2"/></block></block></block></block></block></block><block var="S"/></block></block></script></block><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>a11</l><l>a12</l><l>a13</l><l>a21</l><l>a22</l><l>a23</l><l>w</l><l>h</l><l>data</l></list><l>var x,y,xnew,ynew,value,newdata=[];&#xD;for(var i=1;i&lt;=data.contents.length;i++) newdata.push(0);&#xD;for(var y=1;y&lt;=h;y++)&#xD;  for(var x=1;x&lt;=w;x++){&#xD;    value= data.at(x+(y-1)*w);&#xD;    xnew=Math.round(a11*x+a12*y+a13);&#xD;    ynew=Math.round(a21*x+a22*y+a23);&#xD;    if((xnew&gt;0) &amp;&amp; (xnew&lt;=w) &amp;&amp; (ynew&gt;0) &amp;&amp; (ynew&lt;=h)) newdata[xnew-1+(ynew-1)*w-1] = value; &#xD;}&#xD;return new List(newdata);</l></block><list><block var="a11"/><block var="a12"/><block var="a13"/><block var="a21"/><block var="a22"/><block var="a23"/><block var="w"/><block var="h"/><block var="imagedata"/></list></block></block></script><script><block s="doReport"><l>ERROR: wrong data format</l></block></script></block></script></block></script></block-definition><block-definition s="add histogram of %&apos;data&apos; with %&apos;n&apos; groups" type="command" category="looks"><comment x="0" y="0" w="90" collapsed="false">draws a histogram of the data</comment><header></header><code></code><translations></translations><inputs><input type="%s">myData</input><input type="%n">100</input></inputs><script><block s="doDeclareVariables"><list><l>histogramdata</l><l>ranges</l><l>source</l></list></block><block s="doWarp"><script><block s="doIfElse"><block s="reportEquals"><block var="data"/><l>myData</l></block><script><block s="doIfElse"><block s="reportAnd"><block s="reportOr"><block s="reportEquals"><custom-block s="property %s"><l>type of data</l></custom-block><l>table</l></block><block s="reportEquals"><custom-block s="property %s"><l>type of data</l></custom-block><l>FITS</l></block></block><block s="reportEquals"><custom-block s="property %s"><l>columns</l></custom-block><l>1</l></block></block><script><block s="doSetVar"><l>source</l><block var="myData"/></block></script><script><block s="doSayFor"><l>ERROR: wrong data format</l><l>2</l></block></script></block></script><script><block s="doSetVar"><l>source</l><block var="data"/></block></script></block><block s="doIfElse"><custom-block s="is %s a %s ?"><block var="source"/><l>vector</l></custom-block><script><block s="doSetVar"><l>histogramdata</l><custom-block s="histogram data from %l with %n groups"><block var="source"/><block var="n"/></custom-block></block><block s="doSetVar"><l>ranges</l><custom-block s="%txt column %n and %n of %s"><l>ranges</l><l>1</l><l>2</l><block var="histogramdata"/></custom-block></block><custom-block s="set ranges to x [ %n %n ] y [ %n %n ]"><block s="reportListItem"><l>1</l><block var="ranges"/></block><block s="reportListItem"><l>2</l><block var="ranges"/></block><l>0</l><block s="reportProduct"><l>1.1</l><block s="reportListItem"><l>4</l><block var="ranges"/></block></block></custom-block><custom-block s="set line attributes style %s width %n color %n %n %n"><l>continuous</l><l>1</l><l>255</l><l>0</l><l>0</l></custom-block><custom-block s="set scale attributes precision %n textheight %n number of intervalls x-axis %n"><l>5</l><l>10</l><l>5</l></custom-block><block s="doRun"><block s="reportJSFunction"><list><l>costume</l><l>ranges</l><l>offsets</l><l>lineattributes</l><l>data</l></list><l>function xTOxp(x){return x0+(x*diagramWidth/(xRight-xLeft));}&#xD;function yTOyp(y){return y0-(y*diagramHeight/(yUpper-yLower));}&#xD;function xpTOx(xp){return (xp-x0)*(xRight-xLeft)/diagramWidth;}&#xD;function ypTOy(yp){return (y0-yp)*(yUpper-yLower)/diagramHeight;}&#xD;&#xD;function plotHistogram(){&#xD;  var i=0,linestyle=1, arraydata=data.asArray(), xpos=5, deltaX=(diagramWidth-1)/data.contents.length;&#xD;  ctx.strokeStyle=new Color(0,0,0).toString();&#xD;  ctx.fillStyle=new Color(lineattributes.at(3),lineattributes.at(4),lineattributes.at(5)).toString();&#xD;  ctx.lineWidth = lineattributes.at(2);&#xD;  if(deltaX&lt;1) deltaX=1;&#xD;  while(i&lt;arraydata.length){&#xD;    ypos=yTOyp(arraydata[i].at(2));&#xD;    ctx.beginPath();&#xD;    ctx.fillRect(xpos+leftOffset,ypos+upperOffset,deltaX,y0);&#xD;    ctx.strokeRect(xpos+leftOffset,ypos+upperOffset,deltaX,y0);&#xD;    ctx.closePath();&#xD;    ctx.fill();&#xD;    ctx.stroke();     &#xD;    i=i+1;&#xD;    xpos=xpos+deltaX&#xD;    }&#xD;  }&#xD;&#xD;// to ensure the correct type "Number" to number parameters&#xD;xLeft = Number(ranges.at(1));&#xD;xRight = Number(ranges.at(2));&#xD;yLower = Number(ranges.at(3));&#xD;yUpper = Number(ranges.at(4));&#xD;leftOffset = Number(offsets.at(1));&#xD;upperOffset = Number(offsets.at(2));&#xD;lowerOffset = Number(offsets.at(3));&#xD;&#xD;var ctx = costume.contents.getContext(&apos;2d&apos;);&#xD;var rightCostumeEdge=costume.contents.width, lowerCostumeEdge=costume.contents.height,&#xD;    diagramWidth=rightCostumeEdge-leftOffset, diagramHeight=lowerCostumeEdge-lowerOffset-upperOffset;&#xD;var x0=xLeft/(xLeft-xRight)*diagramWidth, y0=yUpper/(yUpper-yLower)*diagramHeight;&#xD;&#xD;plotHistogram();       &#xD; </l></block><list><block var="myCostume"/><custom-block s="attributes %txt"><l>ranges</l></custom-block><custom-block s="attributes %txt"><l>offsets</l></custom-block><custom-block s="attributes %txt"><l>line-attributes</l></custom-block><block var="histogramdata"/></list></block><custom-block s="add scales"></custom-block><block s="doSwitchToCostume"><block var="myCostume"/></block></script><script><block s="doReport"><l>ERROR: wrong data format</l></block></script></block></script></block></script></block-definition><block-definition s="histogram data from %&apos;data&apos; with %&apos;n&apos; groups" type="reporter" category="lists"><comment x="0" y="0" w="90" collapsed="false">calculates the data for a histogram</comment><header></header><code></code><translations></translations><inputs><input type="%l"></input><input type="%n">10</input></inputs><script><block s="doDeclareVariables"><list><l>min</l><l>max</l><l>h</l></list></block><block s="doWarp"><script><block s="doIfElse"><custom-block s="is %s a %s ?"><block var="data"/><l>vector</l></custom-block><script><block s="doSetVar"><l>min</l><custom-block s="%txt of %l"><l>min</l><block var="data"/></custom-block></block><block s="doSetVar"><l>max</l><custom-block s="%txt of %l"><l>max</l><block var="data"/></custom-block></block><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>data</l><l>min</l><l>max</l><l>n</l></list><l>var delta=(max-min)/n, result=new Array(n), h=min+delta/2;&#xD;for(var i=0;i&lt;n;i++){&#xD;  result[i]=new List([h,0]);&#xD;  h=h+delta;&#xD;  }&#xD;for(var i=1;i&lt;=data.length();i++){&#xD;  h=Math.ceil((data.at(i)-min)/delta);&#xD;  if(h&lt;1) h=1;&#xD;  else if(h&gt;n) h=n;&#xD;  result[h-1]=new List([result[h-1].at(1),Number(result[h-1].at(2))+1]);&#xD;  }&#xD;return new List(result);</l></block><list><block var="data"/><block var="min"/><block var="max"/><block var="n"/></list></block></block></script><script><block s="doReport"><l>wrong data format</l></block></script></block></script></block></script></block-definition><block-definition s="copy of table %&apos;table&apos;" type="reporter" category="lists"><comment x="0" y="0" w="73.33333333333334" collapsed="false">reports a copy of a table</comment><header></header><code></code><translations></translations><inputs><input type="%l"></input></inputs><script><block s="doIfElse"><block s="reportOr"><custom-block s="is %s a %s ?"><block var="table"/><l>vector</l></custom-block><custom-block s="is %s a %s ?"><block var="table"/><l>table</l></custom-block></block><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>data</l></list><l>function listCopy(item){&#xD;  var theCopy;&#xD;  if(item instanceof List){&#xD;    theCopy = new List();&#xD;    for(var i=1;i&lt;=item.length();i++) theCopy.add(listCopy(item.at(i)));&#xD;    }&#xD;  else theCopy = item;&#xD;  return theCopy;&#xD;  }&#xD;return listCopy(data);</l></block><list><block var="table"/></list></block></block></script><script><block s="doReport"><l>ERROR: only lists supported</l></block></script></block></script></block-definition><block-definition s="round %&apos;x&apos; to %&apos;n&apos; digits" type="reporter" category="operators"><header></header><code></code><translations></translations><inputs><input type="%n"></input><input type="%n">2</input></inputs><script><block s="doReport"><block s="reportQuotient"><block s="reportRound"><block s="reportProduct"><block var="x"/><block s="reportMonadic"><l><option>10^</option></l><block var="n"/></block></block></block><block s="reportMonadic"><l><option>10^</option></l><block var="n"/></block></block></block></script></block-definition><block-definition s="RGB of costume at %&apos;x&apos; %&apos;y&apos;" type="reporter" category="sensing"><comment x="0" y="0" w="216.74657534246577" collapsed="false">reads the RGB value at the position (x/y) of the costume, JS-code copied from Snap!-code.</comment><header></header><code></code><translations></translations><inputs><input type="%n">1</input><input type="%n">1</input></inputs><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>costume</l><l>x</l><l>y</l></list><l>var ctx = costume.contents.getContext(&apos;2d&apos;);&#xD;var pixel = ctx.getImageData(x,y,1,1);&#xD;return new List(new Array(pixel.data[0],pixel.data[1],pixel.data[2]));&#xD;</l></block><list><block var="myCostume"/><block var="x"/><block var="y"/></list></block></block></script></block-definition><block-definition s="set RGB of costume at %&apos;x&apos; %&apos;y&apos; to %&apos;r&apos; %&apos;g&apos; %&apos;b&apos;" type="command" category="sensing"><comment x="0" y="0" w="90" collapsed="false">sets the RGB value al (x|y) on costume</comment><header></header><code></code><translations></translations><inputs><input type="%n">1</input><input type="%n">1</input><input type="%n">255</input><input type="%n">180</input><input type="%n">100</input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>r</l><l>g</l><l>b</l><l>x</l><l>y</l><l>costume</l></list><l>var ctx = costume.contents.getContext(&apos;2d&apos;);&#xD;ctx.beginPath();&#xD;ctx.lineWidth = 1;&#xD;ctx.strokeStyle = new Color(r,g,b).toString();&#xD;ctx.moveTo(x,y);&#xD;ctx.lineTo(x+1,y);&#xD;ctx.closePath();&#xD;ctx.stroke();</l></block><list><block var="r"/><block var="g"/><block var="b"/><block var="x"/><block var="y"/><block var="myCostume"/></list></block></script></block-definition><block-definition s="add graph %&apos;aFunction&apos;" type="command" category="looks"><comment x="0" y="0" w="150" collapsed="false">draws the graph of a function</comment><header></header><code></code><translations></translations><inputs><input type="%s">"ringifieded" operator or polynom</input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>costume</l><l>ranges</l><l>offsets</l><l>lineattributes</l><l>aFunction</l><l>proc</l></list><l>function xTOxp(x){return x0+(x*diagramWidth/(xRight-xLeft));}&#xD;function yTOyp(y){return y0-(y*diagramHeight/(yUpper-yLower));}&#xD;function xpTOx(xp){return (xp-x0)*(xRight-xLeft)/diagramWidth;}&#xD;function ypTOy(yp){return (y0-yp)*(yUpper-yLower)/diagramHeight;}&#xD;function round(x,n){return Math.round(x*Math.pow(10,n))/Math.pow(10,n);}&#xD;function randomInt(min,max){return Math.floor(Math.random()*(max-min+1)+min);}&#xD;&#xD;function myFunction(f,x){&#xD;if(f instanceof List){&#xD;    var grade = f.length(),result;&#xD;    if(grade==0) return 0;&#xD;    else if(grade==1) return Number(f.at(1));&#xD;         else{&#xD;           result=Number(f.at(1))*Number(x)+Number(f.at(2));&#xD;           for(var i=3;i&lt;=grade;i++) result = result*Number(x)+Number(f.at(i));&#xD;           return result;&#xD;           }&#xD;    } &#xD;  else return proc.reportAtomicMap(f,new List([x])).at(1); //copied from Snap!-code&#xD;  }&#xD;&#xD;function plotFunction(f,r,g,b,){&#xD;  var xpos,ypos,x,y,xpOld,ypOld,plottedDots=0,missingDots=0,style=1, modus = 1;&#xD;  //firstLineattribute=lineattributes.at(1).split(" ")[0];&#xD;  if(lineattributes.at(1).trim()==&apos;continuous&apos;) style = 1;&#xD;    else if(lineattributes.at(1).trim()==&apos;dashed&apos;) style = 2;&#xD;      else if(lineattributes.at(1).trim()==&apos;dash-dot&apos;) style = 3;&#xD;        else if(lineattributes.at(1).trim()==&apos;dot-dot&apos;) style = 4;&#xD;  ctx.beginPath();&#xD;  ctx.strokeStyle=new Color(r,g,b).toString();&#xD;  ctx.fillStyle=new Color(r,g,b).toString();&#xD;  ctx.lineWidth = lineattributes.at(2);&#xD;  xpOld=0;&#xD;  x=xpTOx(xpOld);&#xD;  y=myFunction(f,x);&#xD;  ypOld=yTOyp(y);&#xD;  xpos=1;&#xD;  while(xpos&lt;=diagramWidth){&#xD;    x=xpTOx(xpos);&#xD;    y=myFunction(f,x);&#xD;    ypos=yTOyp(y);&#xD;    if(modus&gt;0) {&#xD;      ctx.moveTo(xpOld+leftOffset,ypOld+upperOffset);&#xD;      ctx.lineTo(xpos+leftOffset,ypos+upperOffset);&#xD;      if(style&gt;1) plottedDots++;&#xD;      }&#xD;    else missingDots++;&#xD;    xpOld=xpos; ypOld=ypos;&#xD;    xpos=xpos+1;&#xD;    if(style==2){&#xD;      if((modus==1) &amp;&amp; (plottedDots&gt;3)) {modus = 0; plottedDots=0; missingDots=0;}&#xD;      else if((modus==0) &amp;&amp; (missingDots&gt;2)) {modus = 1; plottedDots=0; missingDots=0;}&#xD;      }&#xD;    if(style==3){&#xD;      if((modus==1) &amp;&amp; (plottedDots&gt;3)) {modus = 0; plottedDots=0; missingDots=0;}&#xD;      else if((modus==0) &amp;&amp; (missingDots&gt;0)) {modus = 2; plottedDots=0; missingDots=0;}&#xD;           else if((modus==2) &amp;&amp; (plottedDots&gt;0)) {modus = -1; plottedDots=0; missingDots=0;}&#xD;                else if((modus==-1) &amp;&amp; (missingDots&gt;0)) {modus = 1; plottedDots=0; missingDots=0;}&#xD;      }&#xD;    if(style==4){&#xD;      if((modus==1) &amp;&amp; (plottedDots&gt;0)) {modus = 0; plottedDots=0; missingDots=0;}&#xD;      else if((modus==0) &amp;&amp; (missingDots&gt;0)) {modus = 1; plottedDots=0; missingDots=0;}&#xD;      }&#xD;    }&#xD;  ctx.closePath();&#xD;  //ctx.fill();&#xD;  ctx.stroke();&#xD; &#xD;}&#xD;&#xD;// to ensure the correct type "Number" to number parameters&#xD;xLeft = Number(ranges.at(1));&#xD;xRight = Number(ranges.at(2));&#xD;yLower = Number(ranges.at(3));&#xD;yUpper = Number(ranges.at(4));&#xD;upperOffset = Number(offsets.at(2));&#xD;lowerOffset = Number(offsets.at(3));&#xD;leftOffset = Number(offsets.at(1));&#xD;&#xD;var ctx = costume.contents.getContext(&apos;2d&apos;);&#xD;var rightCostumeEdge=costume.contents.width, lowerCostumeEdge=costume.contents.height,&#xD;    diagramWidth=rightCostumeEdge-leftOffset, diagramHeight=lowerCostumeEdge-lowerOffset-upperOffset;&#xD;var x0=xLeft/(xLeft-xRight)*diagramWidth, y0=yUpper/(yUpper-yLower)*diagramHeight;&#xD;&#xD;&#xD;plotFunction(aFunction,Number(lineattributes.at(3)),Number(lineattributes.at(4)),Number(lineattributes.at(5)));</l></block><list><block var="myCostume"/><custom-block s="attributes %txt"><l>ranges</l></custom-block><custom-block s="attributes %txt"><l>offsets</l></custom-block><custom-block s="attributes %txt"><l>line-attributes</l></custom-block><block var="aFunction"/></list></block><block s="doSwitchToCostume"><block var="myCostume"/></block></script></block-definition><block-definition s="%&apos;data&apos; by mouse" type="reporter" category="sensing"><comment w="146.66666666666669" collapsed="false">obtaining data with the mouse</comment><header></header><code></code><translations></translations><inputs><input type="%txt">image-value<options>image-value&#xD;image-coordinates&#xD;graph-coordinates&#xD;slice-data&#xD;line-data&#xD;circle-data&#xD;brightness</options></input></inputs><script><block s="doDeclareVariables"><list><l>h</l><l>result</l><l>i</l><l>m</l><l>pixel</l><l>dist</l><l>dx</l><l>dy</l><l>points</l><l>x1</l><l>y1</l><l>x2</l><l>y2</l><l>x</l><l>y</l><l>p1</l><l>p2</l><l>w</l><l>h</l><l>secondCostume</l><l>ok</l><l>xold</l><l>yold</l><l>radius</l><l>sumOfValues</l><l>value</l><l>center</l></list></block><block s="doWarp"><script><block s="doSetVar"><l>data</l><block s="reportListItem"><l>1</l><block s="reportTextSplit"><block var="data"/><l> </l></block></block></block><block s="doIf"><block s="reportEquals"><block s="reportListItem"><l>1</l><block s="reportTextSplit"><block var="data"/><l><option>whitespace</option></l></block></block><l>image-value</l></block><script><block s="doSetVar"><l>x</l><block s="reportSum"><block s="reportRound"><block s="reportProduct"><l>100</l><block s="reportQuotient"><block s="reportDifference"><block s="reportMouseX"></block><block s="xPosition"></block></block><block s="getScale"></block></block></block></block><l>1</l></block></block><block s="doSetVar"><l>y</l><block s="reportSum"><block s="reportRound"><block s="reportProduct"><l>100</l><block s="reportQuotient"><block s="reportDifference"><block s="yPosition"></block><block s="reportMouseY"></block></block><block s="getScale"></block></block></block></block><l>1</l></block></block><block s="doIfElse"><block s="reportOr"><block s="reportOr"><block s="reportGreaterThan"><block var="x"/><custom-block s="property %s"><l>width</l></custom-block></block><block s="reportGreaterThan"><block var="y"/><custom-block s="property %s"><l>height</l></custom-block></block></block><block s="reportOr"><block s="reportLessThan"><block var="x"/><l>1</l></block><block s="reportLessThan"><block var="y"/><l>1</l></block></block></block><script><block s="doReport"><l>-1</l></block></script><script><block s="doReport"><block s="reportListItem"><block s="reportSum"><block var="x"/><block s="reportProduct"><block s="reportDifference"><block var="y"/><l>1</l></block><custom-block s="property %s"><l>width</l></custom-block></block></block><block var="myData"/></block></block></script></block></script></block><block s="doIf"><block s="reportEquals"><block s="reportListItem"><l>1</l><block s="reportTextSplit"><block var="data"/><l><option>whitespace</option></l></block></block><l>image-coordinates</l></block><script><block s="doReport"><block s="reportNewList"><list><block s="reportSum"><block s="reportRound"><block s="reportProduct"><l>100</l><block s="reportQuotient"><block s="reportDifference"><block s="reportMouseX"></block><block s="xPosition"></block></block><block s="getScale"></block></block></block></block><l>1</l></block><block s="reportSum"><block s="reportRound"><block s="reportProduct"><l>100</l><block s="reportQuotient"><block s="reportDifference"><block s="yPosition"></block><block s="reportMouseY"></block></block><block s="getScale"></block></block></block></block><l>1</l></block></list></block></block></script></block><block s="doIf"><block s="reportEquals"><block s="reportListItem"><l>1</l><block s="reportTextSplit"><block var="data"/><l><option>whitespace</option></l></block></block><l>graph-coordinates</l></block><script><block s="doSetVar"><l>x</l><block s="reportSum"><block s="reportRound"><block s="reportProduct"><l>100</l><block s="reportQuotient"><block s="reportDifference"><block s="reportMouseX"></block><block s="xPosition"></block></block><block s="getScale"></block></block></block></block><l>1</l></block></block><block s="doSetVar"><l>y</l><block s="reportSum"><block s="reportRound"><block s="reportProduct"><l>100</l><block s="reportQuotient"><block s="reportDifference"><block s="yPosition"></block><block s="reportMouseY"></block></block><block s="getScale"></block></block></block></block><l>1</l></block></block><block s="doIfElse"><block s="reportOr"><block s="reportOr"><block s="reportGreaterThan"><block var="x"/><custom-block s="property %s"><l>width</l></custom-block></block><block s="reportGreaterThan"><block var="y"/><block s="reportDifference"><custom-block s="property %s"><l>height</l></custom-block><custom-block s="property %s"><l>lowerOffset</l></custom-block></block></block></block><block s="reportOr"><block s="reportLessThan"><block var="x"/><custom-block s="property %s"><l>leftOffset</l></custom-block></block><block s="reportLessThan"><block var="y"/><custom-block s="property %s"><l>upperOffset</l></custom-block></block></block></block><script><block s="doReport"><block s="reportNewList"><list><l>outside</l><l></l></list></block></block></script><script><block s="doReport"><block s="reportNewList"><list><custom-block s="%n to %txt"><block var="x"/><l>x</l></custom-block><custom-block s="%n to %txt"><block var="y"/><l>y</l></custom-block></list></block></block></script></block></script></block><block s="doIf"><block s="reportEquals"><block s="reportListItem"><l>1</l><block s="reportTextSplit"><block var="data"/><l><option>whitespace</option></l></block></block><l>slice-data</l></block><script><block s="doSwitchToCostume"><block var="myCostume"/></block><block s="doSetVar"><l>points</l><custom-block s="%txt by mouse"><l>line-data</l></custom-block></block><block s="doSetVar"><l>x1</l><block s="reportListItem"><l>1</l><block s="reportListItem"><l>1</l><block var="points"/></block></block></block><block s="doSetVar"><l>y1</l><block s="reportListItem"><l>2</l><block s="reportListItem"><l>1</l><block var="points"/></block></block></block><block s="doSetVar"><l>x2</l><block s="reportListItem"><l>1</l><block s="reportListItem"><l>2</l><block var="points"/></block></block></block><block s="doSetVar"><l>y2</l><block s="reportListItem"><l>2</l><block s="reportListItem"><l>2</l><block var="points"/></block></block></block><block s="doSetVar"><l>result</l><block s="reportNewList"><list></list></block></block><block s="doSetVar"><l>dist</l><block s="reportRound"><block s="reportMonadic"><l><option>sqrt</option></l><block s="reportSum"><block s="reportProduct"><block s="reportDifference"><block var="x1"/><block var="x2"/></block><block s="reportDifference"><block var="x1"/><block var="x2"/></block></block><block s="reportProduct"><block s="reportDifference"><block var="y1"/><block var="y2"/></block><block s="reportDifference"><block var="y1"/><block var="y2"/></block></block></block></block></block></block><block s="doSetVar"><l>dx</l><block s="reportQuotient"><block s="reportDifference"><block var="x2"/><block var="x1"/></block><block var="dist"/></block></block><block s="doSetVar"><l>dy</l><block s="reportQuotient"><block s="reportDifference"><block var="y2"/><block var="y1"/></block><block var="dist"/></block></block><block s="doSetVar"><l>i</l><l>0</l></block><block s="doUntil"><block s="reportGreaterThan"><block var="i"/><block var="dist"/></block><script><block s="doAddToList"><block s="reportNewList"><list><block var="i"/><custom-block s="image value of myData at %n %n"><block s="reportSum"><block var="x1"/><block s="reportProduct"><block var="i"/><block var="dx"/></block></block><block s="reportSum"><block var="y1"/><block s="reportProduct"><block var="i"/><block var="dy"/></block></block></custom-block></list></block><block var="result"/></block><block s="doChangeVar"><l>i</l><l>1</l></block></script></block><block s="doReport"><block var="result"/></block></script></block><block s="doIf"><block s="reportEquals"><block s="reportListItem"><l>1</l><block s="reportTextSplit"><block var="data"/><l><option>whitespace</option></l></block></block><l>line-data</l></block><script><block s="doSetVar"><l>w</l><custom-block s="property %s"><l>width</l></custom-block></block><block s="doSetVar"><l>h</l><custom-block s="property %s"><l>height</l></custom-block></block><block s="doSetVar"><l>secondCostume</l><custom-block s="copy of costume %obj"><block s="reportGet"><l><option>costume</option></l></block></custom-block></block><custom-block s="set line attributes style %s width %n color %n %n %n"><l>continuous</l><l>1</l><l>255</l><l>255</l><l>0</l></custom-block><block s="doRun"><block s="reifyScript"><script><block s="doSetVar"><l></l><block s="reportBoolean"><l><bool>false</bool></l></block></block></script><list></list></block><list><block s="reifyReporter"><autolambda><block s="reportGet"><l><option>draggable?</option></l></block></autolambda><list></list></block></list></block><block s="doSetVar"><l>ok</l><block s="reportBoolean"><l><bool>false</bool></l></block></block><block s="doUntil"><block var="ok"/><script><block s="doIf"><block s="reportMouseDown"></block><script><block s="doSetVar"><l>p1</l><custom-block s="%txt by mouse"><l>image-coordinates</l></custom-block></block><block s="doIf"><block s="reportAnd"><block s="reportGreaterThan"><block s="reportListItem"><l>1</l><block var="p1"/></block><l>-1</l></block><block s="reportAnd"><block s="reportLessThan"><block s="reportListItem"><l>1</l><block var="p1"/></block><block s="reportSum"><block var="w"/><l>1</l></block></block><block s="reportAnd"><block s="reportGreaterThan"><block s="reportListItem"><l>2</l><block var="p1"/></block><l>-1</l></block><block s="reportLessThan"><block s="reportListItem"><l>2</l><block var="p1"/></block><block s="reportSum"><block var="h"/><l>1</l></block></block></block></block></block><script><block s="doSetVar"><l>xold</l><block s="reportListItem"><l>1</l><block var="p1"/></block></block><block s="doSetVar"><l>yold</l><block s="reportListItem"><l>2</l><block var="p1"/></block></block><block s="doSetVar"><l>ok</l><block s="reportBoolean"><l><bool>true</bool></l></block></block></script></block></script></block></script></block><block s="doSetVar"><l>ok</l><block s="reportBoolean"><l><bool>false</bool></l></block></block><block s="doUntil"><block var="ok"/><script><block s="doSetVar"><l>p2</l><custom-block s="%txt by mouse"><l>image-coordinates</l></custom-block></block><block s="doIf"><block s="reportOr"><block s="reportNot"><block s="reportEquals"><block s="reportListItem"><l>1</l><block var="p2"/></block><block var="xold"/></block></block><block s="reportNot"><block s="reportEquals"><block s="reportListItem"><l>2</l><block var="p2"/></block><block var="yold"/></block></block></block><script><block s="doSwitchToCostume"><block var="secondCostume"/></block><block s="doSetVar"><l>myCostume</l><custom-block s="copy of costume %obj"><block s="reportGet"><l><option>costume</option></l></block></custom-block></block><block s="doSetVar"><l>xold</l><block s="reportListItem"><l>1</l><block var="p2"/></block></block><block s="doSetVar"><l>yold</l><block s="reportListItem"><l>2</l><block var="p2"/></block></block><block s="doSwitchToCostume"><block var="myCostume"/></block><custom-block s="draw line from %n %n to %n %n"><block s="reportListItem"><l>1</l><block var="p1"/></block><block s="reportListItem"><l>2</l><block var="p1"/></block><block s="reportListItem"><l>1</l><block var="p2"/></block><block s="reportListItem"><l>2</l><block var="p2"/></block></custom-block></script></block><block s="doIf"><block s="reportNot"><block s="reportMouseDown"></block></block><script><block s="doIf"><block s="reportAnd"><block s="reportGreaterThan"><block s="reportListItem"><l>1</l><block var="p2"/></block><l>-1</l></block><block s="reportAnd"><block s="reportLessThan"><block s="reportListItem"><l>1</l><block var="p2"/></block><block s="reportSum"><block var="w"/><l>1</l></block></block><block s="reportAnd"><block s="reportGreaterThan"><block s="reportListItem"><l>2</l><block var="p2"/></block><l>-1</l></block><block s="reportLessThan"><block s="reportListItem"><l>2</l><block var="p2"/></block><block s="reportSum"><block var="h"/><l>1</l></block></block></block></block></block><script><block s="doSetVar"><l>ok</l><block s="reportBoolean"><l><bool>true</bool></l></block></block></script></block></script></block></script></block><block s="doRun"><block s="reifyScript"><script><block s="doSetVar"><l></l><block s="reportBoolean"><l><bool>true</bool></l></block></block></script><list></list></block><list><block s="reifyReporter"><autolambda><block s="reportGet"><l><option>draggable?</option></l></block></autolambda><list></list></block></list></block><block s="doReport"><block s="reportNewList"><list><block var="p1"/><block var="p2"/></list></block></block></script></block><block s="doIf"><block s="reportEquals"><block s="reportListItem"><l>1</l><block s="reportTextSplit"><block var="data"/><l><option>whitespace</option></l></block></block><l>circle-data</l></block><script><block s="doSetVar"><l>w</l><custom-block s="property %s"><l>width</l></custom-block></block><block s="doSetVar"><l>h</l><custom-block s="property %s"><l>height</l></custom-block></block><block s="doSetVar"><l>secondCostume</l><custom-block s="copy of costume %obj"><block s="reportGet"><l><option>costume</option></l></block></custom-block></block><custom-block s="set line attributes style %s width %n color %n %n %n"><l>continuous</l><l>1</l><l>255</l><l>255</l><l>0</l></custom-block><block s="doRun"><block s="reifyScript"><script><block s="doSetVar"><l></l><block s="reportBoolean"><l><bool>false</bool></l></block></block></script><list></list></block><list><block s="reifyReporter"><autolambda><block s="reportGet"><l><option>draggable?</option></l></block></autolambda><list></list></block></list></block><block s="doSetVar"><l>ok</l><block s="reportBoolean"><l><bool>false</bool></l></block></block><block s="doUntil"><block var="ok"/><script><block s="doIf"><block s="reportMouseDown"></block><script><block s="doSetVar"><l>p1</l><custom-block s="%txt by mouse"><l>image-coordinates</l></custom-block></block><block s="doIf"><block s="reportAnd"><block s="reportGreaterThan"><block s="reportListItem"><l>1</l><block var="p1"/></block><l>-1</l></block><block s="reportAnd"><block s="reportLessThan"><block s="reportListItem"><l>1</l><block var="p1"/></block><block s="reportSum"><block var="w"/><l>1</l></block></block><block s="reportAnd"><block s="reportGreaterThan"><block s="reportListItem"><l>2</l><block var="p1"/></block><l>-1</l></block><block s="reportLessThan"><block s="reportListItem"><l>2</l><block var="p1"/></block><block s="reportSum"><block var="h"/><l>1</l></block></block></block></block></block><script><block s="doSetVar"><l>xold</l><block s="reportListItem"><l>1</l><block var="p1"/></block></block><block s="doSetVar"><l>yold</l><block s="reportListItem"><l>2</l><block var="p1"/></block></block><block s="doSetVar"><l>ok</l><block s="reportBoolean"><l><bool>true</bool></l></block></block></script></block></script></block></script></block><block s="doSetVar"><l>ok</l><block s="reportBoolean"><l><bool>false</bool></l></block></block><block s="doUntil"><block var="ok"/><script><block s="doSetVar"><l>p2</l><custom-block s="%txt by mouse"><l>image-coordinates</l></custom-block></block><block s="doIf"><block s="reportOr"><block s="reportNot"><block s="reportEquals"><block s="reportListItem"><l>1</l><block var="p2"/></block><block var="xold"/></block></block><block s="reportNot"><block s="reportEquals"><block s="reportListItem"><l>2</l><block var="p2"/></block><block var="yold"/></block></block></block><script><block s="doSwitchToCostume"><block var="secondCostume"/></block><block s="doSetVar"><l>myCostume</l><custom-block s="copy of costume %obj"><block s="reportGet"><l><option>costume</option></l></block></custom-block></block><block s="doSetVar"><l>xold</l><block s="reportListItem"><l>1</l><block var="p2"/></block></block><block s="doSetVar"><l>yold</l><block s="reportListItem"><l>2</l><block var="p2"/></block></block><block s="doSetVar"><l>radius</l><block s="reportRound"><block s="reportMonadic"><l><option>sqrt</option></l><block s="reportSum"><block s="reportProduct"><block s="reportDifference"><block s="reportListItem"><l>1</l><block var="p1"/></block><block s="reportListItem"><l>1</l><block var="p2"/></block></block><block s="reportDifference"><block s="reportListItem"><l>1</l><block var="p1"/></block><block s="reportListItem"><l>1</l><block var="p2"/></block></block></block><block s="reportProduct"><block s="reportDifference"><block s="reportListItem"><l>2</l><block var="p1"/></block><block s="reportListItem"><l>2</l><block var="p2"/></block></block><block s="reportDifference"><block s="reportListItem"><l>2</l><block var="p1"/></block><block s="reportListItem"><l>2</l><block var="p2"/></block></block></block></block></block></block></block><custom-block s="set line attributes style %s width %n color %n %n %n"><l>continuous</l><l>3</l><l>255</l><l>255</l><l>0</l></custom-block><custom-block s="draw line from %n %n to %n %n"><block s="reportDifference"><block s="reportListItem"><l>1</l><block var="p1"/></block><l>1</l></block><block s="reportListItem"><l>2</l><block var="p1"/></block><block s="reportSum"><block s="reportListItem"><l>1</l><block var="p1"/></block><l>1</l></block><block s="reportListItem"><l>2</l><block var="p1"/></block></custom-block><custom-block s="set line attributes style %s width %n color %n %n %n"><l>continuous</l><l>1</l><l>255</l><l>255</l><l>0</l></custom-block><custom-block s="draw circle center %n %n radius %n"><block s="reportListItem"><l>1</l><block var="p1"/></block><block s="reportListItem"><l>2</l><block var="p1"/></block><block var="radius"/></custom-block><block s="doSwitchToCostume"><block var="myCostume"/></block></script></block><block s="doIf"><block s="reportNot"><block s="reportMouseDown"></block></block><script><block s="doIf"><block s="reportAnd"><block s="reportGreaterThan"><block s="reportListItem"><l>1</l><block var="p2"/></block><l>-1</l></block><block s="reportAnd"><block s="reportLessThan"><block s="reportListItem"><l>1</l><block var="p2"/></block><block s="reportSum"><block var="w"/><l>1</l></block></block><block s="reportAnd"><block s="reportGreaterThan"><block s="reportListItem"><l>2</l><block var="p2"/></block><l>-1</l></block><block s="reportLessThan"><block s="reportListItem"><l>2</l><block var="p2"/></block><block s="reportSum"><block var="h"/><l>1</l></block></block></block></block></block><script><block s="doSetVar"><l>ok</l><block s="reportBoolean"><l><bool>true</bool></l></block></block></script></block></script></block></script></block><block s="doRun"><block s="reifyScript"><script><block s="doSetVar"><l></l><block s="reportBoolean"><l><bool>true</bool></l></block></block></script><list></list></block><list><block s="reifyReporter"><autolambda><block s="reportGet"><l><option>draggable?</option></l></block></autolambda><list></list></block></list></block><block s="doSwitchToCostume"><block var="secondCostume"/></block><block s="doReport"><block s="reportNewList"><list><block var="p1"/><block var="radius"/></list></block></block></script></block><block s="doIf"><block s="reportEquals"><block s="reportListItem"><l>1</l><block s="reportTextSplit"><block var="data"/><l><option>whitespace</option></l></block></block><l>brightness</l></block><script><block s="doSetVar"><l>h</l><custom-block s="%txt by mouse"><l>circle-data</l></custom-block></block><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>data</l><l>xpos</l><l>ypos</l><l>r</l><l>width</l><l>height</l></list><l>&#xD;function imageValue(x,y){&#xD;  if((x&gt;width)||(x&lt;1)||(y&gt;height)||(y&lt;1)) return 0;&#xD;  else return data.at(x+(y-1)*width);&#xD;  }&#xD; &#xD;var sumOfValues=0,points=0,y=ypos-r,x;&#xD;while((y&lt;=ypos+r) &amp;&amp; (y&lt;=height)){&#xD;  x=xpos-r;&#xD;  while((x&lt;=xpos+r) &amp;&amp; (x&lt;=width)){&#xD;    if(r&gt;Math.sqrt((xpos-x)*(xpos-x)+(ypos-y)*ypos-y)){&#xD;      sumOfValues=sumOfValues+imageValue(Math.round(x),Math.round(y));&#xD;      points++;&#xD;      }&#xD;    x++;&#xD;  }&#xD;  y++;&#xD;}&#xD;return new List([sumOfValues,points]);    </l></block><list><block var="myData"/><block s="reportListItem"><l>1</l><block s="reportListItem"><l>1</l><block var="h"/></block></block><block s="reportListItem"><l>2</l><block s="reportListItem"><l>1</l><block var="h"/></block></block><block s="reportListItem"><l>2</l><block var="h"/></block><custom-block s="property %s"><l>width</l></custom-block><custom-block s="property %s"><l>height</l></custom-block></list></block></block></script></block></script></block></script></block-definition><block-definition s="%&apos;pos&apos; to %&apos;coordinate&apos;" type="reporter" category="sensing"><comment x="0" y="0" w="122.66666666666669" collapsed="false">conversion of coordinates</comment><header></header><code></code><translations></translations><inputs><input type="%n"></input><input type="%txt">xp<options>xp&#xD;yp&#xD;x&#xD;y</options></input></inputs><script><block s="doDeclareVariables"><list><l>x0</l><l>diagramWidth</l><l>y0</l><l>diagramHeight</l></list></block><block s="doWarp"><script><block s="doSetVar"><l>coordinate</l><block s="reportListItem"><l>1</l><block s="reportTextSplit"><block var="coordinate"/><l> </l></block></block></block><block s="doIf"><block s="reportEquals"><block var="coordinate"/><l>xp</l></block><script><block s="doSetVar"><l>diagramWidth</l><block s="reportDifference"><custom-block s="property %s"><l>width</l></custom-block><custom-block s="property %s"><l>leftOffset</l></custom-block></block></block><block s="doSetVar"><l>x0</l><block s="reportQuotient"><block s="reportProduct"><custom-block s="property %s"><l>xLeft</l></custom-block><block var="diagramWidth"/></block><block s="reportDifference"><custom-block s="property %s"><l>xLeft</l></custom-block><custom-block s="property %s"><l>xRight</l></custom-block></block></block></block><block s="doReport"><block s="reportSum"><block s="reportSum"><block var="x0"/><block s="reportQuotient"><block s="reportProduct"><block var="pos"/><block var="diagramWidth"/></block><block s="reportDifference"><custom-block s="property %s"><l>xRight</l></custom-block><custom-block s="property %s"><l>xLeft</l></custom-block></block></block></block><custom-block s="property %s"><l>leftOffset</l></custom-block></block></block></script></block><block s="doIf"><block s="reportEquals"><block var="coordinate"/><l>yp</l></block><script><block s="doSetVar"><l>diagramHeight</l><block s="reportDifference"><block s="reportDifference"><custom-block s="property %s"><l>height</l></custom-block><custom-block s="property %s"><l>upperOffset</l></custom-block></block><custom-block s="property %s"><l>lowerOffset</l></custom-block></block></block><block s="doSetVar"><l>y0</l><block s="reportQuotient"><block s="reportProduct"><custom-block s="property %s"><l>yUpper</l></custom-block><block var="diagramHeight"/></block><block s="reportDifference"><custom-block s="property %s"><l>yUpper</l></custom-block><custom-block s="property %s"><l>yLower</l></custom-block></block></block></block><block s="doReport"><block s="reportSum"><block s="reportDifference"><block var="y0"/><block s="reportQuotient"><block s="reportProduct"><block var="pos"/><block var="diagramHeight"/></block><block s="reportDifference"><custom-block s="property %s"><l>yUpper</l></custom-block><custom-block s="property %s"><l>yLower</l></custom-block></block></block></block><custom-block s="property %s"><l>upperOffset</l></custom-block></block></block></script></block><block s="doIf"><block s="reportEquals"><block var="coordinate"/><l>x</l></block><script><block s="doSetVar"><l>diagramWidth</l><block s="reportDifference"><custom-block s="property %s"><l>width</l></custom-block><custom-block s="property %s"><l>leftOffset</l></custom-block></block></block><block s="doSetVar"><l>x0</l><block s="reportQuotient"><block s="reportProduct"><custom-block s="property %s"><l>xLeft</l></custom-block><block var="diagramWidth"/></block><block s="reportDifference"><custom-block s="property %s"><l>xLeft</l></custom-block><custom-block s="property %s"><l>xRight</l></custom-block></block></block></block><block s="doReport"><block s="reportQuotient"><block s="reportProduct"><block s="reportDifference"><block s="reportDifference"><block var="pos"/><custom-block s="property %s"><l>leftOffset</l></custom-block></block><block var="x0"/></block><block s="reportDifference"><custom-block s="property %s"><l>xRight</l></custom-block><custom-block s="property %s"><l>xLeft</l></custom-block></block></block><block var="diagramWidth"/></block></block></script></block><block s="doIf"><block s="reportEquals"><block var="coordinate"/><l>y</l></block><script><block s="doSetVar"><l>diagramHeight</l><block s="reportDifference"><block s="reportDifference"><custom-block s="property %s"><l>height</l></custom-block><custom-block s="property %s"><l>upperOffset</l></custom-block></block><custom-block s="property %s"><l>lowerOffset</l></custom-block></block></block><block s="doSetVar"><l>y0</l><block s="reportQuotient"><block s="reportProduct"><custom-block s="property %s"><l>yUpper</l></custom-block><block var="diagramHeight"/></block><block s="reportDifference"><custom-block s="property %s"><l>yUpper</l></custom-block><custom-block s="property %s"><l>yLower</l></custom-block></block></block></block><block s="doReport"><block s="reportQuotient"><block s="reportProduct"><block s="reportDifference"><block var="y0"/><block s="reportDifference"><block var="pos"/><custom-block s="property %s"><l>upperOffset</l></custom-block></block></block><block s="reportDifference"><custom-block s="property %s"><l>yUpper</l></custom-block><custom-block s="property %s"><l>yLower</l></custom-block></block></block><block var="diagramHeight"/></block></block></script></block></script></block></script></block-definition><block-definition s="new table" type="reporter" category="lists"><comment x="0" y="0" w="90" collapsed="false">creates a new empty table</comment><header></header><code></code><translations></translations><inputs></inputs><script><block s="doReport"><block s="reportNewList"><list></list></block></block></script></block-definition><block-definition s="%&apos;selection&apos; of %&apos;column&apos;" type="reporter" category="lists"><comment x="0" y="0" w="90" collapsed="false">determines a property of a list</comment><header></header><code></code><translations></translations><inputs><input type="%txt" readonly="true">min<options>min&#xD;max&#xD;number&#xD;sum&#xD;mean&#xD;median&#xD;variance&#xD;standard-deviation</options></input><input type="%l"></input></inputs><script><block s="doDeclareVariables"><list><l>result</l><l>help</l></list></block><block s="doWarp"><script><block s="doIfElse"><custom-block s="is %s a %s ?"><block var="column"/><l>vector</l></custom-block><script><block s="doIfElse"><block s="reportEquals"><block var="selection"/><l>median</l></block><script><block s="doSetVar"><l>help</l><custom-block s="sort %s by column %n ascending %b"><block var="column"/><l>1</l><l><bool>true</bool></l></custom-block></block><block s="doIfElse"><block s="reportEquals"><block s="reportModulus"><block s="reportListLength"><block var="help"/></block><l>2</l></block><l>1</l></block><script><block s="doReport"><block s="reportListItem"><block s="reportRound"><block s="reportQuotient"><block s="reportListLength"><block var="help"/></block><l>2</l></block></block><block var="help"/></block></block></script><script><block s="doReport"><block s="reportQuotient"><block s="reportSum"><block s="reportListItem"><block s="reportDifference"><block s="reportRound"><block s="reportQuotient"><block s="reportListLength"><block var="help"/></block><l>2</l></block></block><l>1</l></block><block var="help"/></block><block s="reportListItem"><block s="reportRound"><block s="reportQuotient"><block s="reportListLength"><block var="help"/></block><l>2</l></block></block><block var="help"/></block></block><l>2</l></block></block></script></block></script><script><block s="doSetVar"><l>result</l><block s="evaluate"><block s="reportJSFunction"><list><l>aList</l></list><l>var min=10000000,max=-min,sum=0,mean,n=0,isNumber,c;&#xD;var i=1,k,value;&#xD;while(i &lt;= aList.length()) {&#xD;  value = aList.at(i);&#xD;  if(typeof(value)=="number") isNumber=true;&#xD;  else{&#xD;    if(typeof(value)=="string"){&#xD;      isNumber=true;&#xD;      k=0;&#xD;      while((k&lt;value.length) &amp;&amp; isNumber){&#xD;        c=value.charAt(k);&#xD;        if((c&lt;&apos;0&apos;) || (c&gt;&apos;9&apos;))&#xD;          if((c!=&apos;E&apos;) &amp;&amp; (c!=&apos;e&apos;) &amp;&amp; (c!=&apos;+&apos;) &amp;&amp; (c!=&apos;-&apos;)&amp;&amp; (c!=&apos;.&apos;) &amp;&amp; (c!=&apos;,&apos;))&#xD;            isNumber=false;&#xD;        k++;&#xD;        }&#xD;       }&#xD;     else isNumber=false;&#xD;     }&#xD;  if(isNumber){&#xD;    value=Number(value);&#xD;    if(min&gt;value) min=value;&#xD;    if(max&lt;value) max=value;&#xD;    sum=Number(sum)+Number(value);&#xD;    n++;&#xD;    }&#xD;  i++;&#xD;  }&#xD;if(n&gt;0) mean=sum/n; else mean=NaN;&#xD;return new List([min,max,n,sum,mean]);     </l></block><list><block var="column"/></list></block></block><block s="doSetVar"><l>selection</l><block s="reportListItem"><l>1</l><block s="reportTextSplit"><block var="selection"/><l> </l></block></block></block><block s="doIf"><block s="reportEquals"><block var="selection"/><l>min</l></block><script><block s="doReport"><block s="reportListItem"><l>1</l><block var="result"/></block></block></script></block><block s="doIf"><block s="reportEquals"><block var="selection"/><l>max</l></block><script><block s="doReport"><block s="reportListItem"><l>2</l><block var="result"/></block></block></script></block><block s="doIf"><block s="reportEquals"><block var="selection"/><l>number</l></block><script><block s="doReport"><block s="reportListItem"><l>3</l><block var="result"/></block></block></script></block><block s="doIf"><block s="reportEquals"><block var="selection"/><l>sum</l></block><script><block s="doReport"><block s="reportListItem"><l>4</l><block var="result"/></block></block></script></block><block s="doIf"><block s="reportEquals"><block var="selection"/><l>mean</l></block><script><block s="doReport"><block s="reportListItem"><l>5</l><block var="result"/></block></block></script></block><block s="doIf"><block s="reportOr"><block s="reportEquals"><block var="selection"/><l>variance</l></block><block s="reportEquals"><block var="selection"/><l>standard-deviation</l></block></block><script><block s="doSetVar"><l>result</l><block s="evaluate"><block s="reportJSFunction"><list><l>aList</l><l>mean</l></list><l>var n=0,isNumber,c,variance=0;&#xD;var i=1,k,value;&#xD;while(i&lt;= aList.contents.length) {&#xD;  value = aList.at(i);&#xD;  if(typeof(value)=="number") isNumber=true;&#xD;  else{&#xD;    if(typeof(value)=="string"){&#xD;      isNumber=true;&#xD;      k=0;&#xD;      while((k&lt;value.length) &amp;&amp; isNumber){&#xD;        c=value.charAt(k);&#xD;        if((c&lt;&apos;0&apos;) || (c&gt;&apos;9&apos;))&#xD;          if((c!=&apos;E&apos;) &amp;&amp; (c!=&apos;e&apos;) &amp;&amp; (c!=&apos;+&apos;) &amp;&amp; (c!=&apos;-&apos;)&amp;&amp; (c!=&apos;.&apos;) &amp;&amp; (c!=&apos;,&apos;))&#xD;            isNumber=false;&#xD;        k++;&#xD;        }&#xD;       }&#xD;     else isNumber=false;&#xD;     }&#xD;  if(isNumber){&#xD;    value=Number(value);&#xD;    variance = Number(variance) +(Number(value)-Number(mean))*(Number(value)-Number(mean));&#xD;    n++;&#xD;    }&#xD;  i++;&#xD;  }&#xD;if(n&gt;0) variance=variance/n; else variance=NaN;&#xD;return variance;     </l></block><list><block var="column"/><block s="reportListItem"><l>5</l><block var="result"/></block></list></block></block><block s="doIf"><block s="reportEquals"><block var="selection"/><l>variance</l></block><script><block s="doReport"><block var="result"/></block></script></block><block s="doIf"><block s="reportEquals"><block var="selection"/><l>standard-deviation</l></block><script><block s="doReport"><block s="reportMonadic"><l><option>sqrt</option></l><block var="result"/></block></block></script></block></script></block><block s="doReport"><l>ERROR: unknown option</l></block></script></block></script><script><block s="doReport"><l>ERROR: wrong data format</l></block></script></block></script></block></script></block-definition><block-definition s="sort %&apos;table&apos; by column %&apos;n&apos; ascending %&apos;ascending&apos;" type="reporter" category="lists"><comment x="0" y="0" w="115.29680365296798" collapsed="false">sorts a list, JS-code copied from Snap!-library</comment><header></header><code></code><translations></translations><inputs><input type="%s">myData</input><input type="%n">1</input><input type="%b">true</input></inputs><script><block s="doDeclareVariables"><list><l>source</l></list></block><block s="doIfElse"><block s="reportEquals"><block var="table"/><l>myData</l></block><script><block s="doSetVar"><l>source</l><block var="myData"/></block></script><script><block s="doSetVar"><l>source</l><block var="table"/></block></script></block><block s="doIfElse"><block s="reportOr"><custom-block s="is %s a %s ?"><block var="source"/><l>table</l></custom-block><block s="reportIsA"><block var="source"/><l><option>list</option></l></block></block><script><block s="doIfElse"><block s="reportIsA"><block s="reportListItem"><l>1</l><block var="source"/></block><l><option>list</option></l></block><script><block s="doIfElse"><block var="ascending"/><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>data</l><l>fn</l><l>proc</l></list><l>return proc.reportAtomicSort(data, fn);</l></block><list><block var="source"/><block s="reifyPredicate"><autolambda><block s="reportLessThan"><block s="reportListItem"><block var="n"/><l/></block><block s="reportListItem"><block var="n"/><l/></block></block></autolambda><list></list></block></list></block></block></script><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>data</l><l>fn</l><l>proc</l></list><l>return proc.reportAtomicSort(data, fn);</l></block><list><block var="source"/><block s="reifyPredicate"><autolambda><block s="reportGreaterThan"><block s="reportListItem"><block var="n"/><l/></block><block s="reportListItem"><block var="n"/><l/></block></block></autolambda><list></list></block></list></block></block></script></block></script><script><block s="doIfElse"><block var="ascending"/><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>data</l><l>fn</l><l>proc</l></list><l>return proc.reportAtomicSort(data, fn);</l></block><list><block var="source"/><block s="reifyPredicate"><autolambda><block s="reportLessThan"><l></l><l></l></block></autolambda><list></list></block></list></block></block></script><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>data</l><l>fn</l><l>proc</l></list><l>return proc.reportAtomicSort(data, fn);</l></block><list><block var="source"/><block s="reifyPredicate"><autolambda><block s="reportGreaterThan"><l></l><l></l></block></autolambda><list></list></block></list></block></block></script></block></script></block></script><script><block s="doReport"><l>ERROR: wrong data format</l></block></script></block></script></block-definition><block-definition s="select rows of %&apos;table&apos; where column %&apos;n&apos; is %&apos;op&apos; %&apos;value&apos;" type="reporter" category="lists"><comment x="0" y="0" w="90" collapsed="false">determines the rows of a table with certain properties</comment><header></header><code></code><translations></translations><inputs><input type="%s">myData</input><input type="%n">1</input><input type="%txt" readonly="true">smaller-than<options>smaller-than&#xD;greater-than&#xD;equal-to&#xD;different-from</options></input><input type="%s">123</input></inputs><script><block s="doDeclareVariables"><list><l>source</l></list></block><block s="doWarp"><script><block s="doIfElse"><block s="reportEquals"><block var="table"/><l>myData</l></block><script><block s="doSetVar"><l>source</l><block var="myData"/></block></script><script><block s="doSetVar"><l>source</l><block var="table"/></block></script></block><block s="doIfElse"><custom-block s="is %s a %s ?"><block var="source"/><l>table</l></custom-block><script><block s="doSetVar"><l>op</l><block s="reportListItem"><l>1</l><block s="reportTextSplit"><block var="op"/><l><option>whitespace</option></l></block></block></block><block s="doIf"><block s="reportEquals"><block var="op"/><l>smaller-than</l></block><script><block s="doReport"><block s="reportAtomicKeep"><block s="reifyPredicate"><autolambda><block s="reportLessThan"><block s="reportListItem"><block var="n"/><l/></block><block var="value"/></block></autolambda><list></list></block><block var="source"/></block></block></script></block><block s="doIf"><block s="reportEquals"><block var="op"/><l>greater-than</l></block><script><block s="doReport"><block s="reportAtomicKeep"><block s="reifyPredicate"><autolambda><block s="reportGreaterThan"><block s="reportListItem"><block var="n"/><l/></block><block var="value"/></block></autolambda><list></list></block><block var="source"/></block></block></script></block><block s="doIf"><block s="reportEquals"><block var="op"/><l>equal-to</l></block><script><block s="doReport"><block s="reportAtomicKeep"><block s="reifyPredicate"><autolambda><block s="reportEquals"><block s="reportListItem"><block var="n"/><l/></block><block var="value"/></block></autolambda><list></list></block><block var="source"/></block></block></script></block><block s="doIf"><block s="reportEquals"><block var="op"/><l>different-from</l></block><script><block s="doReport"><block s="reportAtomicKeep"><block s="reifyPredicate"><autolambda><block s="reportNot"><block s="reportEquals"><block s="reportListItem"><block var="n"/><l/></block><block var="value"/></block></block></autolambda><list></list></block><block var="source"/></block></block></script></block></script><script><block s="doReport"><l>ERROR: wrong data format</l></block></script></block></script></block></script></block-definition><block-definition s="%&apos;selection&apos; of column %&apos;k&apos; of %&apos;table&apos; grouped by column %&apos;n&apos;" type="reporter" category="lists"><comment x="0" y="0" w="90" collapsed="false">determines group properties</comment><header></header><code></code><translations></translations><inputs><input type="%txt" readonly="true">mean<options>min&#xD;max&#xD;number&#xD;sum&#xD;mean</options></input><input type="%n">2</input><input type="%s">myData</input><input type="%n">1</input></inputs><script><block s="doDeclareVariables"><list><l>copy</l><l>source</l></list></block><block s="doWarp"><script><block s="doIfElse"><block s="reportEquals"><block var="table"/><l>myData</l></block><script><block s="doSetVar"><l>source</l><block var="myData"/></block></script><script><block s="doSetVar"><l>source</l><block var="table"/></block></script></block><block s="doIfElse"><custom-block s="is %s a %s ?"><block var="source"/><l>table</l></custom-block><script><block s="doSetVar"><l>selection</l><block s="reportListItem"><l>1</l><block s="reportTextSplit"><block var="selection"/><l> </l></block></block></block><block s="doSetVar"><l>copy</l><custom-block s="sort %s by column %n ascending %b"><block var="source"/><block var="n"/><l><bool>true</bool></l></custom-block></block><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>aTable</l><l>compaircolumn</l><l>operation</l><l>groupcolumn</l></list><l>var min,max,sum,mean,n,result,i,value,oldvalue,newvalue,stored=false;&#xD;&#xD;function isNumber(val){&#xD;  var ok,k,c;&#xD;  if(typeof(val)=="number") ok=true;&#xD;  else{&#xD;    if(typeof(val)=="string"){&#xD;      ok=true; k=0;&#xD;      while((k&lt;val.length) &amp;&amp; ok){&#xD;        c=val.charAt(k);&#xD;        if((c&lt;&apos;0&apos;) || (c&gt;&apos;9&apos;))&#xD;          if((c!=&apos;E&apos;) &amp;&amp; (c!=&apos;e&apos;) &amp;&amp; (c!=&apos;+&apos;) &amp;&amp; (c!=&apos;-&apos;)&amp;&amp; (c!=&apos;.&apos;) &amp;&amp; (c!=&apos;,&apos;)) ok=false;&#xD;        k++;&#xD;        }&#xD;       }&#xD;     else ok=false;&#xD;     }&#xD;  return ok;&#xD;  }&#xD;&#xD;result=new List();&#xD;result.add(new List([&apos;value&apos;,operation]));&#xD;if(aTable.contents.length==0) return result;&#xD;&#xD;value = aTable.at(1).at(compaircolumn);&#xD;if(isNumber(value)){value=Number(value); min=value;&#xD;max=value; sum=value;}&#xD;n=1;&#xD;newvalue = aTable.at(1).at(groupcolumn);&#xD;if(isNumber(newvalue)) newvalue=Number(newvalue);&#xD;oldvalue=newvalue;&#xD;i=2;&#xD;while(i&lt;=aTable.length()) {&#xD;  stored=false;&#xD;  newvalue=aTable.at(i).at(groupcolumn);&#xD;  if(isNumber(newvalue)) newvalue=Number(newvalue);&#xD;  if(newvalue==oldvalue){&#xD;    value=aTable.at(i).at(compaircolumn);&#xD;    if(isNumber(value)){if(min&gt;value) min=value; if(max&lt;value) max=value; sum=Number(sum)+Number(value);}&#xD;    n++;&#xD;    }&#xD;   else{&#xD;     if(operation==&apos;min&apos;) result.add(new List([oldvalue,min]));&#xD;     if(operation==&apos;max&apos;) result.add(new List([oldvalue,max]));&#xD;     if(operation==&apos;number&apos;) result.add(new List([oldvalue,n]));&#xD;     if(operation==&apos;sum&apos;) result.add(new List([oldvalue,sum]));&#xD;     if(operation==&apos;mean&apos;) result.add(new List([oldvalue,1.0*sum/n]));&#xD;     if(isNumber(value)){value=Number(value); min=value; max=value; sum=value;}&#xD;     n=1;&#xD;     oldvalue=newvalue;&#xD;     stored=true;&#xD;     }&#xD;  i++;&#xD;  }&#xD;if(!stored){&#xD;     if(operation==&apos;min&apos;) result.add(new List([oldvalue,min]));&#xD;     if(operation==&apos;max&apos;) result.add(new List([oldvalue,max]));&#xD;     if(operation==&apos;number&apos;) result.add(new List([oldvalue,n]));&#xD;     if(operation==&apos;sum&apos;) result.add(new List([oldvalue,sum]));&#xD;     if(operation==&apos;mean&apos;) result.add(new List([oldvalue,1.0*sum/n]));&#xD;  }&#xD;return result; </l></block><list><block var="copy"/><block var="k"/><block var="selection"/><block var="n"/></list></block></block></script><script><block s="doReport"><l>ERROR: wrong data format</l></block></script></block></script></block></script></block-definition><block-definition s="apply convolution kernel %&apos;kernel&apos; to %&apos;data&apos;" type="reporter" category="lists"><comment x="0" y="0" w="98.33333333333333" collapsed="false">applies a convolution to a table with FITS or RBG values</comment><header></header><code></code><translations></translations><inputs><input type="%l"></input><input type="%s">myData</input></inputs><script><block s="doDeclareVariables"><list><l>w</l><l>h</l><l>t</l><l>m</l><l>source</l></list></block><block s="doWarp"><script><block s="doIfElse"><block s="reportEquals"><block var="data"/><l>myData</l></block><script><block s="doSetVar"><l>source</l><block var="myData"/></block></script><script><block s="doSetVar"><l>source</l><block var="data"/></block></script></block><block s="doIfElse"><block s="reportAnd"><block s="reportIsA"><block var="source"/><l><option>list</option></l></block><custom-block s="is %s a %s ?"><block var="kernel"/><l>matrix</l></custom-block></block><script><block s="doSetVar"><l>h</l><block s="reportListLength"><block var="kernel"/></block></block><block s="doSetVar"><l>w</l><block s="reportListLength"><block s="reportListItem"><l>1</l><block var="kernel"/></block></block></block><block s="doIfElse"><block s="reportOr"><block s="reportNot"><block s="reportEquals"><block var="w"/><block var="h"/></block></block><block s="reportOr"><block s="reportEquals"><block s="reportProduct"><l>2</l><block s="reportRound"><block s="reportQuotient"><block var="w"/><l>2</l></block></block></block><block var="w"/></block><block s="reportEquals"><block s="reportProduct"><l>2</l><block s="reportRound"><block s="reportQuotient"><block var="h"/><l>2</l></block></block></block><block var="h"/></block></block></block><script><block s="doReport"><l>ERROR: wrong kernel</l></block></script><script><block s="doSetVar"><l>m</l><block s="reportRound"><block s="reportQuotient"><block var="w"/><l>2</l></block></block></block><block s="doIfElse"><block s="reportIsA"><block s="reportListItem"><l>1</l><block var="source"/></block><l><option>number</option></l></block><script><block s="doSetVar"><l>t</l><l>FITS</l></block></script><script><block s="doIfElse"><block s="reportIsA"><block s="reportListItem"><l>1</l><block var="source"/></block><l><option>list</option></l></block><script><block s="doSetVar"><l>t</l><l>RGB</l></block></script><script><block s="doReport"><l>ERROR wrong data format</l></block></script></block></script></block><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>kernel</l><l>data</l><l>width</l><l>height</l><l>typeOfData</l><l>mIndex</l><l>kWidth</l></list><l>function getValue(x,y){&#xD;  return (data.at(x+(y-1)*width));&#xD;  }&#xD;&#xD;function getKernelValue(x,y){&#xD;  return (kernel.at(y).at(x));&#xD;}&#xD;&#xD;var result=[],x,y,value,r,g,b,s;&#xD;&#xD;for(var y=1; y&lt;=height;y++)&#xD;  for(var x=1;x&lt;=width;x++){&#xD;    if(typeOfData==&apos;FITS&apos;) value = 0; &#xD;      else if(typeOfData==&apos;RGB&apos;){r=0;g=0;b=0;s=0};&#xD;    for(var ky=1;ky&lt;=kWidth;ky++)&#xD;      for(var kx=1;kx&lt;=kWidth;kx++)&#xD;         if((y-mIndex+ky&gt;0) &amp;&amp; (y-mIndex+ky&lt;=height) &amp;&amp; (x-mIndex+kx&gt;0) &amp;&amp; (x-mIndex+kx&lt;=width)){&#xD;           if(typeOfData==&apos;FITS&apos;) value = value+getValue(x-mIndex+kx,y-mIndex+ky)*getKernelValue(kx,ky);&#xD;             else if(typeOfData==&apos;RGB&apos;){&#xD;                    r = r + getValue(x-mIndex+kx,y-mIndex+ky).at(1)*getKernelValue(kx,ky);&#xD;                    g = g + getValue(x-mIndex+kx,y-mIndex+ky).at(2)*getKernelValue(kx,ky);&#xD;                    b = b + getValue(x-mIndex+kx,y-mIndex+ky).at(3)*getKernelValue(kx,ky);&#xD;                    s = s + getValue(x-mIndex+kx,y-mIndex+ky).at(4)*getKernelValue(kx,ky);&#xD;                    }&#xD;           }&#xD;    if(typeOfData==&apos;FITS&apos;) result.push(value); &#xD;      else if(typeOfData==&apos;RGB&apos;) result.push(new List([r,g,b,s]));&#xD;    }&#xD;return new List(result);</l></block><list><block var="kernel"/><block var="source"/><custom-block s="property %s"><l>width</l></custom-block><custom-block s="property %s"><l>height</l></custom-block><block var="t"/><block var="m"/><block var="w"/></list></block></block></script></block></script><script><block s="doReport"><l>ERROR: wrong data format</l></block></script></block></script></block></script></block-definition><block-definition s="compress data %&apos;data&apos; with factor %&apos;n&apos; by averaging" type="reporter" category="lists"><comment x="0" y="0" w="90" collapsed="false">reduces the data volume of a table by averaging</comment><header></header><code></code><translations></translations><inputs><input type="%s">myData</input><input type="%n">2</input></inputs><script><block s="doDeclareVariables"><list><l>result</l><l>h</l><l>h2</l><l>i</l><l>j</l><l>source</l></list></block><block s="doIfElse"><block s="reportEquals"><block var="data"/><l>myData</l></block><script><block s="doSetVar"><l>source</l><block var="myData"/></block></script><script><block s="doSetVar"><l>source</l><block var="data"/></block></script></block><block s="doIfElse"><block s="reportIsA"><block var="source"/><l><option>list</option></l></block><script><block s="doIfElse"><block s="reportAnd"><block s="reportGreaterThan"><block s="reportListLength"><block var="source"/></block><l>0</l></block><block s="reportGreaterThan"><block var="n"/><l>0</l></block></block><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>data</l><l>n</l></list><l>function mean(d,n){&#xD;  var sum=0;&#xD;  for(var i=1;i&lt;=d.length();i++){&#xD;    sum=sum+Number(d.at(i).at(n));&#xD;    }&#xD;  return sum/d.length();&#xD;  }&#xD;&#xD;function mean2(d){&#xD;  var sum=0;&#xD;  for(var i=1;i&lt;=d.length();i++){&#xD;    sum=sum+Number(d.at(i));&#xD;    }&#xD;  return sum/d.length();&#xD;  }&#xD;&#xD;var result=new List(),i,j,h1,h2;&#xD;n=Math.round(n);&#xD;if(data.at(1) instanceof List){&#xD;  i=1;&#xD;  while(i&lt;=data.length()-n+1){&#xD;    h1 = new List();&#xD;    h1.add(data.at(i));&#xD;    j=1;&#xD;    while(j&lt;=n-1){&#xD;      h1.add(data.at(i+j));&#xD;      j++;&#xD;      }&#xD;    j=1;&#xD;    h2=new List();&#xD;    while(j&lt;=h1.at(1).length()){&#xD;      h2.add(mean(h1,j));&#xD;      j++;&#xD;      }&#xD;    result.add(h2);&#xD;    i=i+n;&#xD;    }&#xD;  }&#xD;else{&#xD;  i=1;&#xD;  while(i&lt;=data.length()-n+1){&#xD;    h1 = new List();&#xD;    h1.add(data.at(i));&#xD;    j=1;&#xD;    while(j&lt;=n-1){&#xD;      h1.add(data.at(i+j));&#xD;      j++;&#xD;      }&#xD;    result.add(mean2(h1));&#xD;    i=i+n;&#xD;    }&#xD;}&#xD;return result;</l></block><list><block var="source"/><block var="n"/></list></block></block></script><script><block s="doReport"><l>ERROR: impossible operation</l></block></script></block></script><script><block s="doReport"><l>ERROR: wrong data format</l></block></script></block></script></block-definition><block-definition s="write string %&apos;theString&apos; to file %&apos;filename&apos;" type="command" category="operators"><comment x="0" y="0" w="101.5753424657534" collapsed="false">stores a string in a file, copied from Snap!-code</comment><header></header><code></code><translations></translations><inputs><input type="%s"></input><input type="%txt"></input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>data</l><l>filename</l></list><l>var ide = this.parent.parent;&#xD;if(isString(data)){&#xD;  ide.saveFileAs(data,&#xD;  &apos;text/plain;charset=utf-8&apos;,&#xD;  filename);&#xD;  };</l></block><list><block var="theString"/><block var="filename"/></list></block></script></block-definition><block-definition s="export %&apos;table&apos; to CSV file %&apos;filename&apos;" type="command" category="lists"><comment x="0" y="0" w="284.7945205479452" collapsed="false">stores a table in a CSV file, JS-code copied from Snap!-code</comment><header></header><code></code><translations></translations><inputs><input type="%s">myData</input><input type="%txt"></input></inputs><script><block s="doDeclareVariables"><list><l>source</l></list></block><block s="doIfElse"><block s="reportEquals"><block var="table"/><l>myData</l></block><script><block s="doSetVar"><l>source</l><block var="myData"/></block></script><script><block s="doSetVar"><l>source</l><block var="table"/></block></script></block><block s="doIfElse"><block s="reportIsA"><block var="source"/><l><option>list</option></l></block><script><block s="doRun"><block s="reportJSFunction"><list><l>data</l><l>filename</l></list><l>function toCSV(data){&#xD;  var items=data.itemsArray(),rows = [];&#xD;    &#xD;    function encodeCell(atomicValue) {&#xD;        var string = atomicValue.toString(),cell;&#xD;        if (string.indexOf(&apos;\"&apos;) ===  -1 &amp;&amp;&#xD;                (string.indexOf(&apos;\n&apos;) === -1) &amp;&amp;&#xD;                (string.indexOf(&apos;\,&apos;) === -1)) {&#xD;            return string;&#xD;        }&#xD;        cell = [&apos;\"&apos;];&#xD;        string.split(&apos;&apos;).forEach(function (letter) {cell.push(letter);&#xD;            if (letter === &apos;\"&apos;) {cell.push(letter);}&#xD;        });&#xD;        cell.push(&apos;\"&apos;);&#xD;        return cell.join(&apos;&apos;);&#xD;   }&#xD;&#xD;  if (items.some(function (any) {return any instanceof List; })) {&#xD;     items.forEach(function (item) {&#xD;       if (item instanceof List) {&#xD;         rows.push(item.itemsArray().map(encodeCell).join(&apos;,&apos;));&#xD;       } else {rows.push(encodeCell(item));}&#xD;      });&#xD;    return rows.join(&apos;\n&apos;);&#xD;  }&#xD;  return items.map(encodeCell).join(&apos;,&apos;);&#xD;}&#xD;&#xD;var ide = this.parent.parent;&#xD;ide.saveFileAs(toCSV(data),&apos;text/csv;charset=utf-8&apos;,filename);</l></block><list><block var="source"/><block var="filename"/></list></block></script><script><block s="doReport"><l>ERROR: wrong data format</l></block></script></block></script></block-definition><block-definition s="read file with filepicker" type="reporter" category="lists"><comment x="0" y="0" w="291.3698630136987" collapsed="false">loads the contents of a file, JS-code copied from Snap!-code</comment><header></header><code></code><translations></translations><inputs></inputs><script><block s="doDeclareVariables"><list><l>ready</l></list></block><block s="doSetVar"><l>ready</l><block s="evaluate"><block s="reportJSFunction"><list></list><l>var inp = document.createElement(&apos;input&apos;), ide = this.parent.parent, result=0, done=false;&#xD;&#xD;  function userImport() {&#xD;&#xD;        function txtOnlyMsg(ftype, anyway) {&#xD;            ide.confirm(&#xD;                localize(&#xD;                    &apos;Snap! can only import "text" files.\n&apos; +&#xD;                        &apos;You selected a file of type "&apos; +&#xD;                        ftype +&#xD;                        &apos;".&apos;&#xD;                ) + &apos;\n\n&apos; + localize(&apos;Open anyway?&apos;),&#xD;                &apos;Unable to import&apos;,&#xD;                anyway // callback&#xD;            );&#xD;        }&#xD;&#xD;        function readText(aFile) {&#xD;            var frd = new FileReader(),&#xD;                ext = aFile.name.split(&apos;.&apos;).pop().toLowerCase();&#xD;&#xD;            function isTextFile(aFile) {&#xD;                // special cases for Windows&#xD;                // check the file extension for text-like-ness&#xD;                return aFile.type.indexOf(&apos;text&apos;) !== -1 ||&#xD;                    contains([&apos;txt&apos;, &apos;csv&apos;, &apos;xml&apos;, &apos;json&apos;, &apos;tsv&apos;], ext);&#xD;            }&#xD;&#xD;            function isType(aFile, string) {&#xD;                return aFile.type.indexOf(string) !== -1 || (ext === string);&#xD;            }&#xD;&#xD;            frd.onloadend = function (e) {&#xD;                done=true;&#xD;                if (isType(aFile, &apos;csv&apos;)) {result=Process.prototype.parseCSV(e.target.result);}&#xD;                else if (isType(aFile, &apos;json&apos;)) { result=Process.prototype.parseJSON(e.target.result);}&#xD;                     else { result=e.target.result;}&#xD;            };&#xD;&#xD;            if (isTextFile(aFile)) {&#xD;                frd.readAsText(aFile);&#xD;            } else {&#xD;               txtOnlyMsg(&#xD;                    aFile.type,&#xD;                    function () {frd.readAsText(aFile); }&#xD;                );&#xD;            }&#xD;        }&#xD;&#xD;        document.body.removeChild(inp);&#xD;        ide.filePicker = null;&#xD;        if (inp.files.length &gt; 0) {&#xD;            readText(inp.files[inp.files.length - 1]);&#xD;        }&#xD;    }&#xD;&#xD;    if (ide.filePicker) {&#xD;        document.body.removeChild(ide.filePicker);&#xD;        ide.filePicker = null;&#xD;    }&#xD;    inp.type = &apos;file&apos;;&#xD;    inp.style.color = "transparent";&#xD;    inp.style.backgroundColor = "transparent";&#xD;    inp.style.border = "none";&#xD;    inp.style.outline = "none";&#xD;    inp.style.position = "absolute";&#xD;    inp.style.top = "0px";&#xD;    inp.style.left = "0px";&#xD;    inp.style.width = "0px";&#xD;    inp.style.height = "0px";&#xD;    inp.style.display = "none";&#xD;    inp.addEventListener(&#xD;        "change",&#xD;        userImport,&#xD;        false&#xD;    );&#xD;    document.body.appendChild(inp);&#xD;    ide.filePicker = inp;&#xD;    inp.click();&#xD;return function(){return new List([done,result]);};</l></block><list></list></block></block><block s="doWaitUntil"><block s="reportListItem"><l>1</l><block s="evaluate"><block var="ready"/><list></list></block></block></block><block s="doReport"><block s="reportListItem"><l>2</l><block s="evaluate"><block var="ready"/><list></list></block></block></block></script></block-definition><block-definition s="normalize %&apos;data&apos; by %&apos;choice&apos;" type="reporter" category="lists"><comment x="0" y="0" w="90" collapsed="false">normalizes a table by dividing it by the mean value</comment><header></header><code></code><translations></translations><inputs><input type="%s">myData</input><input type="%s">mean<options>mean&#xD;max&#xD;number&#xD;sum&#xD;median</options></input></inputs><script><block s="doDeclareVariables"><list><l>divisor</l><l>source</l></list></block><block s="doIfElse"><block s="reportEquals"><block var="data"/><l>myData</l></block><script><block s="doSetVar"><l>source</l><block var="myData"/></block></script><script><block s="doSetVar"><l>source</l><block var="data"/></block></script></block><block s="doSetVar"><l>choice</l><block s="reportListItem"><l>1</l><block s="reportTextSplit"><block var="choice"/><l> </l></block></block></block><block s="doIfElse"><custom-block s="is %s a %s ?"><block var="source"/><l>vector</l></custom-block><script><block s="doIfElse"><block s="reportEquals"><block var="choice"/><l>mean</l></block><script><block s="doSetVar"><l>divisor</l><custom-block s="%txt of %l"><l>mean</l><block var="source"/></custom-block></block></script><script><block s="doIfElse"><block s="reportEquals"><block var="choice"/><l>max</l></block><script><block s="doSetVar"><l>divisor</l><custom-block s="%txt of %l"><l>max</l><block var="source"/></custom-block></block></script><script><block s="doIfElse"><block s="reportEquals"><block var="choice"/><l>number</l></block><script><block s="doSetVar"><l>divisor</l><custom-block s="%txt of %l"><l>number</l><block var="source"/></custom-block></block></script><script><block s="doIfElse"><block s="reportEquals"><block var="choice"/><l>sum</l></block><script><block s="doSetVar"><l>divisor</l><custom-block s="%txt of %l"><l>sum</l><block var="source"/></custom-block></block></script><script><block s="doIfElse"><block s="reportEquals"><block var="choice"/><l>median</l></block><script><block s="doSetVar"><l>divisor</l><custom-block s="%txt of %l"><l>median</l><block var="source"/></custom-block></block></script><script><block s="doIfElse"><block s="reportIsA"><block var="choice"/><l><option>number</option></l></block><script><block s="doSetVar"><l>divisor</l><block var="choice"/></block></script><script><block s="doReport"><l>ERROR: illegal operation</l></block></script></block></script></block></script></block></script></block></script></block></script></block><block s="doIfElse"><block s="reportNot"><block s="reportEquals"><block var="divisor"/><l>0</l></block></block><script><block s="doReport"><block s="reportAtomicMap"><block s="reifyReporter"><autolambda><block s="reportQuotient"><l></l><block var="divisor"/></block></autolambda><list></list></block><block var="source"/></block></block></script><script><block s="doReport"><l>ERROR: divisor is 0</l></block></script></block></script><script><block s="doReport"><l>ERROR: wrong data format</l></block></script></block></script></block-definition><block-definition s="set properties" type="command" category="variables"><comment x="0" y="0" w="140.33333433333345" collapsed="false">sets the default values of the properties of a DataSprite</comment><header></header><code></code><translations></translations><inputs></inputs><script><block s="doWarp"><script><block s="doSetVar"><l>myProperties</l><custom-block s="new table"></custom-block></block><custom-block s="set property %s to %s"><l>type of data</l><l>empty</l></custom-block><custom-block s="set property %s to %s"><l>width</l><l>0</l></custom-block><custom-block s="set property %s to %s"><l>height</l><l>0</l></custom-block><custom-block s="set property %s to %s"><l>backColorRed</l><l>255</l></custom-block><custom-block s="set property %s to %s"><l>backColorGreen</l><l>225</l></custom-block><custom-block s="set property %s to %s"><l>backColorBlue</l><l>205</l></custom-block><custom-block s="set property %s to %s"><l>leftOffset</l><l>60</l></custom-block><custom-block s="set property %s to %s"><l>upperOffset</l><l>0</l></custom-block><custom-block s="set property %s to %s"><l>lowerOffset</l><l>20</l></custom-block><custom-block s="set property %s to %s"><l>title</l><l></l></custom-block><custom-block s="set property %s to %s"><l>titleHeight</l><l>20</l></custom-block><custom-block s="set property %s to %s"><l>xLabel</l><l></l></custom-block><custom-block s="set property %s to %s"><l>xLabelHeight</l><l>15</l></custom-block><custom-block s="set property %s to %s"><l>yLabel</l><l></l></custom-block><custom-block s="set property %s to %s"><l>yLabelHeight</l><l>15</l></custom-block><custom-block s="set property %s to %s"><l>xLeft</l><l>-10</l></custom-block><custom-block s="set property %s to %s"><l>xRight</l><l>10</l></custom-block><custom-block s="set property %s to %s"><l>yLower</l><l>-10</l></custom-block><custom-block s="set property %s to %s"><l>yUpper</l><l>10</l></custom-block><custom-block s="set property %s to %s"><l>lineStyle</l><l>continuous</l></custom-block><custom-block s="set property %s to %s"><l>lineWidth</l><l>1</l></custom-block><custom-block s="set property %s to %s"><l>lineColorRed</l><l>0</l></custom-block><custom-block s="set property %s to %s"><l>lineColorGreen</l><l>0</l></custom-block><custom-block s="set property %s to %s"><l>lineColorBlue</l><l>0</l></custom-block><custom-block s="set property %s to %s"><l>datapointStyle</l><l>square</l></custom-block><custom-block s="set property %s to %s"><l>datapointWidth</l><l>5</l></custom-block><custom-block s="set property %s to %s"><l>datapointConnected</l><block s="reportBoolean"><l><bool>false</bool></l></block></custom-block><custom-block s="set property %s to %s"><l>datapointColorRed</l><l>255</l></custom-block><custom-block s="set property %s to %s"><l>datapointColorGreen</l><l>0</l></custom-block><custom-block s="set property %s to %s"><l>datapointColorBlue</l><l>0</l></custom-block><custom-block s="set property %s to %s"><l>scalesPrecision</l><l>3</l></custom-block><custom-block s="set property %s to %s"><l>scalesTextheight</l><l>12</l></custom-block><custom-block s="set property %s to %s"><l>scalesNumberXintervals</l><l>10</l></custom-block><custom-block s="set property %s to %s"><l>minValue</l><l>0</l></custom-block><custom-block s="set property %s to %s"><l>maxValue</l><l>0</l></custom-block><custom-block s="set property %s to %s"><l>columns</l><l>0</l></custom-block><custom-block s="set property %s to %s"><l>rows</l><l>0</l></custom-block></script></block></script></block-definition><block-definition s="copy of costume %&apos;costume&apos;" type="reporter" category="looks"><header></header><code></code><translations></translations><inputs><input type="%obj"></input></inputs><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>costume</l></list><l>return costume.copy();</l></block><list><block var="costume"/></list></block></block></script></block-definition><block-definition s="draw rectangle from %&apos;x1&apos; %&apos;y1&apos; to %&apos;x2&apos; %&apos;y2&apos;" type="command" category="looks"><comment x="0" y="0" w="90" collapsed="false">draws a rectangle on present costume using line properties</comment><header></header><code></code><translations></translations><inputs><input type="%n">100</input><input type="%n">100</input><input type="%n">200</input><input type="%n">50</input></inputs><script><block s="doDeclareVariables"><list><l>x</l><l>y</l><l>w</l><l>h</l></list></block><block s="doWarp"><script><block s="doIfElse"><block s="reportGreaterThan"><block var="x1"/><block var="x2"/></block><script><block s="doSetVar"><l>x</l><block var="x2"/></block><block s="doSetVar"><l>w</l><block s="reportDifference"><block var="x1"/><block var="x2"/></block></block></script><script><block s="doSetVar"><l>x</l><block var="x1"/></block><block s="doSetVar"><l>w</l><block s="reportDifference"><block var="x2"/><block var="x1"/></block></block></script></block><block s="doIfElse"><block s="reportGreaterThan"><block var="y2"/><block var="y1"/></block><script><block s="doSetVar"><l>y</l><block var="y2"/></block><block s="doSetVar"><l>h</l><block s="reportDifference"><block var="y2"/><block var="y1"/></block></block></script><script><block s="doSetVar"><l>y</l><block var="y1"/></block><block s="doSetVar"><l>h</l><block s="reportDifference"><block var="y1"/><block var="y2"/></block></block></script></block><block s="doRun"><block s="reportJSFunction"><list><l>costume</l><l>x1</l><l>y1</l><l>w</l><l>h</l><l>width</l><l>r</l><l>g</l><l>b</l></list><l>var ctx = costume.contents.getContext(&apos;2d&apos;);&#xD;ctx.beginPath();&#xD;ctx.lineWidth = width;&#xD;ctx.strokeStyle = new Color(r,g,b).toString();&#xD;ctx.strokeRect(x1,y1,w,h);&#xD;ctx.closePath();&#xD;ctx.stroke();</l></block><list><block var="myCostume"/><block var="x"/><block var="y"/><block var="w"/><block var="h"/><custom-block s="property %s"><l>lineWidth</l></custom-block><custom-block s="property %s"><l>lineColorRed</l></custom-block><custom-block s="property %s"><l>lineColorGreen</l></custom-block><custom-block s="property %s"><l>lineColorBlue</l></custom-block></list></block><block s="doSwitchToCostume"><block var="myCostume"/></block></script></block></script></block-definition><block-definition s="pixels from RGB data %&apos;data&apos; min %&apos;min&apos; max %&apos;max&apos; gray? %&apos;gray&apos; log? %&apos;log&apos;" type="reporter" category="looks"><comment x="0" y="0" w="131.66666666666669" collapsed="false">calculates the pixels of a costume from the RGB data</comment><header></header><code></code><translations></translations><inputs><input type="%s">myData</input><input type="%n">0</input><input type="%n">32757</input><input type="%b"></input><input type="%b"></input></inputs><script><block s="doDeclareVariables"><list><l>source</l></list></block><block s="doIfElse"><block s="reportEquals"><block var="data"/><l>myData</l></block><script><block s="doSetVar"><l>source</l><block var="myData"/></block></script><script><block s="doSetVar"><l>source</l><block var="data"/></block></script></block><block s="doIfElse"><block s="reportIsA"><block var="source"/><l><option>list</option></l></block><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>data</l><l>min</l><l>max</l><l>gray</l><l>log</l></list><l>var result=[], i=1, n, value, interval = (max-min)/8;&#xD;while(i&lt;= data.length()) {&#xD;  value = (data.at(i).at(1)+data.at(i).at(2)+data.at(i).at(3))/3;&#xD;  n = value;&#xD;  if(value&lt;=min) n=min+1;&#xD;  if(value&gt;max) n =max;&#xD;  if(log) n = Math.round(Math.log(n-min)/Math.log(max-min)*255);&#xD;  else n = Math.round((n-min)/(max-min)*255);&#xD;  if(gray) result.push(new List([n,n,n,255]));&#xD;  else { // result.push(new List([n,255-n,Math.round(255-n/2),255]));&#xD;    if(value&lt;=min) {result.push(new List([0,0,0,255]));}&#xD;       else if(value&lt;min+interval) result.push(new List([0,0,n,255]));&#xD;            else if(value&lt;min+2*interval) result.push(new List([0,n,n,255]));&#xD;                 else if(value&lt;min+3*interval) result.push(new List([n,0,n,255]));&#xD;                      else if(value&lt;min+4*interval) result.push(new List([0,n,0,255]));&#xD;                           else if(value&lt;min+5*interval) result.push(new List([n,0,0,n]));&#xD;                                else if(value&lt;min+6*interval) result.push(new List([n,n/2,0,255]));&#xD;                                     else if(value&lt;min+7*interval) result.push(new List([n,n,0,255]));&#xD;                                          else if(value&lt;min+8*interval) result.push(new List([n,n,n,255]));&#xD;                                               else result.push(new List([255,255,255,255]));&#xD;     }&#xD;  i = i+1;&#xD;  }&#xD;return new List(result);</l></block><list><block var="source"/><block var="min"/><block var="max"/><block var="gray"/><block var="log"/></list></block></block></script><script><block s="doReport"><l>ERROR: wrong data format</l></block></script></block></script></block-definition><block-definition s="setting %&apos;which&apos;" type="reporter" category="sensing"><header></header><code></code><translations>pt:o valor da configurao _&#xD;</translations><inputs><input type="%s" readonly="true"><options>Project notes&#xD;Project name&#xD;User&#xD;Presentation mode&#xD;Language&#xD;Zoom blocks&#xD;Stage size&#xD;Stage scale&#xD;Retina display support&#xD;Long form input dialog&#xD;Plain prototype labels&#xD;Input sliders&#xD;Execute on slider change&#xD;Clicking sound&#xD;Turbo mode&#xD;Flat design&#xD;Keyboard editing&#xD;Visible stepping&#xD;Thread safe scripts&#xD;Prefer smooth animations&#xD;Flat line ends&#xD;Codification support&#xD;Inheritance support&#xD;Visible palette</options></input></inputs><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>which</l></list><l>var stage = this.parentThatIsA(StageMorph),&#xD;    ide = stage.parentThatIsA(IDE_Morph),&#xD;    world = stage.parentThatIsA(WorldMorph);&#xD;&#xD;switch (which) {&#xD;    case &apos;Project notes&apos;:&#xD;        return ide.projectNotes;&#xD;    case &apos;Project name&apos;:&#xD;        return ide.projectName;&#xD;    case &apos;User&apos;:&#xD;        return ide.cloud.username;&#xD;    case &apos;Presentation mode&apos;:&#xD;        return ide.isAppMode;&#xD;    case &apos;Language&apos;:&#xD;        return SnapTranslator.language;&#xD;    case &apos;Zoom blocks&apos;:&#xD;        return SyntaxElementMorph.prototype.scale;&#xD;    case &apos;Stage size&apos;:&#xD;        return new List([StageMorph.prototype.dimensions.x,&#xD;                                   StageMorph.prototype.dimensions.y]);&#xD;    case &apos;Stage scale&apos;:&#xD;       return stage.scale;&#xD;    case &apos;Retina display support&apos;:&#xD;        return isRetinaEnabled();&#xD;    case &apos;Long form input dialog&apos;:&#xD;        return InputSlotDialogMorph.prototype.isLaunchingExpanded;&#xD;    case &apos;Plain prototype labels&apos;:&#xD;        return BlockLabelPlaceHolderMorph.prototype.plainLabel;&#xD;    case &apos;Input sliders&apos;:&#xD;        return MorphicPreferences.useSliderForInput;&#xD;    case &apos;Execute on slider change&apos;:&#xD;        return ArgMorph.prototype.executeOnSliderEdit;&#xD;    case &apos;Clicking sound&apos;:&#xD;        return !!BlockMorph.prototype.snapSound;&#xD;    case &apos;Turbo mode&apos;:&#xD;        return stage.isFastTracked;&#xD;    case &apos;Flat design&apos;:&#xD;        return MorphicPreferences.isFlat;&#xD;    case &apos;Keyboard editing&apos;:&#xD;        return world.keyboardReceiver instanceof ScriptFocusMorph;&#xD;    case &apos;Visible stepping&apos;:&#xD;        return Process.prototype.enableSingleStepping;&#xD;    case &apos;Thread safe scripts&apos;:&#xD;        return stage.isThreadSafe;&#xD;    case &apos;Prefer smooth animations&apos;:&#xD;        return StageMorph.prototype.frameRate &gt; 0;&#xD;    case &apos;Flat line ends&apos;:&#xD;        return SpriteMorph.prototype.useFlatLineEnds;&#xD;    case &apos;Codification support&apos;:&#xD;        return StageMorph.prototype.enableCodeMapping;&#xD;    case &apos;Inheritance support&apos;:&#xD;        return StageMorph.prototype.enableInheritance;&#xD;    default: return which;&#xD;    case &apos;Visible palette&apos;:&#xD;        return ide.currentCategory;&#xD;}</l></block><list><block var="which"/></list></block></block></script></block-definition><block-definition s="set flag %&apos;which&apos; to %&apos;tf&apos;" type="command" category="sensing"><header></header><code></code><translations>pt:altera o valor da configurao _ para _&#xD;</translations><inputs><input type="%s" readonly="true"><options>Presentation mode&#xD;Retina display support&#xD;Long form input dialog&#xD;Plain prototype labels&#xD;Input sliders&#xD;Execute on slider change&#xD;Clicking sound&#xD;Turbo mode&#xD;Flat design&#xD;Keyboard editing&#xD;Visible stepping&#xD;Thread safe scripts&#xD;Prefer smooth animations&#xD;Flat line ends&#xD;Codification support&#xD;Inheritance support</options></input><input type="%b"></input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>which</l><l>tf</l></list><l>var   stage = this.parentThatIsA(StageMorph),&#xD;        ide = stage.parentThatIsA(IDE_Morph),&#xD;        world = stage.parentThatIsA(WorldMorph),&#xD;        thisObj = this;&#xD;&#xD;if (tf != !!tf) return;&#xD;&#xD;try{&#xD;ide.savingPreferences = false;&#xD;&#xD;switch (which) {&#xD;    case &apos;Presentation mode&apos;:&#xD;        if (tf != ide.isAppMode) ide.toggleAppMode();&#xD;        break;&#xD;    case &apos;Retina display support&apos;:&#xD;        if (tf != isRetinaEnabled()) ide.toggleRetina();&#xD;        break;&#xD;    case &apos;Long form input dialog&apos;:&#xD;        if (tf != InputSlotDialogMorph.prototype.isLaunchingExpanded)&#xD;            ide.toggleLongFormInputDialog();&#xD;        break;&#xD;    case &apos;Plain prototype labels&apos;:&#xD;        if (tf != BlockLabelPlaceHolderMorph.prototype.plainLabel)&#xD;            ide.togglePlainPrototypeLabels();&#xD;        break;&#xD;    case &apos;Input sliders&apos;:&#xD;        MorphicPreferences.useSliderForInput = tf;&#xD;        break;&#xD;    case &apos;Execute on slider change&apos;:&#xD;        ArgMorph.prototype.executeOnSliderEdit = tf;&#xD;        break;&#xD;    case &apos;Clicking sound&apos;:&#xD;        if (tf != !!BlockMorph.prototype.snapSound)&#xD;            BlockMorph.prototype.toggleSnapSound();&#xD;        break;&#xD;    case &apos;Turbo mode&apos;:&#xD;        if (tf != stage.isFastTracked)&#xD;            ide.toggleFastTracking();&#xD;        break;&#xD;    case &apos;Flat design&apos;:&#xD;        if (tf == MorphicPreferences.isFlat) break;&#xD;        if (tf)&#xD;            ide.flatDesign();&#xD;        else&#xD;            ide.defaultDesign();&#xD;        break;&#xD;    case &apos;Keyboard editing&apos;:&#xD;        if (tf != (world.keyboardReceiver instanceof ScriptFocusMorph)) {&#xD;            thisObj.scripts.toggleKeyboardEntry();&#xD;        };&#xD;        break;&#xD;    case &apos;Visible stepping&apos;:&#xD;        if (tf != Process.prototype.enableSingleStepping)&#xD;            ide.toggleSingleStepping();&#xD;        break;&#xD;    case &apos;Thread safe scripts&apos;:&#xD;        stage.isThreadSafe = tf;&#xD;        break;&#xD;    case &apos;Prefer smooth animations&apos;:&#xD;        if (tf != (StageMorph.prototype.frameRate &gt; 0))&#xD;            ide.toggleVariableFrameRate();&#xD;        break;&#xD;    case &apos;Flat line ends&apos;:&#xD;        SpriteMorph.prototype.useFlatLineEnds = tf;&#xD;        break;&#xD;    case &apos;Codification support&apos;:&#xD;        if (tf != StageMorph.prototype.enableCodeMapping) {&#xD;            StageMorph.prototype.enableCodeMapping = tf;&#xD;            ide.currentSprite.blocksCache.variables = null;&#xD;            ide.currentSprite.paletteCache.variables = null;&#xD;            ide.refreshPalette();&#xD;        }&#xD;        break;&#xD;    case &apos;Inheritance support&apos;:&#xD;        if (tf != StageMorph.prototype.enableInheritance) {&#xD;            StageMorph.prototype.enableInheritance = tf;&#xD;            ide.currentSprite.blocksCache.variables = null;&#xD;            ide.currentSprite.paletteCache.variables = null;&#xD;            ide.refreshPalette();&#xD;        }&#xD;        break;&#xD;};&#xD;}&#xD;finally {&#xD;ide.savingPreferences = false;&#xD;};&#xD;</l></block><list><block var="which"/><block var="tf"/></list></block></script></block-definition><block-definition s="set value %&apos;which&apos; to %&apos;value&apos;" type="command" category="sensing"><header></header><code></code><translations>pt:altera o valor da configurao _ para _&#xD;</translations><inputs><input type="%s" readonly="true"><options>Project notes&#xD;Project name&#xD;Language&#xD;Zoom blocks&#xD;Stage size&#xD;Stage scale&#xD;Visible palette</options></input><input type="%s"></input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>which</l><l>value</l></list><l>var   stage = this.parentThatIsA(StageMorph),&#xD;        ide = stage.parentThatIsA(IDE_Morph),&#xD;        world = stage.parentThatIsA(WorldMorph);&#xD;&#xD;try {&#xD;ide.savingPreferences = false;&#xD;&#xD;switch (which) {&#xD;    case &apos;Project notes&apos;:&#xD;        ide.projectNotes = value;&#xD;        break;&#xD;    case &apos;Project name&apos;:&#xD;        ide.setProjectName(value);&#xD;        break;&#xD;    case &apos;Language&apos;:&#xD;        ide.setLanguage(value);&#xD;        break;&#xD;    case &apos;Zoom blocks&apos;:&#xD;        if (!isNaN(value)) ide.setBlocksScale(Math.min(value, 12));&#xD;        break;&#xD;    case &apos;Stage size&apos;:&#xD;        if ((value instanceof List) &amp;&amp; value.length()==2&#xD;                       &amp;&amp; !isNaN(value.at(1)) &amp;&amp; !isNaN(value.at(2)))&#xD;            ide.setStageExtent(new Point(value.at(1), value.at(2)));&#xD;        break;&#xD;    case &apos;Stage scale&apos;:&#xD;        ide.toggleStageSize(value != 1, Math.max(0.1, value));&#xD;        break;&#xD;    case &apos;Visible palette&apos;:&#xD;        ide.currentCategory = value.toLowerCase();&#xD;        ide.categories.children.forEach(function (each) {&#xD;                each.refresh();&#xD;        });&#xD;        ide.refreshPalette(true);&#xD;        break;&#xD;};&#xD;}&#xD;finally {ide.savingPreferences = true;&#xD;};</l></block><list><block var="which"/><block var="value"/></list></block></script></block-definition><block-definition s="set image value of myData at %&apos;x&apos; %&apos;y&apos; to %&apos;value&apos;" type="command" category="sensing"><comment x="0" y="0" w="90" collapsed="false">sets the value at (x|y) in myData</comment><header></header><code></code><translations></translations><inputs><input type="%n">1</input><input type="%n">1</input><input type="%n">255</input></inputs><script><block s="doWarp"><script><block s="doIfElse"><block s="reportIsA"><block var="myData"/><l><option>list</option></l></block><script><block s="doSetVar"><l>x</l><block s="reportRound"><block var="x"/></block></block><block s="doSetVar"><l>y</l><block s="reportRound"><block var="y"/></block></block><block s="doIf"><block s="reportAnd"><block s="reportAnd"><block s="reportLessThan"><block var="x"/><block s="reportSum"><custom-block s="property %s"><l>width</l></custom-block><l>1</l></block></block><block s="reportLessThan"><block var="y"/><block s="reportSum"><custom-block s="property %s"><l>height</l></custom-block><l>1</l></block></block></block><block s="reportAnd"><block s="reportGreaterThan"><block var="x"/><l>0</l></block><block s="reportGreaterThan"><block var="y"/><l>0</l></block></block></block><script><block s="doReplaceInList"><block s="reportSum"><block var="x"/><block s="reportProduct"><block s="reportDifference"><block var="y"/><l>1</l></block><custom-block s="property %s"><l>width</l></custom-block></block></block><block var="myData"/><block var="value"/></block></script></block></script><script><block s="doSayFor"><l>ERROR: wrong data format</l><l>2</l></block></script></block></script></block></script></block-definition><block-definition s="matrix/vec %&apos;a&apos; %&apos;op&apos; matrix/vec %&apos;b&apos;" type="reporter" category="operators"><comment x="0" y="0" w="90" collapsed="false">operations with scalars, vectors and matrices</comment><header></header><code></code><translations></translations><inputs><input type="%s"></input><input type="%s" readonly="true">*<options>+&#xD;-&#xD;*</options></input><input type="%s"></input></inputs><script><block s="doDeclareVariables"><list><l>h</l><l>h1</l></list></block><block s="doWarp"><script><block s="doSetVar"><l>op</l><block s="reportListItem"><l>1</l><block s="reportTextSplit"><block var="op"/><l> </l></block></block></block><block s="doIfElse"><block s="reportIsA"><block var="a"/><l><option>number</option></l></block><script><block s="doIfElse"><block s="reportIsA"><block var="b"/><l><option>number</option></l><comment w="119.45205479452062" collapsed="true">number number operation</comment></block><script><block s="doReport"><custom-block s="%s %s vec %l"><block var="a"/><l>*</l><block var="b"/></custom-block></block></script><script><block s="doIfElse"><custom-block s="is %s a %s ?"><block var="b"/><l>vector</l><comment w="119.45205479452062" collapsed="true">number vector operation</comment></custom-block><script><block s="doReport"><custom-block s="%s %s vec %l"><block var="a"/><l>*</l><block var="b"/></custom-block></block></script><script><block s="doIfElse"><custom-block s="is %s a %s ?"><block var="b"/><l>matrix</l><comment w="119.45205479452062" collapsed="true">number matrix operation</comment></custom-block><script><block s="doIfElse"><block s="reportEquals"><block var="op"/><l>*</l></block><script><block s="doReport"><block s="reportMap"><block s="reifyReporter"><autolambda><block s="reportAtomicMap"><block s="reifyReporter"><autolambda><block s="reportProduct"><block var="a"/><l></l></block></autolambda><list></list></block><l/></block></autolambda><list></list></block><block var="b"/></block></block></script><script><block s="doReport"><l>ERROR: illegal operation</l></block></script></block></script><script><block s="doReport"><l>ERROR: illegal operation</l></block></script></block></script></block></script></block></script><script><block s="doIfElse"><custom-block s="is %s a %s ?"><block var="a"/><l>vector</l></custom-block><script><block s="doIfElse"><block s="reportIsA"><block var="b"/><l><option>number</option></l><comment w="119.45205479452062" collapsed="true">vector number operation</comment></block><script><block s="doReport"><custom-block s="%s %s vec %l"><block var="b"/><block var="op"/><block var="a"/></custom-block></block></script><script><block s="doIfElse"><custom-block s="is %s a %s ?"><block var="b"/><l>vector</l><comment w="119.45205479452062" collapsed="true">vector vector operation</comment></custom-block><script><block s="doReport"><custom-block s="%s %s vec %l"><block var="b"/><block var="op"/><block var="a"/></custom-block></block></script><script><block s="doIfElse"><custom-block s="is %s a %s ?"><block var="b"/><l>matrix</l><comment w="119.45205479452062" collapsed="true">vector matrix operation</comment></custom-block><script><block s="doIfElse"><block s="reportAnd"><block s="reportAnd"><block s="reportIsA"><block s="reportListItem"><l>1</l><block var="a"/></block><l><option>number</option></l></block><block s="reportEquals"><block var="op"/><l>*</l></block></block><block s="reportEquals"><block s="reportListLength"><block var="a"/></block><block s="reportListLength"><block var="b"/></block></block></block><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>vector</l><l>matrix</l></list><l>var result=new List(),sum;&#xD;for(var i=1;i&lt;=matrix.at(1).length();i++){&#xD;  sum=0;&#xD;  for(var j=1;j&lt;=vector.length();j++)&#xD;    sum=sum+vector.at(j)*matrix.at(j).at(i);&#xD;  result.add(sum);&#xD;  }&#xD;return result;</l></block><list><block var="a"/><block var="b"/></list></block></block></script><script><block s="doReport"><l>ERROR: illegal operation</l></block></script></block></script><script><block s="doReport"><l>ERROR: illegal operation</l></block></script></block></script></block></script></block></script><script><block s="doIfElse"><custom-block s="is %s a %s ?"><block var="a"/><l>matrix</l></custom-block><script><block s="doIfElse"><block s="reportIsA"><block var="b"/><l><option>number</option></l><comment w="119.45205479452062" collapsed="true">matrix number operation</comment></block><script><block s="doIfElse"><block s="reportEquals"><block var="op"/><l>*</l></block><script><block s="doReport"><block s="reportMap"><block s="reifyReporter"><autolambda><block s="reportAtomicMap"><block s="reifyReporter"><autolambda><block s="reportProduct"><block var="b"/><l></l></block></autolambda><list></list></block><l/></block></autolambda><list></list></block><block var="a"/></block></block></script><script><block s="doReport"><l>ERROR: illegal operation</l></block></script></block></script><script><block s="doIfElse"><custom-block s="is %s a %s ?"><block var="b"/><l>vector</l><comment w="119.45205479452062" collapsed="true">matrix vector operation</comment></custom-block><script><block s="doIfElse"><block s="reportAnd"><block s="reportAnd"><block s="reportIsA"><block s="reportListItem"><l>1</l><block var="b"/></block><l><option>list</option></l></block><block s="reportEquals"><block var="op"/><l>*</l></block></block><block s="reportEquals"><block s="reportListLength"><block s="reportListItem"><l>1</l><block var="a"/></block></block><block s="reportListLength"><block var="b"/></block></block></block><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>matrix</l><l>vector</l></list><l>var result=new List(),sum;&#xD;for(var i=1;i&lt;=matrix.length();i++){&#xD;  sum=0;&#xD;  for(var j=1;j&lt;=vector.length();j++)&#xD;    sum=sum+matrix.at(i).at(j)*vector.at(j);&#xD;  result.add(sum);&#xD;  }&#xD;return result;</l></block><list><block var="a"/><custom-block s="transpose %l"><block var="b"/></custom-block></list></block></block></script><script><block s="doReport"><l>ERROR: illegal operation</l></block></script></block></script><script><block s="doIfElse"><custom-block s="is %s a %s ?"><block var="b"/><l>matrix</l><comment w="119.45205479452062" collapsed="true">matrix matrix operation</comment></custom-block><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>a</l><l>b</l><l>op</l></list><l>var result=new List(),rowsA=a.length(),rowsB=b.length(),colsA=a.at(1).length();&#xD;var colsB=b.at(1).length(),row,sum;&#xD;if(op=="+"){&#xD;  if((rowsA==rowsB) &amp;&amp; (colsA==colsB)){&#xD;    for(var i=1;i&lt;=rowsA;i++){&#xD;      row=new List();&#xD;      for(j=1;j&lt;=colsA;j++)&#xD;        row.add(Number(a.at(i).at(j))+Number(b.at(i).at(j)));&#xD;      result.add(row);&#xD;      }&#xD;    return result;&#xD;    }&#xD;  else return "ERROR: different dimensions";       &#xD;  }&#xD;&#xD;if(op=="-"){&#xD;  if((rowsA==rowsB) &amp;&amp; (colsA==colsB)){&#xD;    for(var i=1;i&lt;=rowsA;i++){&#xD;      row=new List();&#xD;      for(j=1;j&lt;=colsA;j++)&#xD;        row.add(Number(a.at(i).at(j))-Number(b.at(i).at(j)));&#xD;      result.add(row);&#xD;      }&#xD;    return result;&#xD;    }&#xD;  else return "ERROR: different dimensions";       &#xD;  }&#xD;&#xD;if(op=="*"){&#xD;  if(colsA==rowsB){&#xD;    for(var i=1;i&lt;=rowsA;i++){&#xD;       row=new List();&#xD;       for(j=1;j&lt;=colsB;j++){&#xD;         sum=0;&#xD;         for(k=1;k&lt;=colsA;k++)&#xD;           sum=sum+(Number(a.at(i).at(k))*Number(b.at(k).at(j)));&#xD;         row.add(sum);&#xD;         }&#xD;       result.add(row);&#xD;       }&#xD;      return result;&#xD;    }&#xD;  else return "ERROR: wrong dimensions";       &#xD;  }&#xD;&#xD;return "ERROR: wrong operation";</l></block><list><block var="a"/><block var="b"/><block var="op"/></list></block></block></script><script><block s="doReport"><l>ERROR: illegal operation</l></block></script></block></script></block></script></block></script><script><block s="doReport"><l>ERROR: illegal operation</l></block></script></block></script></block></script></block></script></block></script></block-definition><block-definition s="transpose %&apos;data&apos;" type="reporter" category="operators"><comment x="0" y="0" w="103.01369863013697" collapsed="false">creates the transpose of a vector or a matrix</comment><header></header><code></code><translations></translations><inputs><input type="%l"></input></inputs><script><block s="doIfElse"><block s="reportIsA"><block var="data"/><l><option>list</option></l></block><script><block s="doIfElse"><block s="reportEquals"><block s="reportListLength"><block var="data"/></block><l>0</l></block><script><block s="doReport"><block var="data"/></block></script><script><block s="doIfElse"><custom-block s="is %s a %s ?"><block var="data"/><l>vector</l></custom-block><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>vector</l></list><l>var result= new List();&#xD;if(vector.at(1) instanceof List){&#xD;  for(i=1;i&lt;=vector.length();i++)&#xD;    result.add(vector.at(i).at(1));&#xD;  }&#xD;else{&#xD;  for(i=1;i&lt;=vector.length();i++)&#xD;    result.add(new List([vector.at(i)]));&#xD;  }&#xD;return result;</l></block><list><block var="data"/></list></block></block></script><script><block s="doIfElse"><custom-block s="is %s a %s ?"><block var="data"/><l>matrix</l></custom-block><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>matrix</l></list><l>var result= new List(), width=matrix.at(1).length();&#xD;for(var i=1;i&lt;=width;i++) result.add(new List());&#xD;for(var i=1;i&lt;=matrix.length();i++)&#xD;  for(var j=1;j&lt;=width;j++)&#xD;    result.at(j).add(matrix.at(i).at(j));&#xD;return result;</l></block><list><block var="data"/></list></block></block></script><script><block s="doReport"><l>ERROR: not transposable</l></block></script></block></script></block></script></block></script><script><block s="doReport"><l>ERROR: not transposable</l></block></script></block></script><scripts><script x="346.0684961506851" y="595.8447518584475"><block s="doSetVar"><l>result</l><block s="reportNewList"><list></list></block></block><block s="doForEach"><l>item</l><block var="table"/><script><block s="doAddToList"><block s="reportNewList"><list><block var="item"/></list></block><block var="result"/></block></script></block><block s="doReport"><block var="result"/></block></script></scripts></block-definition><block-definition s="new %&apos;n&apos; -dim vector" type="reporter" category="operators"><comment x="0" y="0" w="90" collapsed="false">creates a random two dimensional vector</comment><header></header><code></code><translations></translations><inputs><input type="%n">2</input></inputs><script><block s="doDeclareVariables"><list><l>result</l></list></block><block s="doWarp"><script><block s="doSetVar"><l>result</l><block s="reportNewList"><list></list></block></block><block s="doRepeat"><block var="n"/><script><block s="doAddToList"><block s="reportRandom"><l>-9</l><l>9</l></block><block var="result"/></block></script></block><block s="doReport"><block var="result"/></block></script></block></script></block-definition><block-definition s="%&apos;a&apos; %&apos;op&apos; vec %&apos;b&apos;" type="reporter" category="operators"><comment x="0" y="0" w="106.43835616438362" collapsed="false">fast vector operations</comment><header></header><code></code><translations></translations><inputs><input type="%s"></input><input type="%s" readonly="true">*<options>+&#xD;-&#xD;*&#xD;X</options></input><input type="%l"></input></inputs><script><block s="doDeclareVariables"><list><l>result</l><l>transposed</l></list></block><block s="doWarp"><script><block s="doSetVar"><l>op</l><block s="reportListItem"><l>1</l><block s="reportTextSplit"><block var="op"/><l> </l></block></block></block><block s="doIfElse"><block s="reportIsA"><block var="a"/><l><option>number</option></l></block><script><block s="doIfElse"><block s="reportIsA"><block var="b"/><l><option>number</option></l></block><script><block s="doIf"><block s="reportEquals"><block var="op"/><l>+</l></block><script><block s="doReport"><block s="reportSum"><block var="a"/><block var="b"/></block></block></script><comment w="90" collapsed="false">number number operation</comment></block><block s="doIf"><block s="reportEquals"><block var="op"/><l>-</l></block><script><block s="doReport"><block s="reportDifference"><block var="a"/><block var="b"/></block></block></script></block><block s="doIf"><block s="reportEquals"><block var="op"/><l>*</l></block><script><block s="doReport"><block s="reportProduct"><block var="a"/><block var="b"/></block></block></script></block><block s="doReport"><l>ERROR: illegal operation</l></block></script><script><block s="doIfElse"><custom-block s="is %s a %s ?"><block var="b"/><l>vector</l></custom-block><script><block s="doIfElse"><block s="reportEquals"><block var="op"/><l>*</l></block><script><block s="doIfElse"><block s="reportIsA"><block s="reportListItem"><l>1</l><block var="b"/></block><l><option>list</option></l></block><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>scalar</l><l>vector</l></list><l>//scalar*vector&#xD;var result=new List();&#xD;scalar=Number(scalar);&#xD;for(var i=1;i&lt;=vector.length();i++){&#xD;  result.add(scalar*Number(vector.at(i)));&#xD;  }&#xD;return result;</l></block><list><block var="a"/><custom-block s="transpose %l"><block var="b"/></custom-block></list></block></block></script><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>scalar</l><l>vector</l></list><l>//scalar*vector&#xD;var result=new List();&#xD;vscalar = Number(scalar);&#xD;for(var i=1;i&lt;=vector.length();i++){&#xD;  result.add(scalar*Number(vector.at(i)));&#xD;  }&#xD;return result;</l></block><list><block var="a"/><block var="b"/></list></block></block></script></block></script><script><block s="doReport"><l>ERROR: illegal operation</l></block></script></block></script><script><block s="doReport"><l>ERROR: illegal operation</l></block></script><comment w="90" collapsed="false">number vector operation</comment></block></script></block></script><script><block s="doIfElse"><custom-block s="is %s a %s ?"><block var="a"/><l>vector</l></custom-block><script><block s="doIfElse"><block s="reportIsA"><block var="b"/><l><option>number</option></l></block><script><block s="doReport"><custom-block s="%s %s vec %l"><block var="b"/><block var="op"/><block var="a"/></custom-block><comment w="90" collapsed="false">vector number operation.</comment></block></script><script><block s="doIfElse"><custom-block s="is %s a %s ?"><block var="b"/><l>vector</l></custom-block><script><block s="doIfElse"><block s="reportEquals"><block s="reportListLength"><block var="a"/></block><block s="reportListLength"><block var="b"/></block></block><script><block s="doIfElse"><block s="reportIsA"><block s="reportListItem"><l>1</l><block var="a"/></block><l><option>list</option></l></block><script><block s="doSetVar"><l>a</l><custom-block s="transpose %l"><block var="a"/></custom-block></block><block s="doSetVar"><l>transposed</l><block s="reportBoolean"><l><bool>true</bool></l></block></block></script><script><block s="doSetVar"><l>transposed</l><block s="reportBoolean"><l><bool>false</bool></l></block></block></script></block><block s="doIf"><block s="reportEquals"><block var="op"/><l>+</l></block><script><block s="doSetVar"><l>result</l><block s="evaluate"><block s="reportJSFunction"><list><l>vector1</l><l>vector2</l></list><l>//vector+vector&#xD;var result=new List();&#xD;for(var i=1;i&lt;=vector1.length();i++){&#xD;  result.add(Number(vector1.at(i))+Number(vector2.at(i)));&#xD;  }&#xD;return result;</l></block><list><block var="a"/><block var="b"/></list></block></block><block s="doIf"><block var="transposed"/><script><block s="doSetVar"><l>result</l><custom-block s="transpose %l"><block var="result"/></custom-block></block></script></block><block s="doReport"><block var="result"/></block></script></block><block s="doIf"><block s="reportEquals"><block var="op"/><l>-</l></block><script><block s="doSetVar"><l>result</l><block s="evaluate"><block s="reportJSFunction"><list><l>vector1</l><l>vector2</l></list><l>//vector-vector&#xD;var result=new List();&#xD;for(var i=1;i&lt;=vector1.length();i++){&#xD;  result.add(Number(vector1.at(i))-Number(vector2.at(i)));&#xD;  }&#xD;return result;</l></block><list><block var="a"/><block var="b"/></list></block></block><block s="doIf"><block var="transposed"/><script><block s="doSetVar"><l>result</l><custom-block s="transpose %l"><block var="result"/></custom-block></block></script></block><block s="doReport"><block var="result"/></block></script></block><block s="doIf"><block s="reportEquals"><block var="op"/><l>*</l></block><script><block s="doSetVar"><l>result</l><block s="evaluate"><block s="reportJSFunction"><list><l>vector1</l><l>vector2</l></list><l>//vector*vector&#xD;var result=0;&#xD;for(var i=1;i&lt;=vector1.length();i++){&#xD;  result=result+Number(vector1.at(i))*Number(vector2.at(i));&#xD;  }&#xD;return result;</l></block><list><block var="a"/><block var="b"/></list></block></block><block s="doReport"><block var="result"/></block></script></block><block s="doIfElse"><block s="reportEquals"><block var="op"/><l>X</l></block><script><block s="doIf"><block s="reportAnd"><block s="reportEquals"><block s="reportListLength"><block var="a"/></block><l>3</l></block><block s="reportEquals"><block s="reportListLength"><block var="b"/></block><l>3</l></block></block><script><block s="doSetVar"><l>result</l><block s="reportNewList"><list><block s="reportDifference"><block s="reportProduct"><block s="reportListItem"><l>2</l><block var="a"/></block><block s="reportListItem"><l>3</l><block var="b"/></block></block><block s="reportProduct"><block s="reportListItem"><l>3</l><block var="a"/></block><block s="reportListItem"><l>2</l><block var="b"/></block></block></block><block s="reportDifference"><block s="reportProduct"><block s="reportListItem"><l>3</l><block var="a"/></block><block s="reportListItem"><l>1</l><block var="b"/></block></block><block s="reportProduct"><block s="reportListItem"><l>1</l><block var="a"/></block><block s="reportListItem"><l>3</l><block var="b"/></block></block></block><block s="reportDifference"><block s="reportProduct"><block s="reportListItem"><l>1</l><block var="a"/></block><block s="reportListItem"><l>2</l><block var="b"/></block></block><block s="reportProduct"><block s="reportListItem"><l>2</l><block var="a"/></block><block s="reportListItem"><l>1</l><block var="b"/></block></block></block></list></block></block></script></block><block s="doIf"><block var="transposed"/><script><block s="doSetVar"><l>result</l><custom-block s="transpose %l"><block var="result"/></custom-block></block></script></block><block s="doReport"><block var="result"/></block></script><script><block s="doReport"><l>ERROR: wrong dimension of vectors</l></block></script></block></script><script><block s="doReport"><l>ERROR: different length of vectors</l></block></script></block></script><script><block s="doReport"><l>ERROR: illegal operation</l></block></script><comment w="90" collapsed="false">vector vector operation.</comment></block></script></block></script><script><block s="doReport"><l>ERROR: illegal operation</l></block></script></block></script></block></script></block></script></block-definition><block-definition s="is %&apos;data&apos; a %&apos;choice&apos; ?" type="predicate" category="operators"><comment x="0" y="0" w="108.49315068493155" collapsed="false">test on vector or matrix</comment><header></header><code></code><translations></translations><inputs><input type="%s"></input><input type="%s" readonly="true">vector<options>vector&#xD;matrix&#xD;table</options></input></inputs><script><block s="doDeclareVariables"><list><l>width</l><l>result</l></list></block><block s="doWarp"><script><block s="doSetVar"><l>choice</l><block s="reportListItem"><l>1</l><block s="reportTextSplit"><block var="choice"/><l> </l></block></block></block><block s="doIfElse"><block s="reportNot"><block s="reportIsA"><block var="data"/><l><option>list</option></l></block></block><script><block s="doReport"><block s="reportBoolean"><l><bool>false</bool></l></block></block></script><script><block s="doIf"><block s="reportEquals"><block var="choice"/><l>vector</l></block><script><block s="doIfElse"><block s="reportIsA"><block s="reportListItem"><l>1</l><block var="data"/></block><l><option>list</option></l></block><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>data</l></list><l>var result=true;&#xD;i=1;&#xD;while(result &amp;&amp; (i&lt;=data.length()))&#xD;{&#xD;  row=data.at(i);&#xD;  if(!(row instanceof List)) result=false;&#xD;  else if(row.length()!=1) result=false;&#xD;       else if(Number.isNaN(row.at(1))) result=false;&#xD;  i++;&#xD;}&#xD;return result;&#xD;</l></block><list><block var="data"/></list></block></block></script><script><block s="doIfElse"><block s="reportEquals"><block s="reportAtomicFindFirst"><block s="reifyPredicate"><autolambda><block s="reportNot"><block s="reportIsA"><l></l><l><option>number</option></l></block></block></autolambda><list></list></block><block var="data"/></block><block s="reportBoolean"><l><bool>false</bool></l></block></block><script><block s="doReport"><block s="reportBoolean"><l><bool>true</bool></l></block></block></script><script><block s="doReport"><block s="reportBoolean"><l><bool>false</bool></l></block></block></script></block></script></block></script></block><block s="doIf"><block s="reportEquals"><block var="choice"/><l>matrix</l></block><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>data</l></list><l>var result=true,row,i,j,width;&#xD;i=1;&#xD;while(result &amp;&amp; (i&lt;=data.length()))&#xD;{&#xD;  row=data.at(i);&#xD;  if(!(row instanceof List)) result=false;&#xD;  else&#xD;  {&#xD;    if(i==1) width = row.length();&#xD;    if(width==1) result=false;&#xD;    if(row.length()!=width) result=false;&#xD;    else&#xD;    {&#xD;      j=1;&#xD;      while(result &amp;&amp; (j&lt;=row.length()))&#xD;      {&#xD;        if(Number.isNaN(row.at(j))) result=false;&#xD;        j++;&#xD;      }&#xD;    }&#xD;  }&#xD;  i++;&#xD;}&#xD;return result;&#xD;</l></block><list><block var="data"/></list></block></block></script></block><block s="doIf"><block s="reportEquals"><block var="choice"/><l>table</l></block><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>data</l></list><l>var result=true,row,i,width;&#xD;i=1;&#xD;while(result &amp;&amp; (i&lt;=data.length()))&#xD;{&#xD;  row=data.at(i);&#xD;  if(!(row instanceof List)) result=false;&#xD;  else&#xD;  {&#xD;    if(i==1) width = row.length();&#xD;    if(row.length()!=width) result=false;&#xD;  }&#xD;  i++;&#xD;}&#xD;return result;&#xD;</l></block><list><block var="data"/></list></block></block></script></block><block s="doReport"><block s="reportBoolean"><l><bool>false</bool></l></block></block></script></block></script></block></script></block-definition><block-definition s="new %&apos;n&apos; x %&apos;m&apos; -matrix" type="reporter" category="operators"><comment x="0" y="0" w="70.13698630136993" collapsed="false">creates a new 3x3 random matrix</comment><header></header><code></code><translations></translations><inputs><input type="%n">3</input><input type="%n">2</input></inputs><script><block s="doDeclareVariables"><list><l>result</l><l>row</l></list></block><block s="doWarp"><script><block s="doSetVar"><l>result</l><custom-block s="new table"></custom-block></block><block s="doRepeat"><block var="m"/><script><block s="doSetVar"><l>row</l><block s="reportNewList"><list></list></block></block><block s="doRepeat"><block var="n"/><script><block s="doAddToList"><block s="reportRandom"><l>-9</l><l>9</l></block><block var="row"/></block></script></block><block s="doAddToList"><block var="row"/><block var="result"/></block></script></block><block s="doReport"><block var="result"/></block></script></block></script></block-definition><block-definition s="delete %&apos;choice&apos; %&apos;n&apos; of %&apos;table&apos;" type="command" category="lists"><comment x="0" y="0" w="85" collapsed="false">deletes a row or column of a table</comment><header></header><code></code><translations></translations><inputs><input type="%s" readonly="true">row<options>row&#xD;column</options></input><input type="%n">1</input><input type="%s">myData</input></inputs><script><block s="doDeclareVariables"><list><l>target</l></list></block><block s="doWarp"><script><block s="doSetVar"><l>choice</l><block s="reportListItem"><l>1</l><block s="reportTextSplit"><block var="choice"/><l> </l></block></block></block><block s="doIfElse"><block s="reportEquals"><block var="table"/><l>myData</l></block><script><block s="doSetVar"><l>target</l><block var="myData"/></block></script><script><block s="doSetVar"><l>target</l><block var="table"/></block></script></block><block s="doIfElse"><custom-block s="is %s a %s ?"><block var="target"/><l>table</l></custom-block><script><block s="doIf"><block s="reportEquals"><block var="choice"/><l>row</l></block><script><block s="doDeleteFromList"><block var="n"/><block var="target"/></block></script></block><block s="doIf"><block s="reportEquals"><block var="choice"/><l>column</l></block><script><block s="doIf"><block s="reportGreaterThan"><block s="reportListLength"><block var="target"/></block><l>0</l></block><script><block s="doIfElse"><block s="reportAnd"><block s="reportEquals"><block s="reportListLength"><block s="reportListItem"><l>1</l><block var="target"/></block></block><l>1</l></block><block s="reportEquals"><block var="n"/><l>1</l></block></block><script><block s="doDeleteFromList"><l><option>all</option></l><block var="target"/></block></script><script><block s="doRun"><block s="reportJSFunction"><list><l>data</l><l>n</l></list><l>for(var i=1;i&lt;=data.length();i++)&#xD;   data.put(data.at(i).remove(n));</l></block><list><block var="target"/><block var="n"/></list></block></script></block></script></block></script></block></script><script><block s="doSayFor"><l>ERROR: only data in tables are deletable</l><l>2</l></block></script></block></script></block></script></block-definition><block-definition s="add %&apos;choice&apos; %&apos;newContent&apos; to %&apos;table&apos;" type="command" category="lists"><comment x="0" y="0" w="90" collapsed="false">adds a row, a column, or  column headers to a table</comment><header></header><code></code><translations></translations><inputs><input type="%s" readonly="true">row<options>row&#xD;column&#xD;column headers</options></input><input type="%s"></input><input type="%s">myData</input></inputs><script><block s="doDeclareVariables"><list><l>tablewidth</l><l>item</l><l>target</l></list></block><block s="doWarp"><script><block s="doSetVar"><l>choice</l><block s="reportListItem"><l>1</l><block s="reportTextSplit"><block var="choice"/><l> </l></block></block></block><block s="doIfElse"><block s="reportEquals"><block var="table"/><l>myData</l></block><script><block s="doSetVar"><l>target</l><block var="myData"/></block></script><script><block s="doSetVar"><l>target</l><block var="table"/></block></script></block><block s="doIfElse"><custom-block s="is %s a %s ?"><block var="target"/><l>table</l></custom-block><script><block s="doRun"><block s="reportJSFunction"><list><l>data</l><l>newContent</l><l>choice</l></list><l>var tablewidth,item;&#xD;if(choice=="row"){&#xD;  if(data.length()==0) &#xD;    if(newContent instanceof List) data.add(newContent);&#xD;    else data.add(new List([newContent]));&#xD;  else{&#xD;    tablewidth=data.at(1).length();&#xD;    if(newContent instanceof List){&#xD;      item=new List();&#xD;      for(var i=1;i&lt;=tablewidth;i++)&#xD;        if(i&gt;newContent.length()) item.add("");&#xD;        else item.add(newContent.at(i));&#xD;      data.add(item);&#xD;      }&#xD;    else{&#xD;      item=new List([newContent]);&#xD;      for(var i=1;i&lt;tablewidth;i++) item.add("");&#xD;      data.add(item);&#xD;      }&#xD;    }&#xD;  }  &#xD;if(choice=="column"){&#xD;  if(!(newContent instanceof List)) newContent = new List([newContent]);&#xD;  if(data.length()==0)&#xD;    for(var i=1;i&lt;=newContent.length();i++) data.add(new List([newContent.at(i)]));&#xD;  else for(var i=1; i&lt;= data.length();i++)&#xD;         if(i&gt;newContent.length()) data.at(i).add("");&#xD;         else data.at(i).add(newContent.at(i));&#xD;&#xD;  }&#xD;if(choice=="column headers"){&#xD;  if(data.length()==0) &#xD;    if(newContent instanceof List) data.add(newContent);&#xD;    else data.add(new List([newContent]));&#xD;  else{&#xD;    tablewidth=data.at(1).length();&#xD;    if(newContent instanceof List){&#xD;      item=new List();&#xD;      for(var i=1;i&lt;=tablewidth;i++)&#xD;        if(i&gt;newContent.length()) item.add("");&#xD;        else item.add(newContent.at(i));&#xD;      }&#xD;    else{&#xD;      item=new List([newContent]);&#xD;      for(var i=1;i&lt;tablewidth;i++) item.add("");&#xD;      }&#xD;    data.add(item,1);&#xD;    }&#xD;  }</l></block><list><block var="target"/><block var="newContent"/><block var="choice"/></list></block></script><script><block s="doSayFor"><l>ERROR: only tables are expandable</l><l>2</l></block></script></block></script></block></script></block-definition><block-definition s="%&apos;choice&apos; %&apos;n&apos; of %&apos;table&apos;" type="reporter" category="lists"><comment x="0" y="0" w="90" collapsed="false">reports a row or column of a table</comment><header></header><code></code><translations></translations><inputs><input type="%s" readonly="true">row<options>row&#xD;column</options></input><input type="%n">1</input><input type="%s">myData</input></inputs><script><block s="doDeclareVariables"><list><l>source</l></list></block><block s="doWarp"><script><block s="doSetVar"><l>choice</l><block s="reportListItem"><l>1</l><block s="reportTextSplit"><block var="choice"/><l> </l></block></block></block><block s="doIfElse"><block s="reportEquals"><block var="table"/><l>myData</l></block><script><block s="doSetVar"><l>source</l><block var="myData"/></block></script><script><block s="doSetVar"><l>source</l><block var="table"/></block></script></block><block s="doIfElse"><custom-block s="is %s a %s ?"><block var="source"/><l>table</l></custom-block><script><block s="doIf"><block s="reportEquals"><block var="choice"/><l>row</l></block><script><block s="doReport"><block s="reportListItem"><block var="n"/><block var="source"/></block></block></script></block><block s="doIf"><block s="reportEquals"><block var="choice"/><l>column</l></block><script><block s="doReport"><block s="reportAtomicMap"><block s="reifyReporter"><script><block s="doReport"><block s="reportListItem"><block var="n"/><l/></block></block></script><list></list></block><block var="source"/></block></block></script></block></script><script><block s="doReport"><l>ERROR: impossible</l></block></script></block></script></block></script></block-definition><block-definition s="import %&apos;choice&apos; from %&apos;source&apos; to myData" type="command" category="lists"><header></header><code></code><translations></translations><inputs><input type="%s" readonly="true">FITS-data<options>FITS-data&#xD;table-data&#xD;costume-data</options></input><input type="%s"></input></inputs><script><block s="doDeclareVariables"><list><l>header</l><l>imagedata</l><l>h</l><l>min</l><l>max</l><l>w</l><l>h</l></list></block><block s="doWarp"><script><block s="doSetVar"><l>choice</l><block s="reportListItem"><l>1</l><block s="reportTextSplit"><block var="choice"/><l> </l></block></block></block><block s="doIf"><block s="reportEquals"><block var="choice"/><l>FITS-data</l></block><script><block s="doIfElse"><block s="reportIsA"><block var="source"/><l><option>text</option></l></block><script><block s="doSetVar"><l>imagedata</l><block s="evaluate"><block s="reportJSFunction"><list><l>FITSdata</l></list><l>function strToInt(high,low){&#xD;  var left = high.toString(2), right = low.toString(2);&#xD;  while(left.length&lt;8) left="0"+left;&#xD;  while(right.length&lt;8) right="0"+right;&#xD;  var both = left+right, result = 0;&#xD;  var factor = 1;&#xD;  for(var i=15; i&gt;=0;i--) {&#xD;    if(both.charAt(i)==&apos;1&apos;) result = result+factor;&#xD;    factor = factor*2;&#xD;    }&#xD;  return result;&#xD;  }&#xD;&#xD;var width=0, height=0, numberlength=0; minValue=32768, maxValue=-32769,header=[], pixelvalues=[],&#xD;    keyword=&apos;&apos;, kwvalue=&apos;&apos;, indexInLine=0, i=0, insideString=false, finished=false, c=&apos; &apos;, n=0,&#xD;    mask = Math.pow(2,7)-1; &#xD;i=0;&#xD;while((i&lt;2880) &amp;&amp; (i&lt;FITSdata.length)){&#xD;  indexInLine=1; keyword=&apos;&apos;; c = FITSdata.charAt(i); &#xD;  while((c!=&apos; &apos;) &amp;&amp; (c!=&apos;=&apos;) &amp;&amp; (i&lt;2880) &amp;&amp; (i&lt;FITSdata.length) &amp;&amp; (indexInLine&lt;=80)){&#xD;    keyword = keyword+c;i++;indexInLine++; c = FITSdata.charAt(i);&#xD;    } &#xD;  while(((c==&apos; &apos;) || (c==&apos;=&apos;)) &amp;&amp; (i&lt;2880) &amp;&amp; (i&lt;FITSdata.length) &amp;&amp; (indexInLine&lt;=80)){&#xD;    i++; indexInLine++; c = FITSdata.charAt(i);&#xD;    }&#xD;  kwvalue=&apos;&apos;; insideString=false; finished=false;&#xD;  while(!finished){&#xD;    kwvalue=kwvalue+FITSdata.charAt(i);&#xD;    if(c=="&apos;") insideString = !insideString;&#xD;    i++; indexInLine++;&#xD;    c = FITSdata.charAt(i);&#xD;    if(insideString) finished=(i&gt;=2880) || (i&gt;=FITSdata.length) || (indexInLine&gt;80);&#xD;    else finished= (c==&apos; &apos;) || (i&gt;=2880) || (i&gt;=FITSdata.length) || (indexInLine&gt;80);&#xD;    }&#xD;  if(keyword.length&gt;0) header.push(new List([keyword,kwvalue]));&#xD;  if(keyword==&apos;NAXIS1&apos;) width=kwvalue;&#xD;  if(keyword==&apos;NAXIS2&apos;) height=kwvalue;&#xD;  if(keyword==&apos;BITPIX&apos;) numberlength=kwvalue;&#xD;  while((i&lt;2880) &amp;&amp; (i&lt;FITSdata.length) &amp;&amp; (indexInLine&lt;=80)){&#xD;    i++; indexInLine++;&#xD;    }&#xD;  }&#xD;&#xD;if(numberlength==16){&#xD;  i=2880; &#xD;  while(i&lt;FITSdata.length-1){&#xD;    n = strToInt(FITSdata.charAt(i).charCodeAt(0),FITSdata.charAt(i+1).charCodeAt(0));&#xD;    //n = -(n &amp; mask) + (n &amp; &#126;mask);  &#xD;    pixelvalues.push(n);&#xD;    if(n&gt;maxValue) maxValue=n;&#xD;    if(n&lt;minValue) minValue=n;&#xD;    i = i+2;&#xD;    }&#xD; return new List([width,height,minValue,maxValue,new List(header),new List(pixelvalues)]);&#xD;  }&#xD;else return &apos;unsupported number format&apos;;</l></block><list><block var="source"/></list></block></block><custom-block s="set properties"></custom-block><block s="doSetVar"><l>myData</l><block s="reportListItem"><l>6</l><block var="imagedata"/></block></block><custom-block s="set property %s to %s"><l>type of data</l><l>FITS</l></custom-block><custom-block s="set property %s to %s"><l>width</l><block s="reportListItem"><l>1</l><block var="imagedata"/></block></custom-block><custom-block s="set property %s to %s"><l>height</l><block s="reportListItem"><l>2</l><block var="imagedata"/></block></custom-block><custom-block s="set property %s to %s"><l>minValue</l><block s="reportListItem"><l>3</l><block var="imagedata"/></block></custom-block><custom-block s="set property %s to %s"><l>maxValue</l><block s="reportListItem"><l>4</l><block var="imagedata"/></block></custom-block><custom-block s="set property %s to %s"><l>columns</l><l>1</l></custom-block><custom-block s="set property %s to %s"><l>rows</l><block s="reportListLength"><block var="myData"/></block></custom-block><block s="doSetVar"><l>header</l><block s="reportListItem"><l>5</l><block var="imagedata"/></block></block><block s="doUntil"><block s="reportOr"><block s="reportEquals"><block s="reportListLength"><block var="header"/></block><l>0</l></block><block s="reportEquals"><block s="reportListItem"><l>1</l><block s="reportListItem"><l>1</l><block var="header"/></block></block><l></l></block></block><script><custom-block s="set property %s to %s"><block s="reportListItem"><l>1</l><block s="reportListItem"><l>1</l><block var="header"/></block></block><block s="reportListItem"><l>2</l><block s="reportListItem"><l>1</l><block var="header"/></block></block></custom-block><block s="doDeleteFromList"><l>1</l><block var="header"/></block></script></block></script><script><block s="doSayFor"><l>ERROR: FITS data have to be text</l><l>2</l></block></script></block></script></block><block s="doIf"><block s="reportEquals"><block var="choice"/><l>table-data</l></block><script><block s="doIfElse"><custom-block s="is %s a %s ?"><block var="source"/><l>table</l></custom-block><script><block s="doSetVar"><l>w</l><custom-block s="property %s"><l>width</l></custom-block></block><block s="doSetVar"><l>h</l><custom-block s="property %s"><l>height</l></custom-block></block><custom-block s="set properties"></custom-block><custom-block s="set property %s to %s"><l>width</l><block var="w"/></custom-block><custom-block s="set property %s to %s"><l>height</l><block var="h"/></custom-block><block s="doSetVar"><l>myData</l><custom-block s="copy of table %l"><block var="source"/></custom-block></block><custom-block s="set property %s to %s"><l>type of data</l><l>table</l></custom-block><custom-block s="set property %s to %s"><l>minValue</l><l>not set</l></custom-block><custom-block s="set property %s to %s"><l>maxValue</l><l>not set</l></custom-block><block s="doIfElse"><block s="reportEquals"><block s="reportListLength"><block var="source"/></block><l>0</l></block><script><custom-block s="set property %s to %s"><l>columns</l><l>0</l></custom-block><custom-block s="set property %s to %s"><l>rows</l><l>0</l></custom-block></script><script><custom-block s="set property %s to %s"><l>columns</l><block s="reportListLength"><block s="reportListItem"><l>1</l><block var="myData"/></block></block></custom-block><custom-block s="set property %s to %s"><l>rows</l><block s="reportListLength"><block var="myData"/></block></custom-block></script></block></script><script><block s="doSayFor"><l>ERROR: only import from a table</l><l>2</l></block></script></block></script></block><block s="doIf"><block s="reportEquals"><block var="choice"/><l>costume-data</l></block><script><block s="doIf"><block s="reportIsA"><block var="source"/><l><option>text</option></l></block><script><block s="doSetVar"><l>source</l><block s="reportGet"><l><option>costume</option></l></block></block></script></block><block s="doSetVar"><l>myData</l><block s="reportGetImageAttribute"><l><option>pixels</option></l><block var="source"/></block></block><custom-block s="set properties"></custom-block><custom-block s="set property %s to %s"><l>type of data</l><l>RGB</l></custom-block><custom-block s="set property %s to %s"><l>width</l><block s="reportGetImageAttribute"><l><option>width</option></l><block var="source"/></block></custom-block><custom-block s="set property %s to %s"><l>height</l><block s="reportGetImageAttribute"><l><option>height</option></l><block var="source"/></block></custom-block><custom-block s="set property %s to %s"><l>rows</l><block s="reportListLength"><block var="myData"/></block></custom-block><custom-block s="set property %s to %s"><l>columns</l><block s="reportListLength"><block s="reportListItem"><l>1</l><block var="myData"/></block></block></custom-block><block s="doSetVar"><l>min</l><custom-block s="%txt of %l"><l>min</l><custom-block s="%s %n of %s"><l>column</l><l>1</l><block var="myData"/></custom-block></custom-block></block><block s="doSetVar"><l>max</l><custom-block s="%txt of %l"><l>max</l><custom-block s="%s %n of %s"><l>column</l><l>1</l><block var="myData"/></custom-block></custom-block></block><block s="doFor"><l>i</l><l>2</l><block s="reportListLength"><block s="reportListItem"><l>1</l><block var="myData"/></block></block><script><block s="doSetVar"><l>h</l><custom-block s="%txt of %l"><l>min</l><custom-block s="%s %n of %s"><l>column</l><block var="i"/><block var="myData"/></custom-block></custom-block></block><block s="doIf"><block s="reportLessThan"><block var="h"/><block var="min"/></block><script><block s="doSetVar"><l>min</l><block var="h"/></block></script></block><block s="doSetVar"><l>h</l><custom-block s="%txt of %l"><l>max</l><custom-block s="%s %n of %s"><l>column</l><block var="i"/><block var="myData"/></custom-block></custom-block></block><block s="doIf"><block s="reportGreaterThan"><block var="h"/><block var="max"/></block><script><block s="doSetVar"><l>max</l><block var="h"/></block></script></block></script></block><custom-block s="set property %s to %s"><l>minValue</l><block var="min"/></custom-block><custom-block s="set property %s to %s"><l>maxValue</l><block var="max"/></custom-block></script></block></script></block></script></block-definition><block-definition s="set scale attributes precision %&apos;precision&apos; textheight %&apos;textheight&apos; number of intervalls x-axis %&apos;n&apos;" type="command" category="looks"><comment x="0" y="0" w="90" collapsed="false">sets the properties for scales</comment><header></header><code></code><translations></translations><inputs><input type="%n">3</input><input type="%n">12</input><input type="%n">10</input></inputs><script><block s="doWarp"><script><custom-block s="set property %s to %s"><l>scalesPrecision</l><block var="precision"/></custom-block><custom-block s="set property %s to %s"><l>scalesTextheight</l><block var="textheight"/></custom-block><custom-block s="set property %s to %s"><l>scalesNumberXintervals</l><block var="n"/></custom-block></script></block></script></block-definition><block-definition s="solve %&apos;A&apos; * x = %&apos;b&apos;" type="reporter" category="operators"><comment x="0" y="0" w="186.57534246575338" collapsed="false">solves a linear equation, if possible</comment><header></header><code></code><translations></translations><inputs><input type="%l"></input><input type="%l"></input></inputs><script><block s="doDeclareVariables"><list><l>toSolve</l></list></block><block s="doIfElse"><block s="reportAnd"><custom-block s="is %s a %s ?"><block var="A"/><l>matrix</l></custom-block><custom-block s="is %s a %s ?"><block var="b"/><l>vector</l></custom-block></block><script><block s="doSetVar"><l>toSolve</l><custom-block s="copy of table %l"><block var="A"/></custom-block></block><custom-block s="add %s %s to %s"><l>column</l><block var="b"/><block var="toSolve"/></custom-block><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>matrix</l></list><l>&#xD;var m=new List(), result, solved=true, width;&#xD;//code "solve" copied from Walter Bislins: http://walter.bislins.ch/blog/index.asp?page=L%F6sen+linearer+Gleichungssysteme+%28JavaScript%29&#xD;&#xD;function solve( m ) {&#xD; &#xD;  function findNotZeroRow( r ) {&#xD;    for ( var nzr = r + 1; nzr &lt; d; nzr++ ) {&#xD;      if ( m[nzr][r] != 0 ) return nzr;&#xD;    }&#xD;    return -1;&#xD;  }&#xD;&#xD;  function swapRows( r1, r2 ) {&#xD;    for ( var c = 0; c &lt;= d; c++ ) {&#xD;      var tmp = m[r1][c];&#xD;      m[r1][c] = m[r2][c];&#xD;      m[r2][c] = tmp;&#xD;    }&#xD;  }&#xD;&#xD; function normRow( r ) {&#xD;    // require m[r][r] != 0&#xD;    var a = m[r][r];&#xD;    if ( a == 1 ) return;&#xD;    m[r][r] = 1;&#xD;    for ( var c = r + 1; c &lt;= d; c++ ) {&#xD;      m[r][c] /= a;&#xD;    }&#xD;  }&#xD;&#xD;  function zeroCell( zr, zc ) {&#xD;    var a = m[zr][zc];&#xD;    if ( a == 0 ) return;&#xD;    m[zr][zc] = 0;&#xD;    for ( var c = zc + 1; c &lt;= d; c++ ) {&#xD;      m[zr][c] -= a * m[zc][c];&#xD;    }&#xD;  }&#xD;&#xD;  var d = m.length;&#xD;  for ( var r = 0; r &lt; d; r++ ) {&#xD;    if ( m[r][r] == 0 ) {&#xD;      var nzr = findNotZeroRow( r );&#xD;      if ( nzr == -1 ) return false;&#xD;      swapRows( r, nzr );&#xD;    }&#xD;    // assert m[r][r] != 0&#xD;    normRow( r );&#xD;    for ( var zr = 0; zr &lt; d; zr++ ) {&#xD;      if ( zr != r ) {&#xD;        zeroCell( zr, r );&#xD;      }&#xD;    }&#xD;  }&#xD;  return true;&#xD;}&#xD;&#xD;for(var i=1;i&lt;=matrix.length();i++) m.add(matrix.at(i).asArray());&#xD;m = m.asArray();&#xD;solved=solve(m);&#xD;if(solved){&#xD;  result = new List();&#xD;  width  = m[0].length-1;&#xD;  for(var i=0;i&lt;m.length;i++) result.add(m[i][width]);&#xD;  return result;&#xD;  }&#xD;else return "ERROR: equation not solved";</l></block><list><block var="toSolve"/></list></block></block></script><script><block s="doReport"><l>ERROR: wrong types</l></block></script></block></script></block-definition><block-definition s="polynom interpolated for %&apos;table&apos;" type="reporter" category="operators"><comment x="0" y="0" w="306.4383561643836" collapsed="false">creates the interpolation polynom for a list of points</comment><header></header><code></code><translations></translations><inputs><input type="%l"></input></inputs><script><block s="doIfElse"><custom-block s="is %s a %s ?"><block var="table"/><l>matrix</l></custom-block><script><block s="doIfElse"><block s="reportEquals"><block s="reportListLength"><block s="reportListItem"><l>1</l><block var="table"/></block></block><l>2</l></block><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>xValues</l><l>yValues</l></list><l>//with help from code based on Walter Bislins: http://walter.bislins.ch/blog/index.asp?page=L%F6sen+linearer+Gleichungssysteme+%28JavaScript%29&#xD;&#xD;function solve( m ) {&#xD; &#xD;  function findNotZeroRow( r ) {&#xD;    for ( var nzr = r + 1; nzr &lt; d; nzr++ ) {&#xD;      if ( m[nzr][r] != 0 ) return nzr;&#xD;    }&#xD;    return -1;&#xD;  }&#xD;&#xD;  function swapRows( r1, r2 ) {&#xD;    for ( var c = 0; c &lt;= d; c++ ) {&#xD;      var tmp = m[r1][c];&#xD;      m[r1][c] = m[r2][c];&#xD;      m[r2][c] = tmp;&#xD;    }&#xD;  }&#xD;&#xD; function normRow( r ) {&#xD;    // require m[r][r] != 0&#xD;    var a = m[r][r];&#xD;    if ( a == 1 ) return;&#xD;    m[r][r] = 1;&#xD;    for ( var c = r + 1; c &lt;= d; c++ ) {&#xD;      m[r][c] /= a;&#xD;    }&#xD;  }&#xD;&#xD;  function zeroCell( zr, zc ) {&#xD;    var a = m[zr][zc];&#xD;    if ( a == 0 ) return;&#xD;    m[zr][zc] = 0;&#xD;    for ( var c = zc + 1; c &lt;= d; c++ ) {&#xD;      m[zr][c] -= a * m[zc][c];&#xD;    }&#xD;  }&#xD;&#xD;  var d = m.length;&#xD;  for ( var r = 0; r &lt; d; r++ ) {&#xD;    if ( m[r][r] == 0 ) {&#xD;      var nzr = findNotZeroRow( r );&#xD;      if ( nzr == -1 ) return false;&#xD;      swapRows( r, nzr );&#xD;    }&#xD;    // assert m[r][r] != 0&#xD;    normRow( r );&#xD;    for ( var zr = 0; zr &lt; d; zr++ ) {&#xD;      if ( zr != r ) {&#xD;        zeroCell( zr, r );&#xD;      }&#xD;    }&#xD;  }&#xD;  return true;&#xD;}&#xD;&#xD;var matrix = [], n=xValues.length(),x,row,result, solved=true, width;&#xD;&#xD;for(var i=1;i&lt;=n;i++){&#xD;  row = [];&#xD;  for(var j=n-1;j&gt;=0;j--){&#xD;    x=1;&#xD;    for(var k=j;k&gt;0;k--) x = x*Number(xValues.at(i));&#xD;    row.push(x);&#xD;    }&#xD;  row.push(yValues.at(i));&#xD;  matrix.push(row); &#xD;  }&#xD;solved=solve(matrix);&#xD;if(solved){&#xD;  result = new List();&#xD;  width  = matrix[0].length-1;&#xD;  for(var i=0;i&lt;matrix.length;i++) result.add(matrix[i][width]);&#xD;  return result;&#xD;  }&#xD;else return "ERROR: no solution found";</l></block><list><custom-block s="%s %n of %s"><l>column</l><l>1</l><block var="table"/></custom-block><custom-block s="%s %n of %s"><l>column</l><l>2</l><block var="table"/></custom-block></list></block></block></script><script><block s="doReport"><l>ERROR: wrong table format</l></block></script></block></script><script><block s="doReport"><l>ERROR: no table</l></block></script></block></script></block-definition><block-definition s="polynom %&apos;p&apos; ( %&apos;x&apos; )" type="reporter" category="operators"><comment x="0" y="0" w="111.91780821917816" collapsed="false">calculates the value of a polynom for input x</comment><header></header><code></code><translations></translations><inputs><input type="%s">polynom as list of coefficients</input><input type="%n"></input></inputs><script><block s="doIfElse"><custom-block s="is %s a %s ?"><block var="p"/><l>vector</l></custom-block><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>poly</l><l>x</l></list><l>//calculation by Horner-schema&#xD;var grade = poly.length(),result;&#xD;if(grade==0) return 0;&#xD;else if(grade==1) return Number(poly.at(1));&#xD;     else{&#xD;       result=Number(poly.at(1))*Number(x)+Number(poly.at(2));&#xD;       for(var i=3;i&lt;=grade;i++) result = result*Number(x)+Number(poly.at(i));&#xD;       return result;&#xD;       }</l></block><list><block var="p"/><block var="x"/></list></block></block></script><script><block s="doReport"><l>ERROR: no poynom</l></block></script></block></script></block-definition><block-definition s="draw circle center %&apos;x&apos; %&apos;y&apos; radius %&apos;radius&apos;" type="command" category="looks"><comment x="0" y="0" w="90" collapsed="false">draws a circle on present costume using line properties</comment><header></header><code></code><translations></translations><inputs><input type="%n">100</input><input type="%n">100</input><input type="%n">20</input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>costume</l><l>x</l><l>y</l><l>radius</l><l>w</l><l>r</l><l>g</l><l>b</l></list><l>var ctx = costume.contents.getContext(&apos;2d&apos;);&#xD;ctx.beginPath();&#xD;ctx.lineWidth = w;&#xD;ctx.strokeStyle = new Color(r,g,b).toString();&#xD;ctx.arc(x,y,radius,0,6.283185307179586476925286766559);&#xD;ctx.closePath();&#xD;ctx.stroke();</l></block><list><block var="myCostume"/><block var="x"/><block var="y"/><block var="radius"/><custom-block s="property %s"><l>lineWidth</l></custom-block><custom-block s="property %s"><l>lineColorRed</l></custom-block><custom-block s="property %s"><l>lineColorGreen</l></custom-block><custom-block s="property %s"><l>lineColorBlue</l></custom-block></list></block><block s="doSwitchToCostume"><block var="myCostume"/></block></script></block-definition><block-definition s="fill rectangle from %&apos;x1&apos; %&apos;y1&apos; to %&apos;x2&apos; %&apos;y2&apos;" type="command" category="looks"><header></header><code></code><translations></translations><inputs><input type="%n">100</input><input type="%n">100</input><input type="%n">200</input><input type="%n">50</input></inputs><script><block s="doDeclareVariables"><list><l>x</l><l>y</l><l>w</l><l>h</l></list><comment w="164.6575342465754" collapsed="false">fills a rectangle on present costume using datapoint properties</comment></block><block s="doWarp"><script><block s="doIfElse"><block s="reportGreaterThan"><block var="x1"/><block var="x2"/></block><script><block s="doSetVar"><l>x</l><block var="x2"/></block><block s="doSetVar"><l>w</l><block s="reportDifference"><block var="x1"/><block var="x2"/></block></block></script><script><block s="doSetVar"><l>x</l><block var="x1"/></block><block s="doSetVar"><l>w</l><block s="reportDifference"><block var="x2"/><block var="x1"/></block></block></script></block><block s="doIfElse"><block s="reportGreaterThan"><block var="y2"/><block var="y1"/></block><script><block s="doSetVar"><l>y</l><block var="y2"/></block><block s="doSetVar"><l>h</l><block s="reportDifference"><block var="y2"/><block var="y1"/></block></block></script><script><block s="doSetVar"><l>y</l><block var="y1"/></block><block s="doSetVar"><l>h</l><block s="reportDifference"><block var="y1"/><block var="y2"/></block></block></script></block><block s="doRun"><block s="reportJSFunction"><list><l>costume</l><l>x1</l><l>y1</l><l>w</l><l>h</l><l>width</l><l>r</l><l>g</l><l>b</l></list><l>var ctx = costume.contents.getContext(&apos;2d&apos;);&#xD;ctx.beginPath();&#xD;ctx.lineWidth = width;&#xD;ctx.fillStyle = new Color(r,g,b).toString();&#xD;ctx.fillRect(x1,y1,w,h);&#xD;ctx.closePath();&#xD;ctx.stroke();</l></block><list><block var="myCostume"/><block var="x"/><block var="y"/><block var="w"/><block var="h"/><custom-block s="property %s"><l>lineWidth</l></custom-block><custom-block s="property %s"><l>datapointColorRed</l></custom-block><custom-block s="property %s"><l>datapointColorGreen</l></custom-block><custom-block s="property %s"><l>datapointColorBlue</l></custom-block></list></block><block s="doSwitchToCostume"><block var="myCostume"/></block></script></block></script></block-definition><block-definition s="fill circle center %&apos;x&apos; %&apos;y&apos; radius %&apos;radius&apos;" type="command" category="looks"><comment x="0" y="0" w="72.19178082191787" collapsed="false">fills a circle on poresent costume using datapoint properties</comment><header></header><code></code><translations></translations><inputs><input type="%n">100</input><input type="%n">100</input><input type="%n">20</input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>costume</l><l>x</l><l>y</l><l>radius</l><l>w</l><l>r</l><l>g</l><l>b</l></list><l>var ctx = costume.contents.getContext(&apos;2d&apos;);&#xD;ctx.beginPath();&#xD;ctx.lineWidth = w;&#xD;ctx.fillStyle = new Color(r,g,b).toString();&#xD;ctx.arc(x,y,radius,0,6.283185307179586476925286766559);&#xD;ctx.closePath();&#xD;ctx.fill();</l></block><list><block var="myCostume"/><block var="x"/><block var="y"/><block var="radius"/><custom-block s="property %s"><l>lineWidth</l></custom-block><custom-block s="property %s"><l>datapointColorRed</l></custom-block><custom-block s="property %s"><l>datapointColorGreen</l></custom-block><custom-block s="property %s"><l>datapointColorBlue</l></custom-block></list></block><block s="doSwitchToCostume"><block var="myCostume"/></block></script></block-definition><block-definition s="set line attributes style %&apos;style&apos; width %&apos;width&apos; color %&apos;r&apos; %&apos;g&apos; %&apos;b&apos;" type="command" category="looks"><comment x="0" y="0" w="90" collapsed="false">sets line style and color for DataSprite diagrams</comment><header></header><code></code><translations></translations><inputs><input type="%s" readonly="true">continuous<options>continuous&#xD;dashed&#xD;dash-dot&#xD;dot-dot</options></input><input type="%n">1</input><input type="%n">0</input><input type="%n">0</input><input type="%n">0</input></inputs><script><block s="doSetVar"><l>style</l><block s="reportListItem"><l>1</l><block s="reportTextSplit"><block var="style"/><l> </l></block></block></block><custom-block s="set property %s to %s"><l>lineStyle</l><block var="style"/></custom-block><custom-block s="set property %s to %s"><l>lineWidth</l><block var="width"/></custom-block><custom-block s="set property %s to %s"><l>lineColorRed</l><block var="r"/></custom-block><custom-block s="set property %s to %s"><l>lineColorGreen</l><block var="g"/></custom-block><custom-block s="set property %s to %s"><l>lineColorBlue</l><block var="b"/></custom-block></script></block-definition><block-definition s="set datapoint attributes style %&apos;style&apos; width %&apos;width&apos; connected %&apos;connected&apos; color %&apos;r&apos; %&apos;g&apos; %&apos;b&apos;" type="command" category="looks"><comment x="0" y="0" w="90" collapsed="false">sets the properties for the data points for the diagrams of a DataSprite</comment><header></header><code></code><translations></translations><inputs><input type="%s" readonly="true">o circle<options>o_circle&#xD;._point&#xD;*_asterix&#xD;+_plus&#xD;x_ex&#xD;square&#xD;triangle&#xD;none</options></input><input type="%n">5</input><input type="%b">false</input><input type="%n">0</input><input type="%n">255</input><input type="%n">0</input></inputs><script><block s="doSetVar"><l>style</l><block s="reportListItem"><l>1</l><block s="reportTextSplit"><block var="style"/><l> </l></block></block></block><custom-block s="set property %s to %s"><l>datapointStyle</l><block var="style"/></custom-block><custom-block s="set property %s to %s"><l>datapointWidth</l><block var="width"/></custom-block><custom-block s="set property %s to %s"><l>datapointConnected</l><block var="connected"/></custom-block><custom-block s="set property %s to %s"><l>datapointColorRed</l><block var="r"/></custom-block><custom-block s="set property %s to %s"><l>datapointColorGreen</l><block var="g"/></custom-block><custom-block s="set property %s to %s"><l>datapointColorBlue</l><block var="b"/></custom-block></script></block-definition><block-definition s="random" type="reporter" category="operators"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list></list><l>return Math.random();</l></block><list></list></block></block></script></block-definition><block-definition s="%&apos;n&apos; random points near %&apos;f&apos; between %&apos;xmin&apos; and %&apos;xmax&apos;" type="reporter" category="lists"><header></header><code></code><translations></translations><inputs><input type="%n">20</input><input type="%repRing"></input><input type="%n">-5</input><input type="%n">5</input></inputs><script><block s="doDeclareVariables"><list><l>x</l><l>y</l><l>data</l></list></block><block s="doWarp"><script><block s="doSetVar"><l>data</l><custom-block s="new table"></custom-block></block><block s="doRepeat"><block var="n"/><script><block s="doSetVar"><l>x</l><block s="reportSum"><block s="reportProduct"><block s="reportDifference"><block var="xmax"/><block var="xmin"/></block><custom-block s="random"></custom-block></block><block var="xmin"/></block></block><block s="doSetVar"><l>y</l><block s="evaluate"><block s="reportJSFunction"><list><l>f</l><l>x</l><l>proc</l></list><l>return proc.reportAtomicMap(f,new List([x])).at(1); //copied from Snap!-code</l></block><list><block var="f"/><block var="x"/></list></block></block><block s="doAddToList"><block s="reportNewList"><list><block var="x"/><block s="reportSum"><block var="y"/><block s="reportProduct"><block s="reportDifference"><custom-block s="random"></custom-block><l>0.5</l></block><block var="y"/></block></block></list></block><block var="data"/></block></script></block><block s="doReport"><block var="data"/></block></script></block></script><scripts><script x="312.32422375000004" y="78.4444514444444"><block s="reportProduct"><l>.2</l><block s="reportProduct"><block var="x"/><block var="x"/></block></block></script></scripts></block-definition><block-definition s="brightness around ( %&apos;x&apos; , %&apos;y&apos; ) radius %&apos;r&apos;" type="reporter" category="sensing"><header></header><code></code><translations></translations><inputs><input type="%n">100</input><input type="%n">100</input><input type="%n">10</input></inputs><script><block s="doIfElse"><block s="reportIsA"><block var="myData"/><l><option>list</option></l></block><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>data</l><l>xpos</l><l>ypos</l><l>r</l><l>width</l><l>height</l></list><l>&#xD;function imageValue(x,y){&#xD;  if((x&gt;width)||(x&lt;1)||(y&gt;height)||(y&lt;1)) return 0;&#xD;  else return data.at(x+(y-1)*width);&#xD;  }&#xD; &#xD;var sumOfValues=0,points=0,y=ypos-r,x;&#xD;while((y&lt;=ypos+r) &amp;&amp; (y&lt;=height)){&#xD;  x=xpos-r;&#xD;  while((x&lt;=xpos+r) &amp;&amp; (x&lt;=width)){&#xD;    if(r&gt;Math.sqrt((xpos-x)*(xpos-x)+(ypos-y)*ypos-y)){&#xD;      sumOfValues=sumOfValues+imageValue(Math.round(x),Math.round(y));&#xD;      points++;&#xD;      }&#xD;    x++;&#xD;  }&#xD;  y++;&#xD;}&#xD;return sumOfValues;    </l></block><list><block var="myData"/><block var="x"/><block var="y"/><block var="r"/><custom-block s="property %s"><l>width</l></custom-block><custom-block s="property %s"><l>height</l></custom-block></list></block></block></script><script><block s="doReport"><l>ERROR: wrong data format</l></block></script></block></script></block-definition><block-definition s="add dataplot text/number %&apos;data&apos;" type="command" category="looks"><header></header><code></code><translations></translations><inputs><input type="%s">myData</input></inputs><script><block s="doDeclareVariables"><list><l>source</l></list></block><block s="doWarp"><script><block s="doIfElse"><block s="reportEquals"><block var="data"/><l>myData</l></block><script><block s="doIfElse"><block s="reportEquals"><custom-block s="property %s"><l>type of data</l></custom-block><l>table</l></block><script><block s="doSetVar"><l>source</l><block var="myData"/></block></script><script><block s="doSayFor"><l>ERROR: wrong data format</l><l>2</l></block><block s="doSetVar"><l>source</l><l></l></block></script></block></script><script><block s="doSetVar"><l>source</l><block var="data"/></block></script></block><block s="doIf"><custom-block s="is %s a %s ?"><block var="source"/><l>table</l></custom-block><script><block s="doRun"><block s="reportJSFunction"><list><l>costume</l><l>ranges</l><l>offsets</l><l>labels</l><l>lineattributes</l><l>dataattributes</l><l>data</l></list><l>function xTOxp(x){return x0+(x*diagramWidth/(xRight-xLeft));}&#xD;function yTOyp(y){return y0-(y*diagramHeight/(yUpper-yLower));}&#xD;function xpTOx(xp){return (xp-x0)*(xRight-xLeft)/diagramWidth;}&#xD;function ypTOy(yp){return (y0-yp)*(yUpper-yLower)/diagramHeight;}&#xD;function round(x,n){return Math.round(x*Math.pow(10,n))/Math.pow(10,n);}&#xD;function randomInt(min,max){return Math.floor(Math.random()*(max-min+1)+min);}&#xD;&#xD;&#xD;function plotData(){&#xD;  var i=0,linewidth=lineattributes.at(2),linestyle=1,datawidth=dataattributes.at(2),datastyle=1,&#xD;      connected=dataattributes.at(3),dx,x;&#xD;  var arraydata=data.asArray(),xpos,ypos,xpOld,ypOld,w;&#xD;  if(lineattributes.at(1).trim()==&apos;continuous&apos;) linestyle = 1;&#xD;    else if(lineattributes.at(1).trim()==&apos;dashed&apos;) linestyle = 2;&#xD;      else if(lineattributes.at(1).trim()==&apos;dash-dot&apos;) linestyle = 3;&#xD;        else if(lineattributes.at(1).trim()==&apos;dot-dot&apos;) linestyle = 4;&#xD;  if(dataattributes.at(1).trim()== &apos;o circle&apos;) datastyle=1;&#xD;  else if(dataattributes.at(1).trim()== &apos;._point&apos;) datastyle=2;  &#xD;       else if(dataattributes.at(1).trim()==&apos;*_asterix&apos;) datastyle=3;&#xD;            else if(dataattributes.at(1).trim()== &apos;+_plus&apos;) datastyle=4;&#xD;                 else if(dataattributes.at(1).trim()== &apos;x_ex&apos;) datastyle=5;&#xD;                      else if(dataattributes.at(1).trim()== &apos;square&apos;) datastyle=6;&#xD;                           else if(dataattributes.at(1).trim()== &apos;triangle&apos;) datastyle=7;&#xD;                                else if(dataattributes.at(1).trim()== &apos;none&apos;) datastyle=8;&#xD;                                     else datastyle=1;&#xD;  ctx.strokeStyle=new Color(0,0,0).toString();&#xD;  ctx.fillStyle=new Color(dataattributes.at(4),dataattributes.at(5),dataattributes.at(6)).toString();&#xD;  ctx.lineWidth = linewidth;&#xD;  if(linestyle==2){ctx.setLineDash([10,5]);}&#xD;  else if(linestyle==3){ctx.setLineDash([10,2,1,2]);}    &#xD;       else if(linestyle==4){ctx.setLineDash([1,2]);}&#xD;            else{ctx.setLineDash([]);}&#xD;  if(arraydata.length&gt;0){&#xD;    dx=(xRight-xLeft)/arraydata.length;&#xD;    x=xLeft;  &#xD;    xpOld= xTOxp(x);&#xD;    ypOld=yTOyp(arraydata[0].at(2));&#xD;    }&#xD;  while(i&lt;arraydata.length){&#xD;    xpos=xTOxp(x);&#xD;    ypos=yTOyp(arraydata[i].at(2));&#xD;    if(connected &amp;&amp; i&gt;0){&#xD;       ctx.beginPath();&#xD;       ctx.moveTo(xpOld+leftOffset,ypOld+upperOffset);&#xD;       ctx.lineTo(xpos+leftOffset,ypos+upperOffset);&#xD;       ctx.closePath();&#xD;       ctx.fill();&#xD;       ctx.stroke();     &#xD;       }&#xD;     ctx.beginPath();&#xD;     if(datastyle==1){&#xD;       ctx.arc(xpos+leftOffset,ypos+upperOffset,datawidth/2,0,6.283185307179586476925286766559);&#xD;       }&#xD;     if(datastyle==2){&#xD;       ctx.arc(xpos+leftOffset,ypos+upperOffset,2,0,6.283185307179586476925286766559);&#xD;       }&#xD;     if(datastyle==3){&#xD;       ctx.font = ""+datawidth+"px sans-serif";&#xD;       w= ctx.measureText("*").width;&#xD;       ctx.fillText("*",xpos+leftOffset-w/2,ypos+upperOffset+datawidth/2);&#xD;       }&#xD;     if(datastyle==4){&#xD;       ctx.font = ""+datawidth+"px sans-serif";&#xD;       w= ctx.measureText("+").width;&#xD;       ctx.fillText("+",xpos+leftOffset-w/2,ypos+upperOffset+datawidth/2);&#xD;       }&#xD;   if(datastyle==5){&#xD;      ctx.font = ""+datawidth+"px sans-serif";&#xD;      w= ctx.measureText("X").width;&#xD;      ctx.fillText("X",xpos+leftOffset-w/2,ypos+upperOffset+datawidth/2);&#xD;      }&#xD;   if(datastyle==6){&#xD;       ctx.fillRect(xpos+leftOffset-datawidth/2,ypos+upperOffset-datawidth/2,datawidth,datawidth);&#xD;       ctx.strokeRect(xpos+leftOffset-datawidth/2,ypos+upperOffset-datawidth/2,datawidth,datawidth);&#xD;       }&#xD;   if(datastyle==7){&#xD;       ctx.moveTo(xpos+leftOffset,ypos+upperOffset-datawidth/2);&#xD;       ctx.lineTo(xpos+leftOffset-datawidth/2,ypos+upperOffset+datawidth/2);&#xD;       ctx.lineTo(xpos+leftOffset+datawidth/2,ypos+upperOffset+datawidth/2);&#xD;       ctx.lineTo(xpos+leftOffset,ypos+upperOffset-datawidth/2);&#xD;        }&#xD;   if(datastyle==0){&#xD;       ctx.moveTo(xpos+leftOffset,ypos+upperOffset);&#xD;       ctx.lineTo(xpos+leftOffset,ypos+upperOffset+1);&#xD;        }&#xD;    ctx.closePath();&#xD;    ctx.fill();&#xD;    ctx.stroke();&#xD;    xpOld=xpos; ypOld=ypos;&#xD;    i=i+1;&#xD;    x=x+dx;&#xD;    }&#xD;    ctx.setLineDash([]);&#xD;  }&#xD;&#xD;// to ensure the correct type "Number" to number parameters&#xD;xLeft = Number(ranges.at(1));&#xD;xRight = Number(ranges.at(2));&#xD;yLower = Number(ranges.at(3));&#xD;yUpper = Number(ranges.at(4));&#xD;upperOffset = Number(offsets.at(2));&#xD;lowerOffset = Number(offsets.at(3));&#xD;leftOffset = Number(offsets.at(1));&#xD;&#xD;var ctx = costume.contents.getContext(&apos;2d&apos;);&#xD;var rightCostumeEdge=costume.contents.width, lowerCostumeEdge=costume.contents.height,&#xD;    diagramWidth=rightCostumeEdge-leftOffset, diagramHeight=lowerCostumeEdge-lowerOffset-upperOffset;&#xD;var x0=xLeft/(xLeft-xRight)*diagramWidth, y0=yUpper/(yUpper-yLower)*diagramHeight;&#xD;&#xD;plotData();       &#xD;&#xD;   </l></block><list><block var="myCostume"/><custom-block s="attributes %txt"><l>ranges</l></custom-block><custom-block s="attributes %txt"><l>offsets</l></custom-block><custom-block s="attributes %txt"><l>labels</l></custom-block><custom-block s="attributes %txt"><l>line-attributes</l></custom-block><custom-block s="attributes %txt"><l>datapoint-attributes</l></custom-block><block var="source"/></list></block><block s="doSwitchToCostume"><block var="myCostume"/></block></script></block></script></block></script></block-definition><block-definition s="%&apos;column&apos; --&gt; label charwidth %&apos;w&apos;" type="reporter" category="operators"><header></header><code></code><translations></translations><inputs><input type="%l"></input><input type="%n">7</input></inputs><script><block s="doDeclareVariables"><list><l>result</l><l>length</l><l>i</l><l>j</l><l>text</l></list></block><block s="doWarp"><script><block s="doSetVar"><l>length</l><block s="reportRound"><block s="reportQuotient"><block s="reportDifference"><block s="reportQuotient"><block s="reportDifference"><custom-block s="property %s"><l>width</l></custom-block><custom-block s="property %s"><l>leftOffset</l></custom-block></block><block s="reportListLength"><block var="column"/></block></block><l>5</l></block><block var="w"/></block></block></block><block s="doSetVar"><l>result</l><l></l></block><block s="doSetVar"><l>i</l><l>1</l></block><block s="doUntil"><block s="reportGreaterThan"><block var="i"/><block s="reportListLength"><block var="column"/></block></block><script><block s="doSetVar"><l>text</l><l></l></block><block s="doSetVar"><l>j</l><l>1</l></block><block s="doUntil"><block s="reportGreaterThan"><block var="j"/><block var="length"/></block><script><block s="doSetVar"><l>text</l><block s="reportJoinWords"><list><block var="text"/><block s="reportLetter"><block var="j"/><block s="reportListItem"><block var="i"/><block var="column"/></block></block></list></block></block><block s="doChangeVar"><l>j</l><l>1</l></block></script></block><block s="doSetVar"><l>result</l><block s="reportJoinWords"><list><block var="result"/><block var="text"/><l> </l></list></block></block><block s="doChangeVar"><l>i</l><l>1</l></block></script></block><block s="doReport"><block var="result"/></block></script></block></script></block-definition><block-definition s="%&apos;k&apos; next neighbors of %&apos;point&apos; in %&apos;data&apos;" type="reporter" category="lists"><comment x="0" y="0" w="90" collapsed="false">determines the next k neighbours of a point in data. The class of the point must be in column 3.</comment><header></header><code></code><translations></translations><inputs><input type="%n">5</input><input type="%l"></input><input type="%s">myData</input></inputs><script><block s="doDeclareVariables"><list><l>neighbors</l><l>points</l><l>result</l></list></block><block s="doWarp"><script><block s="doIfElse"><block s="reportEquals"><block var="data"/><l>myData</l></block><script><block s="doSetVar"><l>points</l><block var="myData"/></block></script><script><block s="doSetVar"><l>points</l><block var="data"/></block></script></block><block s="doIfElse"><custom-block s="is %s a %s ?"><block var="points"/><l>table</l></custom-block><script><block s="doSetVar"><l>neighbors</l><custom-block s="sort %s by column %n ascending %b"><block s="evaluate"><block s="reportJSFunction"><list><l>point</l><l>points</l></list><l>var neighbors=new List();&#xD;for(i=1;i&lt;=points.length();i++){&#xD;  neighbors.add(new List([points.at(i).at(3),Math.sqrt((point.at(1)-points.at(i).at(1))*(point.at(1)-points.at(i).at(1))+(point.at(2)-points.at(i).at(2))*(point.at(2)-points.at(i).at(2)))]));&#xD;  }&#xD;return neighbors;</l></block><list><block var="point"/><block var="points"/></list></block><l>2</l><l><bool>true</bool></l></custom-block></block><block s="doSetVar"><l>result</l><block s="reportNewList"><list></list></block></block><block s="doUntil"><block s="reportOr"><block s="reportEquals"><block s="reportListLength"><block var="result"/></block><block var="k"/></block><block s="reportEquals"><block s="reportListLength"><block var="neighbors"/></block><l>0</l></block></block><script><block s="doAddToList"><block s="reportListItem"><l>1</l><block var="neighbors"/></block><block var="result"/></block><block s="doDeleteFromList"><l>1</l><block var="neighbors"/></block></script></block><block s="doReport"><block var="result"/></block></script><script><block s="doReport"><l>ERROR: wrong data format</l></block></script></block></script></block></script></block-definition><block-definition s="draw text %&apos;text&apos; at %&apos;x&apos; %&apos;y&apos; height %&apos;height&apos; horizontal %&apos;horizontal&apos;" type="command" category="looks"><comment x="0" y="0" w="90" collapsed="false">draws a text on present costume using line properties.</comment><header></header><code></code><translations></translations><inputs><input type="%txt"></input><input type="%n">100</input><input type="%n">50</input><input type="%n">12</input><input type="%b">true</input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>costume</l><l>x</l><l>y</l><l>text</l><l>height</l><l>horizontal</l><l>r</l><l>g</l><l>b</l></list><l>var ctx = costume.contents.getContext(&apos;2d&apos;);&#xD;ctx.beginPath();&#xD;ctx.fillStyle = new Color(r,g,b).toString();&#xD;ctx.font = ""+height+"px sans-serif";&#xD;if(horizontal)ctx.fillText(text,x,y);&#xD;else{&#xD;  ctx.rotate(-Math.PI/2);  &#xD;  ctx.fillText(text,-y,x);&#xD;  ctx.rotate(Math.PI/2);  &#xD;  }&#xD;ctx.closePath();&#xD;ctx.fill();</l></block><list><block var="myCostume"/><block var="x"/><block var="y"/><block var="text"/><block var="height"/><block var="horizontal"/><custom-block s="property %s"><l>lineColorRed</l></custom-block><custom-block s="property %s"><l>lineColorGreen</l></custom-block><custom-block s="property %s"><l>lineColorBlue</l></custom-block></list></block><block s="doSwitchToCostume"><block var="myCostume"/></block></script></block-definition><block-definition s="set ranges by list %&apos;ranges&apos;" type="command" category="looks"><comment w="103.33333333333333" collapsed="false">sets the ranges for the axes of the diagrams of a DataSprit, the list normally is computed by &quot;ranges of ...&quot;</comment><header></header><code></code><translations></translations><inputs><input type="%l"></input></inputs><script><block s="doIfElse"><block s="reportIsA"><block var="ranges"/><l><option>list</option></l></block><script><block s="doIfElse"><block s="reportEquals"><block s="reportListLength"><block var="ranges"/></block><l>4</l></block><script><custom-block s="set ranges to x [ %n %n ] y [ %n %n ]"><block s="reportListItem"><l>1</l><block var="ranges"/></block><block s="reportListItem"><l>2</l><block var="ranges"/></block><block s="reportListItem"><l>3</l><block var="ranges"/></block><block s="reportListItem"><l>4</l><block var="ranges"/></block></custom-block></script><script><block s="doSayFor"><l>ERROR: wrong data format</l><l>2</l></block></script></block></script><script><block s="doSayFor"><l>ERROR: wrong data format</l><l>2</l></block></script></block></script></block-definition></blocks>